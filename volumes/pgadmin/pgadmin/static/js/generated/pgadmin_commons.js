"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[196],{63563:(e,t,i)=>{var n,a;i(68309),i(24812),i(32564),i(57327),i(5735),i(83753),i(69600),i(69826),n=[i(91669),i(66419),i(19755),i(72316),i(95283),i(83879),i(58307),i(66235),i(44092),i(75270)],void 0===(a=function(e,t,i,n,a,l,o,s,r){var d=s.Model.extend({idAttribute:"privilege_type",defaults:{privilege_type:void 0,privilege:!1,with_grant:!1},validate:function(){return null}}),c=s.PrivilegeRoleModel=s.Model.extend({idAttribute:"grantee",defaults:{grantee:void 0,grantor:void 0,privileges:void 0},keys:["grantee","grantor"],privileges:[],schema:[{id:"grantee",label:e("Grantee"),type:"text",group:null,editable:!0,cellHeaderClasses:"width_percent_40",node:"role",options_cached:!1,disabled:function(e){return e instanceof n.Model&&!(e.top&&e.top.node_info&&e.top.node_info.server.user.name==e.get("grantor"))},transform:function(){var e=l.Extension.NodeListByNameCell.prototype.defaults.transform.apply(this,arguments);return e.unshift({label:"PUBLIC",value:"PUBLIC"}),e},cell:l.Extension.NodeListByNameCell.extend({initialize:function(e){var t=this,i=!0;e&&e.column&&e.column instanceof n.Model&&e.column.get("options_cached")&&(i=!1),l.Extension.NodeListByNameCell.prototype.initialize.apply(t,arguments),i&&(e=t.column.get("options"),t.column.set("options",t.omit_selected_roles.bind(t,e)));var a=function(e){var t=this;"grantee"in e.changed&&this.model.cid!=e.cid&&setTimeout((function(){t.render()}),50)}.bind(this);this.listenTo(t.model.collection,"change",a,this),this.listenTo(t.model.collection,"remove",a,this)},omit_selected_roles:function(e,i){var n=e(i),a={},l=i.model,o=l.cid,s=(t.has(l.top,"node_info")&&!t.isUndefined(l.top.node_info)?l.top.node_info:l.handler.top.node_info).server.user.name;return l.collection.each((function(e){var i=e.get("grantee");e.cid==o||t.isUndefined(i)||s!=e.get("grantor")||(a[i]=e.cid)})),n=t.filter(n,(function(e){return!(e.value in a)}))}})},{id:"privileges",label:e("Privileges"),type:"collection",model:d,group:null,cell:"privilege",control:"text",cellHeaderClasses:"width_percent_40",disabled:function(e){return!(e instanceof n.Collection)&&!(this.node_info&&this.node_info.server.user.name==e.get("grantor")||this.attributes.node_info.server.user.name==e.get("grantor"))}},{id:"grantor",label:e("Grantor"),type:"text",readonly:!0,cell:"node-list-by-name",node:"role"}],initialize:function(e,i){s.Model.prototype.initialize.apply(this,arguments),t.isNull(e)&&this.set("grantor",i&&i.top&&i.top.node_info&&i.top.node_info.server.user.name,{silent:!0});var n=this,a=n.get("privileges"),l=this.get("privileges")||{};t.isArray(l)&&(l=new s.Collection(a,{model:d,top:this.top||this,handler:this,silent:!0,parse:!1}),this.set("privileges",l,{silent:!0}));var o={};return t.each(n.privileges,(function(e){o[e]={privilege_type:e,privilege:!1,with_grant:!1}})),l.each((function(e){delete o[e.get("privilege_type")]})),t.each(o,(function(e){l.add(e,{silent:!0})})),n.on("change:grantee",n.granteeChanged),l.on("change",(function(){n.trigger("change:privileges",n)})),n},granteeChanged:function(){var e=this.get("privileges");"PUBLIC"==this.get("grantee")&&e.each((function(e){e.set("with_grant",!1,{silent:!0})}))},toJSON:function(){var e=[];return this.attributes&&!this.attributes.privileges?null:(this.attributes.privileges.each((function(t){t.get("privilege")&&e.push(t.toJSON())})),{grantee:this.get("grantee"),grantor:this.get("grantor"),privileges:e})},validate:function(){var i,n=null;if(t.isUndefined(this.get("grantee"))?(i=e("A grantee must be selected."),this.errorModel.set("grantee",i),n=i):this.errorModel.unset("grantee"),this.attributes&&this.attributes.privileges){var a=!1;this.attributes.privileges.each((function(e){e.get("privilege")&&(a=!0)})),a?this.errorModel.unset("privileges"):(i=e("At least one privilege should be selected."),this.errorModel.set("privileges",i),n=n||i)}return n}}),p=l.Extension.PrivilegeCellEditor=l.CellEditor.extend({tagName:"div",Labels:{C:"CREATE",T:"TEMPORARY",c:"CONNECT",a:"INSERT",r:"SELECT",w:"UPDATE",d:"DELETE",D:"TRUNCATE",x:"REFERENCES",t:"TRIGGER",U:"USAGE",X:"EXECUTE"},template:t.template(['<tr class="<%= header ? "header" : "" %>">',' <td class="renderable">','  <div class="custom-control custom-checkbox privilege-checkbox">','    <input tabindex="0" type="checkbox" class="custom-control-input" id="<%= checkbox_id %>" name="privilege" privilege="<%- privilege_type %>" target="<%- target %>" <%= privilege ? \'checked\' : "" %>/>','    <label class="custom-control-label" for="<%= checkbox_id %>">',"      <%- privilege_label %>","    </label>","  </div>"," </td>",' <td class="renderable">','  <div class="custom-control custom-checkbox privilege-checkbox">','    <input tabindex="0" type="checkbox" class="custom-control-input" id="wgo_<%= checkbox_id %>" name="with_grant" privilege="<%- privilege_type %>" target="<%- target %>" <%= with_grant ? \'checked\' : "" %> <%= enable_with_grant ? "" : \'disabled\'%>/>','    <label class="custom-control-label" for="wgo_<%= checkbox_id %>">',"      WITH GRANT OPTION","    </label>","  </div>"," </td>","</tr>"].join(" "),null,{variable:null}),events:{change:"privilegeChanged",blur:"lostFocus",keydown:"lostFocus"},render:function(){this.$el.empty(),this.$el.attr("tabindex","1"),this.$el.attr("target",this.elId);var e=this.model.get(this.column.get("name")),n=i("<table aria-label="+this.column.get("label")+"></table>").appendTo(this.$el),a=this,l=!0,o=!0,s=t.uniqueId();return e.each((function(e){var i=e.toJSON();l=l&&i.privilege,o=o&&l&&i.with_grant,t.extend(i,{target:a.cid,header:!1,privilege_label:a.Labels[i.privilege_type],with_grant:"PUBLIC"!=a.model.get("grantee")&&i.with_grant,enable_with_grant:"PUBLIC"!=a.model.get("grantee")&&i.privilege,checkbox_id:i.privilege_type+""+s}),l=l&&i.privilege,o=o&&l&&i.with_grant,n.append(a.template(i))})),e.length>1&&n.prepend(a.template({target:a.cid,privilege_label:"ALL",privilege_type:"ALL",privilege:l,with_grant:"PUBLIC"!=a.model.get("grantee")&&o,enable_with_grant:"PUBLIC"!=a.model.get("grantee")&&l,header:!0,checkbox_id:"all"+s})),a.$el.find("input[type=checkbox]").first().trigger("focus"),i(a.$el.find("input[type=checkbox]")).on("blur",(function(){a.$el.trigger("blur")})),i(a.$el).pgMakeVisible("backform-tab"),a.delegateEvents(),this},privilegeChanged:function(t){if(t&&t.target){var n,a,l,o=i(t.target),s=o.attr("privilege"),r=o.attr("name"),d=o.prop("checked"),c=o.closest("tr"),p=c.closest("table"),u=this.model.get("privileges"),h=this.model.get("grantee");if(this.undelegateEvents(),"ALL"==s){var f,m;l=c.find("input[name=with_grant]"),a=p.find("input[name=privilege][privilege!='ALL']"),n=p.find("input[name=with_grant][privilege!='ALL']"),"privilege"==r?(f=d,m=!1,d?(a.prop("checked",!0),"PUBLIC"==h?(n.prop("disabled",!0),l.prop("disabled",!0)):(n.prop("disabled",!1),l.prop("disabled",!1))):(a.prop("checked",!1),l.prop("checked",!1),n.prop("checked",!1),l.prop("disabled",!0),n.prop("disabled",!0))):(f=!0,m=d,n.prop("checked",d)),u.each((function(e){e.set({privilege:f,with_grant:m})}))}else{var g={};a=(p=c.closest("table")).find("input[name=privilege][privilege='ALL']"),n=p.find("input[name=with_grant][privilege='ALL']"),g[r]=d,"privilege"==r?(l=o.closest("tr").find("input[name=with_grant]"),d?"PUBLIC"!=h&&l.prop("disabled",!1):(g.with_grant=!1,l.prop("checked",!1).prop("disabled",!0),a.prop("checked",!1),n.prop("disabled",!0),n.prop("checked",!1))):d||n.prop("checked",!1),u.get(s).set(g),d&&(a=p.find("input[name=privilege][privilege!='ALL']:checked")).length>1&&a.length==u.models.length&&(a.prop("checked",!0),"with_grant"==r?(n=p.find("input[name=with_grant][privilege!='ALL']:checked")).length==u.models.length&&(n.prop("disabled",!1),n.prop("checked",!0)):"PUBLIC"!=h&&n.prop("disabled",!1))}this.model.trigger("change",this.model);var v=!1,b=null;u.each((function(e){v=v||e.get("privilege")})),v?(this.model.errorModel.unset("privileges"),this.model.errorModel.has("grantee")&&(b=this.model.errorModel.get("grantee"))):(this.model.errorModel.set("privileges",e("At least one privilege should be selected.")),b=e("At least one privilege should be selected.")),b?this.model.collection.trigger("pgadmin-session:model:invalid",b,this.model):this.model.collection.trigger("pgadmin-session:model:valid",this.model)}this.delegateEvents()},lostFocus:function(e){var t=this,n=this.model,a=this.column,o=new l.Command(e),s=this.model.get(this.column.get("name"));return"Tab"==e.key&&r.handleKeyNavigation(event),o.moveUp()||o.moveDown()||o.save()||o.cancel()||o.moveLeft()&&"privilege"===e.target.name&&"ALL"===i(e.target).attr("privilege")||o.moveRight()&&s.last().get("privilege_type")===i(e.target).attr("privilege")&&("privilege"===e.target.name&&!e.target.checked||"with_grant"===i(e.target).attr("name"))?(e.stopPropagation(),void n.trigger("backgrid:edited",n,a,o)):void setTimeout((function(){if(("DIV"==document.activeElement.tagName||"BUTTON"==document.activeElement.tagName)&&t.$el[0]!=document.activeElement&&!function(e,t){for(var i=t.parentNode;null!=i;){if(i==e)return!0;i=i.parentNode}return!1}(t.$el[0],document.activeElement)){var i=t.model;i.trigger("backgrid:edited",i,t.column,new l.Command(e))}}),10)}}),u=l.Extension.PrivilegeCellFormatter=function(){};return t.extend(u.prototype,{notation:{CREATE:"C",TEMPORARY:"T",CONNECT:"c",INSERT:"a",SELECT:"r",UPDATE:"w",DELETE:"d",TRUNCATE:"D",REFERENCES:"x",TRIGGER:"t",USAGE:"U",EXECUTE:"X"},fromRaw:function(e){var t="";return e instanceof n.Collection&&e.each((function(e){e.get("privilege")&&(t+=e.get("privilege_type"),e.get("with_grant")&&(t+="*"))})),t}}),l.Extension.PrivilegeCell=l.Cell.extend({className:"edit-cell",formatter:u,editor:p,initialize:function(){var e=this;l.Cell.prototype.initialize.apply(this,arguments),e.model.on("change:grantee",(function(){e.$el.hasClass("editor")||setTimeout((function(){e.render()}),10)}))},events:{click:"enterEditMode",keydown:"saveOrCancel"},saveOrCancel:function(e){var t=this.model,i=this.column,n=new l.Command(e);n.moveUp()||n.moveDown()||n.moveLeft()||n.moveRight()||n.save()?(e.preventDefault(),e.stopPropagation(),t.trigger("backgrid:edited",t,i,n)):n.cancel()&&(e.stopPropagation(),t.trigger("backgrid:edited",t,i,n))}}),c}.apply(t,n))||(e.exports=a)},64096:(e,t,i)=>{var n,a;i(91058),i(54678),i(32564),i(82772),i(68309),i(5735),i(83753),i(15306),i(74916),i(69600),i(69826),i(5212),n=[i(91669),i(66419),i(19755),i(72316),i(95283),i(83879),i(58307),i(55112),i(66235),i(75270)],void 0===(a=function(e,t,i,n,a,l,o,s,r){var d=l.Row.extend({modelDuplicateClass:"bg-model-duplicate",initialize:function(){l.Row.prototype.initialize.apply(this,arguments);var e=this;e.model.on("change:name",(function(){setTimeout((function(){e.columns.each((function(t){if("value"==t.get("name")){e.model.set({value:void 0},{silent:!0});var i=e.columns.indexOf(t),n=new(t.get("cellFunction").apply(t,[e.model]))({column:t,model:e.model});e.cells[i].remove(),e.cells[i]=n,e.render()}}))}),10)})),e.listenTo(e.model,"pgadmin-session:model:duplicate",e.modelDuplicate),e.listenTo(e.model,"pgadmin-session:model:unique",e.modelUnique)},modelDuplicate:function(){i(this.el).removeClass("new"),i(this.el).addClass(this.modelDuplicateClass)},modelUnique:function(){i(this.el).removeClass(this.modelDuplicateClass)}}),c=r.VariableModel=r.Model.extend({keys:["name"],defaults:{name:void 0,value:void 0,role:null,database:null},schema:[{id:"name",label:e("Name"),type:"text",cellHeaderClasses:"width_percent_30",editable:function(e){return e instanceof n.Collection||e.isNew()},cell:l.Extension.NodeAjaxOptionsCell.extend({initialize:function(){l.Extension.NodeAjaxOptionsCell.prototype.initialize.apply(this,arguments);var e=t.clone(this.optionValues||(t.isFunction(this.column.get("options"))?this.column.get("options")(this):this.column.get("options")));this.column.set("options",e)}}),url:"vopts",select2:{allowClear:!1},transform:function(e,i){var n=[],a={};return t.each(e,(function(e){n.push({value:e.name,image:void 0,label:e.name}),a[e.name]=e})),i.column.set("availVariables",a),n}},{id:"value",label:e("Value"),type:"text",editable:!0,cellFunction:function(e){var i=e.get("name"),n={};this.collection.each((function(e){"name"==e.get("name")&&(n=e.get("availVariables"))}));var a=i?n[i]:void 0,o=e.get("value");switch(a&&a.vartype){case"bool":return e.set("value",!!e.get("value"),{silent:!0}),l.Extension.SwitchCell;case"enum":e.set({value:o},{silent:!0});var s=[],r=a&&a.enumvals;return t.each(r,(function(e){s.push([e,e])})),l.Extension.Select2Cell.extend({optionValues:s});case"integer":return t.isNaN(parseInt(o))?e.set({value:void 0},{silent:!0}):e.set({value:parseInt(o)},{silent:!0}),l.IntegerCell;case"real":return t.isNaN(parseFloat(o))?e.set({value:void 0},{silent:!0}):e.set({value:parseFloat(o)},{silent:!0}),l.NumberCell.extend({decimals:0});case"string":return l.StringCell;default:return e.set({value:void 0},{silent:!0}),l.Cell}},cellHeaderClasses:"width_percent_40"},{id:"database",label:e("Database"),type:"text",editable:!0,node:"database",cell:l.Extension.NodeListByNameCell},{id:"role",label:e("Role"),type:"text",editable:!0,node:"role",cell:l.Extension.NodeListByNameCell}],toJSON:function(){var e=n.Model.prototype.toJSON.apply(this);return(t.isUndefined(e.database)||t.isNull(e.database))&&delete e.database,(t.isUndefined(e.role)||t.isNull(e.role))&&delete e.role,e},validate:function(){var i=null;return t.isUndefined(this.get("name"))||t.isNull(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,"")?(i=e("Please select a parameter name."),this.errorModel.set("name",i)):t.isUndefined(this.get("value"))||t.isNull(this.get("value"))||""==String(this.get("value")).replace(/^\s+|\s+$/g,"")?(i=e("Please enter a value for the parameter."),this.errorModel.set("value",i),this.errorModel.unset("name")):(this.errorModel.unset("name"),this.errorModel.unset("value")),i}});return a.VariableCollectionControl=a.UniqueColCollectionControl.extend({hasDatabase:!1,hasRole:!1,initialize:function(e){var t=this,i=["name"];t.hasDatabase=e.field.get("hasDatabase"),t.hasRole=e.field.get("hasRole"),t.hasDatabase?i.push("database"):t.hasRole&&i.push("role"),e&&e.field&&(e.field instanceof a.Field?e.field.set({model:r.VariableModel.extend({keys:i})},{silent:!0}):e.field.extend({model:r.VariableModel.extend({keys:i})})),a.UniqueColCollectionControl.prototype.initialize.apply(t,arguments),t.availVariables={};var n=["name","value"];t.hasDatabase&&n.push("database"),t.hasRole&&n.push("role"),t.gridSchema=a.generateGridColumnsFromModel(t.field.get("node_info"),c.extend({keys:i}),"edit",n,t.field.get("schema_node")),t.getVariables()},getVariables:function(){var e=this,n=this.field.get("url"),a=e.model;if(this.field.get("version_compatible")&&n&&!a.isNew()){var l,o=e.field.get("node"),s=e.field.get("node_data"),r=e.field.get("node_info"),d=o.generate_url.apply(o,[null,n,s,!0,r]),c=e.collection.trackChanges;c&&e.collection.stopSession(),a.trigger("pgadmin-view:fetching",a,e.field),i.ajax({async:!1,url:d}).done((function(e){l=e.data})).fail((function(){a.trigger("pgadmin-view:fetch:error",a,e.field)})),a.trigger("pgadmin-view:fetched",a,e.field),l&&t.isArray(l)&&e.collection.reset(l,{silent:!0}),c&&e.collection.startNewSession()}},showGridControl:function(n){var a=this,o=t.template(["<div class='subnode-header'>","<span class='control-label'><%-label%></span>","<button class='btn btn-sm-sq btn-primary-icon add fa fa-plus' title='"+e("Add new row")+"' <%=canAdd ? '' : 'disabled=\"disabled\"'%>><span class=\"sr-only\">"+e("Add new row")+"</span></button>","</div>"].join("\n")),s=i("<div class='pgadmin-control-group backgrid form-group col-12 object subnode'></div>").append(o(n));a.grid&&a.grid.remove();var r=t.clone(this.gridSchema);t.each(r.columns,(function(e){"value"==e.name&&(e.availVariables=a.availVariables)})),0==n.disabled&&n.canDelete&&r.columns.unshift({name:"pg-backform-delete width_percent_5",label:"",cell:l.Extension.DeleteCell,editable:!1,cell_priority:-1}),a.collection.each((function(e){var t,i=e.get("name");if(i in a.availVariables)switch(a.availVariables[i].vartype){case"real":t=parseFloat(e.get("value")),e.set("value",isNaN(t)?void 0:t,{silent:!0});break;case"integer":t=parseInt(e.get("value")),e.set("value",isNaN(t)?void 0:t,{silent:!0})}}));var c=a.grid=new l.Grid({columns:r.columns,collection:a.collection,row:d,className:"backgrid table presentation table-bordered table-noouter-border table-hover"});return a.$grid=c.render().$el,s.append(a.$grid),n.disabled||0==n.canAdd||s.find("button.add").first().on("click",(function(e){if(e.preventDefault(),!t.isFunction(n.canAddRow)||n.canAddRow.apply(a,[a.model])){if(!!!a.field.get("allowMultipleEmptyRows")&&a.collection){var l=!1;if(a.collection.each((function(e){var i=[];t.each(e.attributes,(function(e){i.push(e)})),t.some(i,t.identity)||(l=!0)})),l)return!1}i(c.body.$el.find(i("tr.new"))).removeClass("new");var o=new n.model(null,{silent:!0,handler:a.collection,top:a.model.top||a.model,collection:a.collection,node_info:a.model.node_info});a.collection.add(o);var s=a.collection.indexOf(o),r=c.body.rows[s].$el;return r.addClass("new"),i(r).pgMakeVisible("backform-tab"),!1}})),s},addVariable:function(e){e.preventDefault();var t=this,n=new(t.field.get("model"))(t.headerData.toJSON(),{silent:!0,top:t.collection.top,handler:t.collection}),a=t.model.get(t.field.get("name"));a.add(n);var l=a.indexOf(n);if(l>-1){t.$grid.find(".new").removeClass("new");var o=t.grid.body.rows[l].$el;o.addClass("new"),i(o).pgMakeVisible("backform-tab")}return!1}}),c}.apply(t,n))||(e.exports=a)},33883:(e,t,i)=>{var n,a,l=i(19755);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}i(47941),i(82526),i(57327),i(38880),i(89554),i(54747),i(49337),i(33321),i(47042),i(41539),i(91038),i(78783),i(41817),i(32165),i(66992),i(33948),i(79753),i(4129),i(68309),i(69826),i(24812),i(32564),i(82772),i(2707),i(64765),i(74916),i(91058),i(4723),i(40561),i(69070);var s=i(77077),r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==o(e)&&"function"!=typeof e)return{default:e};var t=c();if(t&&t.has(e))return t.get(e);var i={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var l=n?Object.getOwnPropertyDescriptor(e,a):null;l&&(l.get||l.set)?Object.defineProperty(i,a,l):i[a]=e[a]}i.default=e,t&&t.set(e,i);return i}(i(55958)),d=i(72663);function c(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return c=function(){return e},e}function p(e,t){var i;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(i=function(e,t){if(!e)return;if("string"==typeof e)return u(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return u(e,t)}(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,o=!0,s=!1;return{s:function(){i=e[Symbol.iterator]()},n:function(){var e=i.next();return o=e.done,e},e:function(e){s=!0,l=e},f:function(){try{o||null==i.return||i.return()}finally{if(s)throw l}}}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function h(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function f(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}n=[i(91669),i(28008),i,i(19755),i(66419),i(43734),i(55112),i(55455),i(20811),i(86620),i(85530),i(68363),i(87789),i(44092),i(1950),i(10426),i(52677),i(7027),i(35816),i(47337),i(3650),i(94546),i(50521),i(75035),i(88799),i(37944),i(66092),i(58688),i(66235),i(5547),i(31126),i(90338),i(89769),i(77019)],a=function(e,t,i,n,a,o,c,u,m,g,v,b,y,C,w,_,x){l=window.$=n;var k=window.wcDocker;n=n||l||window.$;var E=m.default,N=c.Browser=c.Browser||{},T=e("Please select an object in the tree view.");y.setPGCSRFToken(c.csrf_token_header,c.csrf_token),_.validate_kerberos_ticket();var S={};S[k.EVENT.VISIBILITY_CHANGED]=function(){if(this.isVisible()){var e=c.Browser,t=e.tree?e.tree.selected():void 0,i=t?e.tree.itemData(t):void 0;if(i&&e.Nodes[i._type].callbacks.selected&&a.isFunction(e.Nodes[i._type].callbacks.selected))return e.Nodes[i._type].callbacks.selected.apply(e.Nodes[i._type],[t,i,e])}};var I=c.Browser.initializeBrowserTree=function(e){x.initBrowserTree(e).then((function(){e.tree.registerDraggableType({"collation domain domain_constraints fts_configuration fts_dictionary fts_parser fts_template synonym table partition type sequence package view mview foreign_table edbvar":function(t,i,n){var a=C.fully_qualify(e,t,i);return{text:a,objUrl:s.generateNodeUrl.call(N.Nodes[t._type],n,"properties",t,!0),nodeType:t._type,cur:{from:a.length,to:a.length}}},"schema column database cast event_trigger extension language foreign_data_wrapper foreign_server user_mapping compound_trigger index index_constraint primary_key unique_constraint check_constraint exclusion_constraint foreign_key rule":function(e){return C.quote_ident(e._label)},"trigger trigger_function":function(e){return e._label},"edbfunc function edbproc procedure":function(t,i){var n,a=function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?h(Object(i),!0).forEach((function(t){f(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):h(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({},t),l="",o={from:0,to:0};if(n=C.parseFuncParams(a._label),a._label=n.func_name,l=C.fully_qualify(e,a,i),n.params.length>0){l+="(",o.from=l.length,l+=n.params[0][0],o.to=l.length;for(var s=1;s<n.params.length;s++)l=l+", "+n.params[s][0];l+=")"}else l+="()",o.from=o.to=l.length+1;return{text:l,cur:o}}})}),(function(){console.warn("Tree Load Error")}))};return a.extend(c.Browser,{URL:t("browser.index"),docker:null,editor:null,tree:null,scripts:{},stdW:{sm:500,md:700,lg:900,default:500,calc:function(e){var t=window.innerWidth;return t>e?e:t>c.Browser.stdW.lg?c.Browser.stdW.lg:t>c.Browser.stdW.md?c.Browser.stdW.md:t>c.Browser.stdW.sm?c.Browser.stdW.sm:t}},stdH:{sm:200,md:400,lg:550,default:550,calc:function(e){var t=window.innerHeight;return t>e?e:t>c.Browser.stdH.lg?c.Browser.stdH.lg:t>c.Browser.stdH.md?c.Browser.stdH.md:t}},panels:{browser:new c.Browser.Panel({name:"browser",title:e("Browser"),showTitle:!0,isCloseable:!1,isPrivate:!0,icon:"",limit:1,content:'<div id="tree" class="aciTree"></div>',onCreate:function(e,t){v.initializeToolbar(e,k),t.addClass("pg-no-overflow")}}),properties:new c.Browser.Panel({name:"properties",title:e("Properties"),icon:"",width:500,isCloseable:!1,isPrivate:!0,elContainer:!0,limit:1,content:'<div class="obj_properties container-fluid h-100"><div role="status" class="pg-panel-message">'+T+"</div></div>",events:S,onCreate:function(e,t){t.addClass("pg-no-overflow")}}),statistics:new c.Browser.Panel({name:"statistics",title:e("Statistics"),icon:"",width:500,isCloseable:!0,isPrivate:!1,limit:1,canHide:!0,content:'<div class="negative-space p-2"><div role="status" class="pg-panel-message pg-panel-statistics-message">'+T+'</div><div class="pg-panel-statistics-container d-none"></div></div>',events:S}),sql:new c.Browser.Panel({name:"sql",title:e("SQL"),icon:"",width:500,isCloseable:!1,isPrivate:!0,limit:1,content:'<label for="sql-textarea" class="sr-only">'+e("SQL Code")+'</label><div class="sql_textarea"><textarea id="sql-textarea" name="sql-textarea" title="'+e("SQL Code")+'"></textarea></div>'}),dependencies:new c.Browser.Panel({name:"dependencies",title:e("Dependencies"),icon:"",width:500,isCloseable:!0,isPrivate:!1,canHide:!0,limit:1,content:'<div class="negative-space p-2"><div role="status" class="pg-panel-message pg-panel-depends-message">'+T+'</div><div class="pg-panel-dependencies-container d-none"></div></div>',events:S}),dependents:new c.Browser.Panel({name:"dependents",title:e("Dependents"),icon:"",width:500,isCloseable:!0,isPrivate:!1,limit:1,canHide:!0,content:'<div class="negative-space p-2"><div role="status" class="pg-panel-message pg-panel-depends-message">'+T+'</div><div class="pg-panel-dependents-container d-none"></div></div>',events:S}),processes:new c.Browser.Panel({name:"processes",title:e("Processes"),icon:"",width:500,isCloseable:!0,isPrivate:!1,limit:1,canHide:!0,content:'<div class="negative-space p-2"><div class="pg-panel-processes-container d-none"></div></div>',events:S})},frames:{},menus:{context:{},file:{},edit:{},object:{},management:{},tools:{},help:{}},add_panels:function(){var e=JSON.parse(N.panels_items);a.each(e,(function(e){e.isIframe?N.frames[e.name]=new N.Frame({name:e.name,title:e.title,icon:e.icon,width:e.width,height:e.height,showTitle:e.showTitle,isCloseable:e.isCloseable,isPrivate:e.isPrivate,url:e.content}):N.panels[e.name]=new N.Panel({name:e.name,title:e.title,icon:e.icon,width:e.width,height:e.height,showTitle:e.showTitle,isCloseable:e.isCloseable,isPrivate:e.isPrivate,limit:e.limit?e.limit:null,content:e.content?e.content:"",events:e.events?e.events:"",canHide:e.canHide?e.canHide:""})}))},menu_categories:{register:{label:e("Register"),priority:1,above:!1,below:!0,single:!0},create:{label:e("Create"),priority:2,above:!1,below:!0,single:!0}},register_script:function(e,t,i){var n=this.scripts;n[e]=a.isArray(n[e])?n[e]:[],n[e].push({name:t,path:i,loaded:!1})},masterpass_callback_queue:[],enable_disable_menus:function(t){var i=this,l=n("#navbar-menu > ul").first().find("li#mnu_obj .dropdown-menu").first(),o=t?i.tree.itemData(t):void 0,s=function e(i){if(i instanceof c.Browser.MenuItem)i.update(o,t);else for(var n in i)e(i[n])};if(v.enable(e("View Data"),!1),v.enable(e("Filtered Rows"),!1),l.empty(),a.each([{m:"file",id:"#mnu_file"},{m:"management",id:"#mnu_management"},{m:"tools",id:"#mnu_tools"},{m:"help",id:"#mnu_help"}],(function(e){a.each(i.menus[e.m],(function(e){s(e)}))})),t&&i.menus.object&&i.menus.object[o._type])c.Browser.MenuCreator(i.Nodes,l,i.menus.object[o._type],i.menu_categories,o,t);else{var r=c.Browser.MenuGroup(i.menu_categories.create,[{$el:n('<li><a class="dropdown-item disabled" href="#" role="menuitem">'+e("No object selected")+"</a></li>"),priority:1,category:"create",update:function(){}}],!1);l.append(r.$el)}},init:function(){var i=this;if(!i.initialized){if(i.initialized=!0,i.cache_preferences(),i.add_panels(),i.docker=new k("#dockerContainer",{allowContextMenu:!0,allowCollapse:!1,loadingClass:"pg-sp-icon",themePath:t("static",{filename:"css"}),theme:"webcabin.overrides.css"}),i.docker){a.each(i.panels,(function(e,t){i.panels[t].load(i.docker)})),a.each(i.frames,(function(e,t){i.frames[t].load(i.docker)}));var l=N.utils.layout;i.restore_layout(i.docker,l,i.buildDefaultLayout.bind(i),!0),i.docker.on(k.EVENT.LAYOUT_CHANGED,(function(){i.save_current_layout("Browser/Layout",i.docker)}))}I(i),(0,r.initializeModalProvider)(),(0,r.initializeNotifier)(),document.getElementById("sql-textarea")&&(i.editor=E.fromTextArea(document.getElementById("sql-textarea"),{lineNumbers:!0,mode:"text/x-pgsql",readOnly:!0,extraKeys:c.Browser.editor_shortcut_keys,screenReaderLabel:e("SQL")}));var o=setInterval((function(){i.get_preferences_for_module("sqleditor")&&(clearInterval(o),i.reflectPreferences("sqleditor"))}),500);i.onPreferencesChange("sqleditor",(function(){i.reflectPreferences("sqleditor")})),setTimeout((function(){var e,t;null==i||null===(e=i.editor)||void 0===e||e.setValue("-- "+T),null==i||null===(t=i.editor)||void 0===t||t.refresh()}),10),n("#tree").contextMenu({selector:".file-entry",autoHide:!1,build:function(e){var t=i.tree.itemFrom(e),a=i.tree.itemData(t),l=i.menus.context[a._type],o=n("<div></div>"),s={};return t&&i.tree.select(t),c.Browser.MenuCreator(i.Nodes,o,l,i.menu_categories,a,t,s),{autoHide:!1,items:s}},events:{hide:function(){i.keyboardNavigation.bindLeftTree()}}}),N.utils.registerScripts(this),N.utils.addMenus(i);var s={};s[c.csrf_token_header]=c.csrf_token,setInterval((function(){n.ajax({url:t("misc.cleanup"),type:"POST",headers:s}).done((function(){})).fail((function(){}))}),3e5),i.set_master_password(""),i.check_corrupted_db_file(),i.Events.on("pgadmin:browser:tree:add",i.onAddTreeNode,i),i.Events.on("pgadmin:browser:tree:update",i.onUpdateTreeNode,i),i.Events.on("pgadmin:browser:tree:refresh",i.onRefreshTreeNodeReact,i),i.Events.on("pgadmin-browser:tree:loadfail",i.onLoadFailNode,i),i.Events.on("pgadmin-browser:panel-browser:"+k.EVENT.RESIZE_ENDED,i.onResizeEnded,i),i.bind_beforeunload(),i.log_activity(),i.register_to_activity_listener(document),i.start_inactivity_timeout_daemon()}},onResizeEnded:function(){this.tree&&this.tree.resizeTree()},check_corrupted_db_file:function(){n.ajax({url:t("browser.check_corrupted_db_file"),type:"GET",dataType:"json",contentType:"application/json"}).done((function(e){e.data.length>0&&r.default.alert("Warning","pgAdmin detected unrecoverable corruption in it's SQLite configuration database. The database has been backed up and recreated with default settings. It may be possible to recover data such as query history manually from the original/corrupt file using a tool such as DB Browser for SQLite if desired.<br><br>Original file: "+e.data+"<br>Replacement file: "+e.data.substring(0,e.data.length-14))})).fail((function(e,t,i){r.default.alert(i)}))},check_master_password:function(e){n.ajax({url:t("browser.check_master_password"),type:"GET",contentType:"application/json"}).done((function(t){e&&(t.data?e(!0):e(!1))})).fail((function(e,t,i){r.default.pgRespErrorNotify(e,i)}))},reset_master_password:function(){var e=this;n.ajax({url:t("browser.set_master_password"),type:"DELETE",contentType:"application/json"}).done((function(t){t.data||e.set_master_password("")})).fail((function(e,t,i){r.default.pgRespErrorNotify(e,i)}))},set_master_password:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},n=null,a=this;n={password:e},a.masterpass_callback_queue.push(t),(0,d.checkMasterPassword)(n,a.masterpass_callback_queue,i)},bind_beforeunload:function(){n(window).on("beforeunload",(function(t){var i=w.default.pgAdmin.Browser,n=N.get_preference("browser","browser_tree_state_save_interval"),l=i.get_preference("browser","confirm_on_refresh_close");if(a.isUndefined(n)||-1===n.value||c.Browser.browserTreeState.save_state(),!a.isUndefined(l)&&l.value){var o=e("Are you sure you want to close the %s browser?",N.utils.app_name);return t.originalEvent.returnValue=o,o}}))},add_menu_category:function(e,t,i,n,a,l,o){this.menu_categories[e]={label:t,priority:i,icon:n,above:!0===a,below:!0===l,single:o}},add_menus:function(e){var t=this,i=this.menus,l=c.Browser.MenuItem;a.each(e,(function(e){a.each(e.applies,(function(o){if(n.inArray(o,["context","file","edit","object","management","tools","help"])>=0){var s;if(!g(t,e.node))return;if(a.has(e,"module")&&!a.isUndefined(e.module)&&!g(t,e.module.type))return;i[o]=i[o]||{},s=a.isString(e.node)?i[o][e.node]=i[o][e.node]||{}:a.isString(e.category)?i[o][e.category]=i[o][e.category]||{}:i[o];var r=function(e){return new l({name:e.name,label:e.label,module:e.module,category:e.category,callback:e.callback,priority:e.priority,data:e.data,url:e.url||"#",target:e.target,icon:e.icon,enable:""==e.enable||(!a.isString(e.enable)||"false"!=e.enable.toLowerCase())&&e.enable,node:e.node,checked:e.checked,below:e.below})};if(!a.has(s,e.name)&&(s[e.name]=r(e),e.menu_items)){var d,c=[],u=p(e.menu_items);try{for(u.s();!(d=u.n()).done;){var h=d.value;c.push(r(h))}}catch(e){u.e(e)}finally{u.f()}s[e.name].menu_items=c}}else console.warn("Developer warning: Category '"+o+"' is not supported!\nSupported categories are: context, file, edit, object, tools, management, help")}))}))},create_menus:function(){var t=n("#navbar-menu > ul").first(),i=this;a.each([{menu:"file",id:"#mnu_file"},{menu:"management",id:"#mnu_management"},{menu:"tools",id:"#mnu_tools"},{menu:"help",id:"#mnu_help"}],(function(n){var a=t.children(n.id).first(),l=a.children(".dropdown-menu").first();l.empty(),"help"==n.menu&&(l.append('<div id="quick-search-component"></div>'),l.append('<div class="menu-groups"><span class="fa fa-list" style="font-weight:900 !important;"></span> &nbsp;'+e("SUGGESTED SITES")+"</div>")),c.Browser.MenuCreator(i.Nodes,l,i.menus[n.menu],i.menu_categories)&&a.removeClass("d-none")})),t.children("#mnu_obj").removeClass("d-none"),i.enable_disable_menus()},showHelp:function(e,t,i,a){if("object_help"==e){var l=N.tree.getTreeNodeHierarchy(a).server,o=N.utils.pg_help_path,s=b.getHelpUrl(o,t,l.version);window.open(s,"postgres_help")}else"dialog_help"==e&&(w&&w.default?w.default.open(t,"pgadmin_help"):window.open(t,"pgadmin_help"));n("#live-search-field").focus()},_findTreeChildNode:function(e,t,i){var n=i.t.wasLoad(e),l=function(){for(var n,l,o,s=i.t.children(e),r=0,d=s.length;r<d;r++)if(n=s[r],(l=i.t.itemData(n))._type===t._type){if(!i.hasId||l._id==t._id)return i.i=n,i.d=t,i.pathOfTreeItems.push({coll:!1,item:n,d:t}),void i.success()}else if((o=i.b.Nodes[l._type])&&o.collection_node&&l.nodes&&-1!=a.indexOf(l.nodes,t._type))return i.i=n,i.d=null,i.pathOfTreeItems.push({coll:!0,item:n,d:l}),i.t.isInode(n)||(i.load=!1),void i.b._findTreeChildNode(n,t,i);i.notFound&&"function"==typeof i.notFound&&i.notFound(t)};!n&&i.load?i.t.open(e).then((function(){l()}),(function(){var e=i&&i.o&&i.o.fail;e&&"function"==typeof e&&e.apply(i.t,[])})):n?l():i.notFound&&"function"==typeof i.notFound&&i.notFound(t)},onAddTreeNode:function(e,t,i){var n={b:this,d:null,hasId:!0,i:null,p:a.toArray(t||{}).sort((function(e,t){return e.priority===t.priority?0:e.priority<t.priority?-1:1})),pathOfTreeItems:[],t:this.tree,o:i},l=function(){var t,i=this;return i.success=l,i.p.length&&(t=i.p.shift(),i.p.length||(t._id=e._pid,i.success=o),i.b._findTreeChildNode(i.i,t,i),e._pid||o.apply(i,arguments)),!0}.bind(n),o=function(){var t=this,i=this,n=(i.i||this.t.wasLoad(i.i))&&this.t.first(i.i),a=function(t,i){var n=this;n.success=t,n.notFound=i,n.b._findTreeChildNode(n.i,e,n)}.bind(i),l=function(){this.t.openPath(this.i),this.t.select(this.i),i.o&&i.o.success&&"function"==typeof i.o.success&&i.o.success.apply(i.t,[i.i,e])}.bind(i),o=function(){var t,i=arguments,n=this,a=n.t.children(n.i),l=0,o=a.length-1,s=function(){for(;o>=l;){t=a[l];var i=n.t.itemData(t);if("column"===i._type){if(1==c.numeric_comparator(i._id,e._id))return!0}else if(1==c.natural_sort(i._label,e._label))return!0;l++}return o!=a.length-1?(t=a[o+1],!0):(t=null,!1)},r=function(){for(var i,r;o-l>22;){if(t=a[l],"column"===(i=n.t.itemData(t))._type){if(-1!=c.numeric_comparator(i._id,e._id))return!0}else if(-1!=c.natural_sort(i._label,e._label))return!0;t=a[o];var d=void 0;if(1!=(d="column"===(i=n.t.itemData(t))._type?c.numeric_comparator(i._id,e._id):c.natural_sort(i._label,e._label)))return o!=a.length-1?(t=a[o+1],!0):(t=null,!1);if(r=l+Math.round((o-l)/2),t=a[r],0==(d="column"===(i=n.t.itemData(t))._type?c.numeric_comparator(i._id,e._id):c.natural_sort(i._label,e._label)))return!0;-1==d?(l=r+1,o--):(l++,o=r-1)}return s()};if(r())n.t.before(t,e).then((function(i){n.o&&n.o.success&&"function"==typeof n.o.success?n.o.success.apply(n.t,[t,e]):n.t.select(i)}),(function(){console.warn("Failed to add before...",i),n.o&&n.o.fail&&"function"==typeof n.o.fail&&n.o.fail.apply(n.t,[t,e])}));else{var d=function(){var t=arguments,i=this,n=i.t.itemData(i.i);i.t.append(i.i,e).then((function(t){i.t.wasLoad(i.i)&&n&&n._type.search(e._type)>-1?(i.t.open(i.i),i.t.select(t)):n&&i.t.unload(i.i).then((function(){i.t.open(i.i)})),i.o&&i.o.success&&"function"==typeof i.o.success&&i.o.success.apply(i.t,[t,e])}),(function(){console.warn("Failed to append...",t),i.o&&i.o.fail&&"function"==typeof i.o.fail&&i.o.fail.apply(i.t,[i.i,e])}))}.bind(n);n.i&&!n.t.isInode(n.i)?n.t.setInode(n.i).then((function(){d()})):d()}}.bind(i);n||!i.t.wasLoad(i.i)?a(l,o):i.t.unload(i.i).then((function(){a(l,function(){var t=this&&this.o;t&&t.fail&&"function"==typeof t.fail&&t.fail.apply(this.t,[this.i,e])}.bind(t))}),(function(){var i=t&&t.o;i&&i.fail&&"function"==typeof i.fail&&i.fail.apply(t.t,[t.i,e])}))}.bind(n);n.t.wasInit()&&e&&(e._label=e.label,e.label=a.escape(e.label),l())},onUpdateTreeNode:function(e,t,i,n){var l={b:this,d:null,i:null,hasId:!0,p:a.toArray(i||{}).sort((function(e,t){return e.priority===t.priority?0:e.priority<t.priority?-1:1})),pathOfTreeItems:[],t:this.tree,o:n,load:!0,old:e,new:t,op:null},o=function(){var i=this.o&&this.o.fail;i&&"function"==typeof i&&i.apply(this.t,[this.i,t,e])}.bind(l),s=function(){var e=arguments,t=this,i=this.pathOfTreeItems,n=function(){if(i.length){i.pop();var e=i.length;this.i=e&&i[e-1].item||null,this.d=e&&i[e-1].d||null,e&&i[e-1].coll&&(i.pop(),e=i.length,this.i=e&&i[e-1].item||null,this.d=e&&i[e-1].d||null)}else this.i=null,this.d=null}.bind(this),s=this.i&&this.t.hasParent(this.i)&&this.t.parent(this.i)||null,r=s?this.t.hasParent(s)&&this.t.parent(s)&&s.root!=this.t.parent(s):null;if(this.i&&this.d&&this.old._id==this.d._id&&this.old._type==this.d._type){var c=this.t.parent(this.i)||null;if(this.t.isRootNode(c)||c&&0==c.length&&"UPDATE"==l.op)if(1===this.t.children().length)d();else{var p=this;this.t.remove(this.i).then((function(){p.t.before(p.i,p.new).then((function(e){p.t.select(e)}),(function(){console.warn("Failed to add before..",e)}))}))}else{var h=function(){if("/browser"===s.path||r){var e=this.d;n(),this.i?(this.load=!0,this.success=function(){u()}.bind(this),this.notFound=o,this.b._findTreeChildNode(this.i,{_id:this.new._pid,_type:e._type},this)):u()}else{var i=null,l=this.t.siblings(this.i)||[];if(l.push(this.i),a.each(l,(function(e){var n=t.t.itemData(e);n._id==t.new._pid&&(i=e,t.pathOfTreeItems.push({coll:!0,item:i,d:n}))})),i){this.load=!0,this.success=function(){u()}.bind(this),this.notFound=o;var d=this.t.wasLoad(i),c=function(){t.i=i,t.pathOfTreeItems.push({coll:!1,item:i,d:t.d}),t.success()};!d&&t.load?t.t.open(i).then((function(){c()}),(function(){var e=t&&t.o&&t.o.fail;e&&"function"==typeof e&&e.apply(t.t,[])})):c()}}}.bind(this);this.t.remove(this.i).then((function(){return n(),s&&!r&&c&&0==t.t.children(c).length?t.t.unload(c).then((function(){setTimeout(h)})):setTimeout(h),!0}))}}o()}.bind(l),r=function(e){var t=function(){var e=this.pathOfTreeItems;if(e.length){e.pop();var t=e.length;this.i=t&&e[t-1].item||null,this.d=t&&e[t-1].d||null,t&&e[t-1].coll&&(e.pop(),t=e.length,this.i=t&&e[t-1].item||null,this.d=t&&e[t-1].d||null)}else this.i=null,this.d=null}.bind(this);this.i?(this.load=!0,this.success=function(){u()}.bind(this),e._type==this.old._type&&(t(),e=this.d,t()),e=this.new._pid,this.notFound=o,this.b._findTreeChildNode(this.i,e,this)):u()}.bind(l),d=function(){if(this.i&&this.d&&this.new._type==this.d._type){var i=this,n=this.d._id;if(this.new._id!=this.d._id)this.t.itemData(l.i)._id=n=this.new._id;this.new._id==n&&(a.extend(this.d,{_id:this.new._id,_label:this.new._label,label:this.new.label}),this.t.update(l.i,this.new),this.t.setLabel(l.i,{label:this.new.label}),this.t.addIcon(l.i,{icon:this.new.icon}),this.t.setId(l.i,{id:this.new.id}),this.t.openPath(this.i),this.t.deselect(this.i),setTimeout((function(){i.t.select(i.i)}),10))}var o=this.o&&this.o.success;o&&"function"==typeof o&&o.apply(this.t,[this.i,e,t])}.bind(l),p=function(){var e,t=this;return t.success=p,t.p.length?(e=t.p.shift(),t.p.length||("RECREATE"==t.op?(t.load=!1,t.success=s,t.notFound=r):(t.success=d,t.notFound=o)),t.b._findTreeChildNode(t.i,e,t)):1==t.p.length&&(t.notFound=r),!0}.bind(l),u=function(){var i=this,n=this,a=(n.i||this.t.wasLoad(n.i))&&this.t.first(n.i),l=function(e,i){var n=this;n.success=e,n.notFound=i,n.b._findTreeChildNode(n.i,t,n)}.bind(n),o=function(){this.t.openPath(this.i),this.t.select(this.i),n.o&&n.o.success&&"function"==typeof n.o.success&&n.o.success.apply(n.t,[n.i,t])}.bind(n),s=function(){var i,n=arguments,a=this,l=a.t.children(a.i),o=0,s=l.length-1,r=function(){for(;s>=o;){i=l[o];var e=a.t.itemData(i);if("column"===e._type){if(1==c.numeric_comparator(e._id,t._id))return!0}else if(1==c.natural_sort(e._label,t._label))return!0;o++}return s!=l.length-1?(i=l[s+1],!0):(i=null,!1)},d=function(){for(;s-o>22;){i=l[o];var e=a.t.itemData(i);if("column"===e._type){if(-1!=c.numeric_comparator(e._id,t._id))return!0}else if(-1!=c.natural_sort(e._label,t._label))return!0;i=l[s];var n=void 0;if(1!=(n="column"===(e=a.t.itemData(i))._type?c.numeric_comparator(e._id,t._id):c.natural_sort(e._label,t._label)))return s!=l.length-1?(i=l[s+1],!0):(i=null,!1);var d=o+Math.round((s-o)/2);if(i=l[d],0==(n="column"===(e=a.t.itemData(i))._type?c.numeric_comparator(e._id,t._id):c.natural_sort(e._label,t._label)))return!0;-1==n?(o=d+1,s--):(o++,s=d-1)}return r()};if(d())a.t.before(i,t).then((function(n){a.t.openPath(n),a.t.select(n),a.o&&a.o.success&&"function"==typeof a.o.success&&a.o.success.apply(a.t,[i,e,t])}),(function(){console.warn("Failed to add before..",n),a.o&&a.o.fail&&"function"==typeof a.o.fail&&a.o.fail.apply(a.t,[i,e,t])}));else{var p=function(){var i=arguments;a.t.append(a.i,t).then((function(i){a.t.openPath(i),a.t.select(i),a.o&&a.o.success&&"function"==typeof a.o.success&&a.o.success.apply(a.t,[a.i,e,t])}),(function(){console.warn("Failed to append...",i),a.o&&a.o.fail&&"function"==typeof a.o.fail&&a.o.fail.apply(a.t,[a.i,e,t])}))};a.i&&!a.t.isInode(a.i)?a.t.setInode(a.i,{success:p}):p()}}.bind(n);a||!n.t.wasLoad(n.i)?l(o,s):n.t.unload(n.i).then((function(){l(o,(function(){var i=this&&this.o;i&&i.fail&&"function"==typeof i.fail&&i.fail.apply(this.t,[this.i,e,t])}))}),(function(){var n=i&&i.o;n&&n.fail&&"function"==typeof n.fail&&n.fail.apply(i.t,[i.i,e,t])}))}.bind(l);l.t.wasInit()&&t&&e&&(l.pathOfTreeItems.push(e),t._label=t.label,t.label=a.escape(t.label),l.b.Nodes[t._type].is_collection&&"collection_count"in e&&e.collection_count>0&&(t.label=a.escape(t._label)+" <span>("+e.collection_count+")</span>"),"server"==e._type&&"server"==t._type&&(e._pid!=t._pid||e._label!=t._label||e.icon!=t.icon)||e._pid!=t._pid||e._label!=t._label||e._id!=t._id?(l.op="RECREATE",p()):(l.op="UPDATE",p()))},onRefreshTreeNodeReact:function(e,t){this.tree.refresh(e).then((function(){t&&t.success&&t.success()}))},onRefreshTreeNode:function(t,i){var l,o=t&&this.tree.itemData(t),s=o&&o._type&&this.Nodes[o._type],d={b:this,d:o,i:t,p:null,pathOfTreeItems:[],t:this.tree,o:i},c=-1;if(this.Events.trigger("pgadmin-browser:tree:refreshing",t,o,s),s?l=this.tree.isInode(t)&&this.tree.isOpen(t):(t=null,d.i=null,d.d=null),d.branch=d.t.serialize(t,{},(function(e,t,i){if(!++c||i.inode&&i.open)return{_id:i._id,_type:i._type,branch:i.branch,open:i.open}})),s){var p=function(t,i,l){var o=l.getTreeNodeHierarchy(t),s=l.generate_url(t,"nodes",i,!0);n.ajax({url:s,type:"GET",cache:!1,dataType:"json"}).done((function(e){var t=e.result||e.data;t._label=t.label,t.label=a.escape(t.label),d.t.setLabel(d.i,{label:t.label}),d.t.addIcon(d.i,{icon:t.icon}),d.t.setId(d.i,{id:t.id}),t.inode&&d.t.setInode(d.i,{inode:!0});var i=d.t.itemData(d.i);if(a.extend(i,t),!l.can_expand||"function"!=typeof l.can_expand||l.can_expand(i)){d.b._refreshNode(d,d.branch);var n=d.o&&d.o.success||d.success;n&&"function"==typeof n&&n()}else d.t.unload(d.i)})).fail((function(n,a,s){if(!u.pgHandleItemError(n,a,s,{item:t,info:o})){var c=n.getResponseHeader("Content-Type"),h=c&&0==c.indexOf("application/json")&&JSON.parse(n.responseText)||{};if(410==n.status&&0==h.success){var f=d.t.parent(d.i);d.t.remove(d.i,{success:function(){if(f)try{N.Events.trigger("pgadmin:browser:tree:refresh",f)}catch(e){console.warn(e.stack||e)}}})}r.default.pgNotifier(a,n,e("Error retrieving details for the node."),(function(e){"CRYPTKEY_SET"==e?p(t,i,l):console.warn(arguments)}))}}))}.bind(this);if(s&&s.collection_node){var h=d.i=this.tree.parent(t),f=function(){this.tree.unload(t,{success:function(){t=h,o=d.d=d.t.itemData(d.i),s=d.b.Nodes[o._type],p(t=h,o,s)},fail:function(){console.warn(arguments)}})}.bind(this);this.tree.isInode(t)?f():this.tree.setInode(t,{success:f})}else l?this.tree.unload(t,{success:p.bind(this,t,o,s),fail:function(){console.warn(arguments)}}):!this.tree.isInode(t)&&o.inode?this.tree.setInode(t,{success:p.bind(this,t,o,s),fail:function(){console.warn(arguments)}}):p(t,o,s)}else d.t.destroy({success:function(){I(d.b),d.t=d.b.tree,d.i=null,d.b._refreshNode(d,d.branch)},error:function(){var e=i.o&&i.o.fail||i.fail;"function"==typeof e&&e()}})},onLoadFailNode:function(e){var t=this,i=t.tree.isSelected(e);t.check_master_password((function(n){n||t.set_master_password("",(function(){i&&t.tree.select(e),t.tree.open(e)}))}))},removeChildTreeNodesById:function(e,t,i){var n=N.tree;if(e&&t){var a,l,o=n.children(e),s=0,r=o.length;for(e=null;s<r;s++)if(a=o[s],(l=n.itemData(a))._type==t){e=a;break}}if(e){for(s=0,r=(o=n.children(e)).length;s<r;s++)a=o[s],l=n.itemData(a),-1!=i.indexOf(l._id)&&N.removeTreeNode(a,!1,e);return!0}return!1},removeTreeNode:function(e,t,i){var n=N.tree,a=null;return!!e&&(t&&((a=n.next(e))||(a=n.prev(e))||(a=i||n.parent(e)),a&&n.select(a)),n.remove(e),!0)},findSiblingTreeNode:function(e,t){for(var i,n,a=N.tree,l=a.parent(e),o=a.children(l),s=0;s<o.length;s++)if(n=o[s],(i=a.itemData(n))&&i._id==t)return n;return null},findParentTreeNodeByType:function(e,t){var i,n=N.tree,a=e;do{if((i=n.itemData(a))&&i._type==t)return a;a=n.hasParent(a)?n.parent(a):null}while(a);return null},findChildCollectionTreeNode:function(e,t){var i,n,a=N.tree,l=0,o=e&&a.children(e);if(!o||!o.length)return null;for(;l<o.length;l++)if(n=o[l],(i=a.itemData(n))&&i._type==t)return n;return null},addChildTreeNodes:function(e,t,i,l,o){var s=i in N.Nodes&&N.Nodes[i],d=l.length&&a.extend({},a.mapObject(e,(function(e){return e.priority-=1,e}))),c=[],p=function e(a){if(l.length){var p,u={_id:l.pop(),_type:i,priority:0};d[i]=u,p=s.generate_url(null,"nodes",u,!0,d),t=t||arguments[1],n.ajax({url:p,dataType:"json"}).done((function(t){t.success&&c.push(t.data),e(o)})).fail((function(t,i,n){r.default.pgRespErrorNotify(t,n),e(o)}))}else a&&a()};s?N.tree.wasLoad(t)||N.tree.isLeaf(t)?p((function(){a.each(c,(function(t){N.Events.trigger("pgadmin:browser:tree:add",t,e)})),o&&o()})):o&&o():console.warn("Developer: Couldn't find the module for the given child: ",a.clone(arguments))},_refreshNode:function(e,t){var i=function(e){for(var t,i,n=this,a=0,l=e.branch&&e.branch.length||0,o=function(e,t,i){setTimeout((function(){i.b._findTreeChildNode(e,t,i)}),0)};a<l;a++){i=e.branch[a];var s=n.b.Nodes[i._type];(t={b:n.b,t:n.t,pathOfTreeItems:[],i:n.i,d:i,select:n.select,hasId:s&&!s.collection_node,o:n.o,load:!0}).success=function(){this.b._refreshNode.call(this.b,this,this.d)}.bind(t),o(n.i,i,t)}}.bind(e,t);t&&t.open&&(e.t.isOpen(e.i)?i():e.t.open(e.i,{unanimated:!0,success:i,fail:function(){}}))},editor_shortcut_keys:{"Ctrl-Space":"autocomplete","Cmd-Space":"autocomplete","Alt-Up":"goLineUp","Alt-Down":"goLineDown","Ctrl-Alt-Left":"goGroupLeft","Cmd-Alt-Left":"goGroupLeft","Ctrl-Alt-Right":"goGroupRight","Cmd-Alt-Right":"goGroupRight","Shift-Tab":"indentLess"},editor_options:{tabSize:parseInt(N.utils.tabSize),wrapCode:N.utils.wrapCode,insert_pair_brackets:N.utils.insertPairBrackets,brace_matching:N.utils.braceMatching,indent_with_tabs:N.utils.is_indent_with_tabs},get_browser:function(){var e,t=navigator.userAgent,i=t.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(i[1])?{name:"IE",version:(e=/\brv[ :]+(\d+)/g.exec(t)||[])[1]||""}:"Chrome"===i[1]&&null!=(e=t.match(/\bOPR|Edge\/(\d+)/))?{name:e[0],version:e[1]}:(i=i[2]?[i[1],i[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(e=t.match(/version\/(\d+)/i))&&i.splice(1,1,e[1]),{name:i[0],version:i[1]})}}),delete E.keyMap.emacsy["Ctrl-V"],"True"==N.utils.useSpaces&&(c.Browser.editor_shortcut_keys.Tab="insertSoftTab"),setTimeout((function(){n("#mnu_about").closest("li").before('<li class="dropdown-divider"></li>')}),100),c.Browser}.apply(t,n),void 0===a||(e.exports=a)},5547:(e,t,i)=>{var n,a;i(82772),i(69826);var l=i(44434);n=[i(91669),i(19755),i(66419),i(55112),i(72316),i(58307),i(95283),i(83879),i(61329),i(12030),i(71158),i(66235),i(14753)],void 0===(a=function(e,t,i,n,a,o,s,r,d){var c=n.Browser=n.Browser||{};return c.Collection||(c.Collection=function(){},i.extend(c.Collection,i.clone(c.Node),{Init:function(){this.node_initialized||(this.node_initialized=!0,n.Browser.add_menus([{name:"refresh",node:this.type,module:this,applies:["object","context"],callback:"refresh",priority:2,label:e("Refresh"),icon:"fa fa-sync-alt"}]),n.unsupported_nodes&&-1==i.indexOf(n.unsupported_nodes,this.type)&&("database"==this.type&&this.allowConn||"database"!=this.type)&&(n.Browser.add_menus([{name:"show_query_tool",node:this.type,module:this,applies:["context"],callback:"show_query_tool",priority:998,label:e("Query Tool"),icon:"pg-font-icon icon-query_tool"}]),n.Browser.add_menus([{name:"search_objects",node:this.type,module:this,applies:["context"],callback:"show_search_objects",priority:997,label:e("Search Objects..."),icon:"fa fa-search"}]),n.enable_psql&&n.Browser.add_menus([{name:"show_psql_tool",node:this.type,module:this,applies:["context"],callback:"show_psql_tool",priority:998,label:e("PSQL Tool"),icon:"fas fa-terminal"}])))},hasId:!1,is_collection:!0,collection_node:!0,hasCollectiveStatistics:!0,canDrop:!0,canDropCascade:!0,selectParentNodeOnDelete:!1,showProperties:function(e,t,i){var n=i.$container.find(".obj_properties").first();(0,l.getPanelView)(c.tree,n[0],c,i._type)},generate_url:function(e,t){var i={properties:"obj",children:"nodes",drop:"obj"},a=this,l=c.tree.getTreeNodeHierarchy(e),o=t in i?i[t]:t;return d.generate_url(n.Browser.URL,l,o,a.node,(function(e,t){return t!=a.type}))},show_query_tool:function(){n.Tools.SQLEditor&&n.Tools.SQLEditor.showQueryTool("",n.Browser.tree.selected())},show_search_objects:function(){n.SearchObjects&&n.SearchObjects.show_search_objects("",n.Browser.tree.selected())},show_psql_tool:function(e){var t=e||{},i=c.tree,n=t.item||i.selected(),a=n?i.itemData(n):void 0;c.psql.psql_tool(a,n,!0)}})),c.Collection}.apply(t,n))||(e.exports=a)},30794:(e,t,i)=>{var n,a;function l(e,t){var i;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(i=function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return o(e,t)}(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,s=!0,r=!1;return{s:function(){i=e[Symbol.iterator]()},n:function(){var e=i.next();return s=e.done,e},e:function(e){r=!0,l=e},f:function(){try{s||null==i.return||i.return()}finally{if(r)throw l}}}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}i(82526),i(41817),i(32165),i(78783),i(47042),i(91038),i(79753),i(41539),i(66992),i(33948),i(68309),i(5212),i(39714),i(83710),i(5735),i(83753),i(34553),i(32564),i(69826),i(24603),i(74916),i(40561),i(47941),n=[i(66419),i(55112),i(19755),i(72316),i(44092)],void 0===(a=function(e,t,i,n,a){var o=t.Browser=t.Browser||{};return o.DataModel=n.Model.extend({on_server:!1,parse:function(t){var i=this;t&&e.isObject(t)&&"node"in t&&t.node&&(i.tnode=e.extend({},t.node),delete t.node);return function a(l){l&&e.isArray(l)&&e.each(l,(function(l){var s,r;switch(l.type){case"collection":s=i.get(l.id),r=t[l.id],e.isArray(r)||e.isObject(r)?s&&s instanceof n.Collection?s.reset(r,{silent:!0,parse:!0,on_server:!0}):(s=new o.Node.Collection(r,{model:e.isString(l.model)&&l.model in o.Nodes?o.Nodes[l.model].model:l.model,top:i.top||i,handler:i,parse:!0,silent:!0,attrName:l.id}),i.set(l.id,s,{silent:!0,parse:!0,on_server:!0})):s=null,i.set(l.id,s,{silent:!0}),t[l.id]=s;break;case"model":s=i.get(l.id),r=t[l.id],e.isUndefined(r)||e.isNull(r)?s=null:(s&&s instanceof n.Model||(s=e.isString(l.model)&&l.model in o.Nodes[l.model]?new o.Nodes[l.model].Model(s,{silent:!0,top:i.top||i,handler:i,attrName:l.id}):new l.model(s,{silent:!0,top:i.top||i,handler:i,attrName:l.id})),s.set(r,{parse:!0,silent:!0})),t[l.id]=s;break;case"nested":a(l.schema)}}))}(i.schema),t},isNew:function(){return this.has(this.idAttribute)?!this.has(this.idAttribute):!this.on_server},primary_key:function(){if(this.keys&&e.isArray(this.keys)){var t={},i=this;return e.each(i.keys,(function(e){t[e]=i.attributes[e]})),JSON.stringify(t)}return this.cid},initialize:function(t,i){var a,l=this;l._previous_key_values={},!e.isUndefined(i)&&"on_server"in i&&i.on_server&&(l.on_server=!0),n.Model.prototype.initialize.apply(l,arguments),(e.isUndefined(i)||e.isNull(i))&&(i=t||{}),l.sessAttrs={},l.fieldData={},l.origSessAttrs={},l.objects=[],l.arrays=[],l.attrName=i.attrName,l.top=i.top||l.collection&&l.collection.top||l.collection||l,l.handler=i.handler||l.collection&&l.collection.handler,l.trackChanges=!1,l.errorModel=new n.Model,l.node_info=i.node_info;var s=function t(i){i&&e.isArray(i)&&e.each(i,(function(i){switch(i.type){case"int":case"numeric":l.fieldData[i.id]={id:i.id,label:i.label,type:i.type,min:e.isUndefined(i.min)?void 0:i.min,max:e.isUndefined(i.max)?void 0:i.max};break;default:l.fieldData[i.id]={id:i.id,label:i.label,type:i.type}}switch(i.type){case"array":l.arrays.push(i.id);break;case"collection":if(!((a=l.get(i.id))&&a instanceof o.Node.Collection))if(e.isString(i.model)&&i.model in o.Nodes){var s=o.Nodes[i.model];a=new s.Collection(a,{model:s.model,top:l.top||l,handler:l,attrName:i.id})}else a=new o.Node.Collection(a,{model:i.model,top:l.top||l,handler:l,attrName:i.id});a.name=i.id,l.objects.push(i.id),l.set(i.id,a,{silent:!0});break;case"model":(a=l.get(i.id))&&a instanceof n.Model||(a=e.isString(i.model)&&i.model in o.Nodes[i.model]?new o.Nodes[i.model].Model(a,{top:l.top||l,handler:l,attrName:i.id}):new i.model(a,{top:l.top||l,handler:l,attrName:i.id})),a.name=i.id,l.objects.push(i.id),l.set(i.id,a,{silent:!0});break;case"nested":t(i.schema);break;default:return}}))};return s(l.schema),l.handler&&l.handler.trackChanges&&l.startNewSession(),"keys"in l&&e.isArray(l.keys)&&e.each(l.keys,(function(e){l.on("change:"+e,(function(t){l._previous_key_values[e]=t.previous(e)}))})),l},reset:function(e){var t,i=!(!e||!e.reindex);if(e&&e.stop&&this.stopSession(),i){for(var a in this.objects)(t=this.get(a))&&(t instanceof o.DataModel?t.reset(e):t instanceof n.Model?t.clear(e):t instanceof o.DataCollection?t.reset([],e):t instanceof n.Collection&&(t.each((function(i){i instanceof n.DataModel&&(t.reset(),t.clear(e))})),n.Collection.prototype.reset.call(t,[],e)));n.Collection.prototype.reset.apply(this,arguments)}},sessChanged:function(){var t=this;return e.size(t.sessAttrs)>0||e.some(t.objects,(function(i){var n=t.get(i);return!e.isNull(n)&&!e.isUndefined(n)&&n.sessChanged()}))},sessValid:function(){var t=this;return(!("default_validate"in t)||"function"!=typeof t.default_validate||!e.isString(t.default_validate()))&&!("validate"in t&&e.isFunction(t.validate)&&e.isString(t.validate.apply(t)))},set:function(t,i,a){var l=e.isObject(t)?i:a;this._changing=!0,this._previousAttributes=e.clone(this.attributes),this.changed={};var o=n.Model.prototype.set.call(this,t,i,a);if(this._changing=!1,l&&l.internal||!this.trackChanges)return!0;if(null!=t&&o){var r,d={},c=this,p=function(t,i){if(!(i in c.objects)){d[i]=t;var n=c.origSessAttrs[i]&&t;e.isEqual(c.origSessAttrs[i],t)||null===c.origSessAttrs[i]&&""===t||n&&e.isEqual(c.origSessAttrs[i].toString(),t.toString())?delete c.sessAttrs[i]:c.sessAttrs[i]=t}};return"object"===s(t)?e.each(t,p):p(i,t),c.trigger("pgadmin-session:set",c,d),l&&l.silent||c.trigger("change",c,l),"default_validate"in c&&"function"==typeof c.default_validate&&(r=c.default_validate()),"validate"in c&&"function"==typeof c.validate&&(r||(r=c.validate(e.keys(d)))),0==e.size(c.errorModel.attributes)?c.collection||c.handler?(c.collection||c.handler).trigger("pgadmin-session:model:valid",c,c.collection||c.handler):c.trigger("pgadmin-session:valid",c.sessChanged(),c):(r=r||e.values(c.errorModel.attributes)[0],c.collection||c.handler?(c.collection||c.handler).trigger("pgadmin-session:model:invalid",r,c,c.collection||c.handler):c.trigger("pgadmin-session:invalid",r,c)),o}return o},toJSON:function(t,i){var a,l=this,o=l.isNew();return!(t=void 0!==t&&1==t)||o?a=n.Model.prototype.toJSON.call(this,arguments):((a={})[l.idAttribute||"_id"]=l.get(l.idAttribute||"_id"),a=e.extend(a,l.sessAttrs)),e.each(l.objects,(function(e){var n=l.get(e);t?a[e]instanceof Array?a[e]=JSON.stringify(a[e]):n&&n.sessChanged&&n.sessChanged()||o?(a[e]=n&&n.toJSON(!o),n&&i&&"GET"==i&&(a[e]=JSON.stringify(a[e]))):delete a[e]:a[e]instanceof Array||(a[e]=n&&n.toJSON())})),t&&e.each(l.arrays,(function(e){a[e]&&a[e]instanceof Array&&(a[e]=JSON.stringify(a[e]))})),a},startNewSession:function(){var t=this;t.trackChanges&&(t.trigger("pgadmin-session:stop",t),t.off("pgadmin-session:model:invalid",t.onChildInvalid),t.off("pgadmin-session:model:valid",t.onChildValid),t.off("pgadmin-session:changed",t.onChildChanged),t.off("pgadmin-session:added",t.onChildChanged),t.off("pgadmin-session:removed",t.onChildChanged)),t.trackChanges=!0,t.sessAttrs={},t.origSessAttrs=e.clone(t.attributes),e.each(t.objects,(function(i){var n=t.get(i);e.isUndefined(n)||e.isNull(n)||(delete t.origSessAttrs[i],n&&"startNewSession"in n&&e.isFunction(n.startNewSession)&&n.startNewSession())})),t.trigger("pgadmin-session:start",t),t.on("pgadmin-session:model:invalid",t.onChildInvalid),t.on("pgadmin-session:collection:changed",t.onChildCollectionChanged),t.on("pgadmin-session:model-msg:changed",t.onModelChangedMsg),t.on("pgadmin-session:model:valid",t.onChildValid),t.on("pgadmin-session:changed",t.onChildChanged),t.on("pgadmin-session:added",t.onChildChanged),t.on("pgadmin-session:removed",t.onChildChanged)},onChildInvalid:function(t,i){var n=this;if(n.trackChanges&&i){var a=i.attrName;if(!a){var l=i.primary_key&&"function"==typeof i.primary_key,o=l?i.primary_key():i.cid,s=l?function(e){var t=n.get("k");return!(!t||t.primary_key()!==o)&&(a=e,!0)}:function(e){return n.get(e).cid===o&&(a=e,!0)};e.findIndex(n.objects,s)}a&&(n.errorModel.set(a,t),n.handler?n.handler.trigger("pgadmin-session:model:invalid",t,n,n.handler):n.trigger("pgadmin-session:invalid",t,n))}return this},onChildValid:function(t){var i=this;if(i.trackChanges&&t){var a=t.attrName;if(!a){var l=t.primary_key&&"function"==typeof t.primary_key,o=l?t.primary_key():t.cid,s=l?function(e){var t=i.get("k");return!(!t||t.primary_key()!==o)&&(a=e,!0)}:function(e){var t=i.get("k");return!(!t||t.cid!==o)&&(a=e,!0)};e.findIndex(i.objects,s)}var r=null,d=function(t,i){return"default_validate"in t&&"function"==typeof t.default_validate&&(r=t.default_validate(),e.isString(r))?r:"validate"in t&&"function"==typeof t.validate?r=t.validate(i):null};if(t instanceof n.Collection){for(var c in t.models)if(d(t.models[c]))break}else t instanceof n.Model&&d(t);a&&i.errorModel.has(a)&&(r?i.errorModel.set(a,r):i.errorModel.unset(a)),0!=e.size(i.errorModel.attributes)||d(i,a&&[a])?(r=r||e.values(i.errorModel.attributes)[0],i.handler?(i.handler.trigger("pgadmin-session:model:invalid",r,i,i.handler),i.handler.trigger("pgadmin-session:collection:changed",i,i.handler)):(i.trigger("pgadmin-session:invalid",r,i),i.trigger("pgadmin-session:collection:changed",i))):i.handler?(i.handler.trigger("pgadmin-session:model:valid",i,i.handler),i.handler.trigger("pgadmin-session:collection:changed",i,i.handler)):(i.trigger("pgadmin-session:valid",i.sessChanged(),i),i.trigger("pgadmin-session:collection:changed",i.sessChanged(),i))}},onChildCollectionChanged:function(t,a){var o=this,s=this;setTimeout((function(){var t,r,d,c,p=null,u=s.collection||a;if(u){var h=u.attrName||u.name,f=i(".show.active div."+h);i(f).find(".error-in-grid").removeClass("error-in-grid");e:if(u instanceof n.Collection)for(var m in u.models){var g,v=u.models[m],b=l(v.objects);try{for(b.s();!(g=b.n()).done;){var y=g.value,C=v.attributes[y];if(C&&C.models.length>0)for(var w in C.models)if(d=C.models[w],c=void 0,"default_validate"in d&&"function"==typeof d.default_validate&&(p=d.default_validate(),e.isString(p))?p:"validate"in d&&"function"==typeof d.validate&&(p=d.validate(c))){t=C.models[w],r=v.parentTr;break e}}}catch(e){b.e(e)}finally{b.f()}}}return p&&t&&(p=p||e.values(t.errorModel.attributes)[0],t.trigger("pgadmin-session:model:invalid",p,t),i(r).addClass("error-in-grid")),o}),120)},onChildChanged:function(e){var t=this;t.trackChanges&&t.collection&&t.collection.trigger("change",t),t.trigger("pgadmin-session:collection:changed",t,e)},stopSession:function(){var t=this;t.trackChanges&&(t.off("pgadmin-session:model:invalid",t.onChildInvalid),t.off("pgadmin-session:model:valid",t.onChildValid),t.off("pgadmin-session:changed",t.onChildChanged),t.off("pgadmin-session:added",t.onChildChanged),t.off("pgadmin-session:removed",t.onChildChanged),t.off("pgadmin-session:collection:changed",t.onChildCollectionChanged)),t.trackChanges=!1,t.sessAttrs={},t.origSessAttrs={},e.each(t.objects,(function(i){var n=t.get(i);e.isUndefined(n)||e.isNull(n)||(t.origSessAttrs[i]=null,delete t.origSessAttrs[i],n&&"stopSession"in n&&e.isFunction(n.stopSession)&&n.stopSession())})),t.trigger("pgadmin-session:stop")},default_validate:function(){for(var t,i,n,a,l=0,o=e.keys(this.attributes),s=o.length;l<s;l++)if(n=this.attributes[o[l]],i=this.fieldData[o[l]],t=null,e.isUndefined(n)||e.isNull(n)||""===String(n))i&&this.errorModel.unset(i.id);else{if(!i)continue;if(!(a=i.type||void 0))continue;switch(a){case"int":t=this.integer_validate(n,i);break;case"numeric":t=this.number_validate(n,i)}if(t)return this.errorModel.set(i.id,t),t;this.errorModel.unset(i.id)}return null},check_min_max:function(i,n){var l=n.label,o=n.min,s=n.max;return!e.isUndefined(o)&&i<o?a.sprintf(t.Browser.messages.MUST_GR_EQ,l,o):!e.isUndefined(s)&&i>s?a.sprintf(t.Browser.messages.MUST_LESS_EQ,l,s):null},number_validate:function(e,i){return new RegExp("^-?[0-9]+(.?[0-9]*)?$").test(e)?this.check_min_max(e,i):a.sprintf(t.Browser.messages.MUST_BE_NUM,i.label)},integer_validate:function(e,i){return new RegExp("^-?[0-9]*$").test(e)?this.check_min_max(e,i):a.sprintf(t.Browser.messages.MUST_BE_INT,i.label)}}),o.DataCollection=n.Collection.extend({initialize:function(e,t){var i=this;return t=t||{},i.sessAttrs={changed:[],added:[],deleted:[],invalid:[]},i.top=t.top||i,i.attrName=t.attrName,i.handler=t.handler,i.trackChanges=!1,i.on("add",i.onModelAdd),i.on("remove",i.onModelRemove),i.on("change",i.onModelChange),i.handler&&i.handler.trackChanges&&i.startNewSession(),i},startNewSession:function(){var t,i=this;i.trackChanges&&(i.trigger("pgadmin-session:stop",i),i.off("pgadmin-session:model:invalid",i.onModelInvalid),i.off("pgadmin-session:model:valid",i.onModelValid)),i.trackChanges=!0,i.sessAttrs={changed:[],added:[],deleted:[],invalid:[]},e.each(i.models,(function(n){"startNewSession"in n&&e.isFunction(n.startNewSession)&&n.startNewSession(),"default_validate"in n&&"function"==typeof n.default_validate&&(t=n.default_validate()),(e.isString(t)||"validate"in n&&"function"==typeof n.validate&&(t=n.validate()))&&(i.sessAttrs.invalid[n.cid]=t)})),i.trigger("pgadmin-session:start",i),i.on("pgadmin-session:model:invalid",i.onModelInvalid),i.on("pgadmin-session:model:valid",i.onModelValid)},onModelInvalid:function(e,t){var i=this,n=i.sessAttrs.invalid;return i.trackChanges&&(n[t.cid]=e,i.handler?i.handler.trigger("pgadmin-session:model:invalid",e,i,i.handler):i.trigger("pgadmin-session:invalid",e,i)),!0},onModelValid:function(e){var t=this,i=t.sessAttrs.invalid;if(t.trackChanges){var n=t.checkDuplicateWithModel(e);n&&e.cid in i&&delete i[e.cid],n&&this.triggerValidationEvent.apply(this)}return!0},stopSession:function(){var t=this;t.trackChanges=!1,t.sessAttrs={changed:[],added:[],deleted:[],invalid:[]},e.each(t.models,(function(t){"stopSession"in t&&e.isFunction(t.stopSession)&&t.stopSession()}))},sessChanged:function(){return this.sessAttrs.changed.length>0||this.sessAttrs.added.length>0||this.sessAttrs.deleted.length>0},toJSON:function(t){var i=this;if(t=void 0!==t&&1==t){var a={added:[]};return e.each(this.sessAttrs.added,(function(e){a.added.push(e.toJSON())})),0==a.added.length&&delete a.added,a.changed=[],e.each(i.sessAttrs.changed,(function(e){a.changed.push(e.toJSON(!0))})),0==a.changed.length&&delete a.changed,a.deleted=[],e.each(i.sessAttrs.deleted,(function(e){a.deleted.push(e.toJSON())})),0==a.deleted.length&&delete a.deleted,0==e.size(a)?null:a}return n.Collection.prototype.toJSON.call(i)},reset:function(e,t){t&&t.stop&&this.stopSession(),this.each((function(e){e&&(e instanceof o.DataModel?e.reset(t):e.clear(t))})),n.Collection.prototype.reset.apply(this,arguments)},objFindInSession:function(t,i){var n=t.primary_key&&"function"==typeof t.primary_key,a=n?t.primary_key():t.cid,l=n?function(e){return e.primary_key()===a}:function(e){return e.cid===a};return e.findIndex(this.sessAttrs[i],l)},onModelAdd:function(t){if(this.trackChanges){var i,n=this,a=n.objFindInSession(t,"deleted");if(a>=0){var l=n.sessAttrs.deleted[a];t.origSessAttrs=e.clone(l.origSessAttrs),t.attributes=e.extend(t.attributes,l.attributes),t.sessAttrs=e.clone(l.sessAttrs),n.sessAttrs.deleted.splice(a,1),"sessChanged"in t&&!t.sessChanged()||n.sessAttrs.changed.push(t),(n.handler||n).trigger("pgadmin-session:added",n,t),"default_validate"in t&&"function"==typeof t.default_validate&&(i=t.default_validate()),(e.isString(i)||"validate"in t&&"function"==typeof t.validate&&(i=t.validate()))&&(n.sessAttrs.invalid[t.cid]=i)}else"default_validate"in t&&"function"==typeof t.default_validate&&(i=t.default_validate()),(e.isString(i)||"validate"in t&&"function"==typeof t.validate&&(i=t.validate()))&&(n.sessAttrs.invalid[t.cid]=i),n.sessAttrs.added.push(t),(n.handler||n).trigger("pgadmin-session:added",n,t);this.triggerValidationEvent.apply(this),n.trigger("pgadmin-session:collection:changed",n)}return!0},onModelRemove:function(t){if(this.trackChanges){t.errorModel.clear();var i=this,n=i.sessAttrs.invalid,a=e.clone(t),l=i.objFindInSession(t,"added");t.cid in n&&delete n[t.cid],l>=0?(i.sessAttrs.added.splice(l,1),(i.handler||i).trigger("pgadmin-session:removed",i,a),i.checkDuplicateWithModel(a),this.triggerValidationEvent.apply(this)):((l=i.objFindInSession(t,"changed"))>=0?(i.sessAttrs.changed.splice(l,1),(i.handler||i).trigger("pgadmin-session:removed",i,a)):(i.handler||i).trigger("pgadmin-session:removed",i,a),t.set(t.origSessAttrs,{silent:!0}),i.sessAttrs.deleted.push(t),i.checkDuplicateWithModel(t),this.triggerValidationEvent.apply(this))}return!0},triggerValidationEvent:function(){var e=this,t=null,i=e.sessAttrs.invalid,n=[];for(var a in i){if(t=i[a])break;n.push(a)}for(a in n)delete i[n[a]];t?e.handler?e.handler.trigger("pgadmin-session:model:invalid",t,e,e.handler):e.trigger("pgadmin-session:invalid",t,e):e.handler?e.handler.trigger("pgadmin-session:model:valid",e,e.handler):e.trigger("pgadmin-session:valid",e.sessChanged(),e)},onModelChange:function(e){var t=this;if(this.trackChanges&&e instanceof o.Node.Model){var i=t.objFindInSession(e,"added");i>=0?(t.handler||t).trigger("pgadmin-session:changed",t,e):(i=t.objFindInSession(e,"changed"),"sessChanged"in e?i>=0?(e.sessChanged()||t.sessAttrs.changed.splice(i,1),(t.handler||t).trigger("pgadmin-session:changed",t,e)):e.sessChanged()&&(t.sessAttrs.changed.push(e),(t.handler||t).trigger("pgadmin-session:changed",t,e)):((t.handler||t).trigger("pgadmin-session:changed",t,e),i<0&&t.sessAttrs.changed.push(e)))}return!0},checkDuplicateWithModel:function(t){if(!("keys"in t)||e.isEmpty(t.keys))return!0;var i=this,n={},a={};e.each(t.keys,(function(e){n[e]=t.get(e),e in t._previous_key_values?a[e]=t._previous_key_values[e]:a[e]=t.previous(e)})),t._previous_key_values={};var l=i.where(a);if(1==l.length){var o=l[0];i.clearInvalidSessionIfModelValid(o)}var s=i.where(n);if(0==s.length)i.clearInvalidSessionIfModelValid(t);else{if(1!=s.length){var r="Duplicate rows.";return setTimeout((function(){e.each(s,(function(e){i.trigger("pgadmin-session:model:invalid",r,e,i.handler),e.trigger("pgadmin-session:model:duplicate",e,r)}))}),10),!1}i.clearInvalidSessionIfModelValid(t),i.clearInvalidSessionIfModelValid(s[0])}return!0},clearInvalidSessionIfModelValid:function(t){var i=t.errorModel.attributes,n=this.sessAttrs.invalid;t.trigger("pgadmin-session:model:unique",t),0==e.size(i)?delete n[t.cid]:n[t.cid]=i[Object.keys(i)[0]]}}),o.Events=e.extend({},n.Events),o}.apply(t,n))||(e.exports=a)},66092:(e,t,i)=>{var n,a,l,o=(l=i(55958))&&l.__esModule?l:{default:l};n=[i(91669),i(66419),i(55112)],void 0===(a=function(e,t,i){return i.Browser=i.Browser||{},t.extend(i.Browser,{report_error:function(i,n,a,l){i=t.escape(i),n=t.escape(n),a=t.escape(a);var s='<div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true"><div class="panel panel-default"><div class="panel-heading" role="tab" id="headingOne"><h4 class="panel-title"><a data-toggle="collapse" data-parent="#accordion" href="#collapseOne" aria-expanded="true" aria-controls="collapseOne">'+e("Error message")+'</a></h4></div><div id="collapseOne" class="panel-collapse collapse show" role="tabpanel" aria-labelledby="headingOne"><div class="panel-body" style="overflow: auto;">'+n+"</div></div></div>";null!=a&&""!=a&&(s+='<div class="panel panel-default"><div class="panel-heading" role="tab" id="headingTwo"><h4 class="panel-title"><a class="collapsed" data-toggle="collapse" data-parent="#accordion" href="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">'+e("Additional info")+'</a></h4></div><div id="collapseTwo" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingTwo"><div class="panel-body" style="overflow: auto;">'+a+"</div></div></div></div>"),s+="</div>",o.default.alert(t.unescape(i),s,(function(){l&&l()}))}}),i.Browser.report_error}.apply(t,n))||(e.exports=a)},58688:(e,t,i)=>{var n,a;i(68309),i(32564),i(24812),n=[i(66419),i(55112),i(19755),i(35816)],void 0===(a=function(e,t,i){var n=t.Browser=t.Browser||{},a=window.wcDocker,l=window.wcIFrame;return t.Browser.Frame=function(t){e.extend(this,e.pick(t,["name","title","width","height","showTitle","isCloseable","isPrivate","url","icon","onCreate","isLayoutMember"]))},e.extend(t.Browser.Frame.prototype,{name:"",title:"",width:300,height:600,showTitle:!0,isClosable:!0,isRenamable:!1,isPrivate:!1,isLayoutMember:!1,url:"",icon:"",panel:null,frame:null,onCreate:null,load:function(t){var o=this;o.panel||t.registerPanelType(this.name,{title:o.title,isPrivate:o.isPrivate,isLayoutMember:o.isLayoutMember,onCreate:function(t){i(t).data("pgAdminName",o.name),t.initSize(o.width,o.height),0==t.showTitle&&t.title(!1),t.icon(o.icon),t.closeable(!!o.isCloseable),t.renamable(o.isRenamable);var s=i('<div style="position:absolute;top:0 !important;width:100%;height:100%;display:table;z-index:0;">');t.layout().addItem(s),o.panel=t;var r=new l(s,t);i(t).data("frameInitialized",!1),i(t).data("embeddedFrame",r),""!=o.url&&"about:blank"!=o.url?setTimeout((function(){r.openURL(o.url),i(t).data("frameInitialized",!0),n.Events.trigger("pgadmin-browser:frame:urlloaded:"+o.name,r,o.url,self)}),50):(r.openURL("about:blank"),i(t).data("frameInitialized",!0),n.Events.trigger("pgadmin-browser:frame:urlloaded:"+o.name,r,o.url,self)),o.events&&e.isObject(o.events)&&e.each(o.events,(function(i,n){i&&e.isFunction(i)&&t.on(n,i)})),e.each([a.EVENT.UPDATED,a.EVENT.VISIBILITY_CHANGED,a.EVENT.BEGIN_DOCK,a.EVENT.END_DOCK,a.EVENT.GAIN_FOCUS,a.EVENT.LOST_FOCUS,a.EVENT.CLOSED,a.EVENT.BUTTON,a.EVENT.ATTACHED,a.EVENT.DETACHED,a.EVENT.MOVE_STARTED,a.EVENT.MOVE_ENDED,a.EVENT.MOVED,a.EVENT.RESIZE_STARTED,a.EVENT.RESIZE_ENDED,a.EVENT.RESIZED,a.EVENT.SCROLLED],(function(e){t.on(e,o.eventFunc.bind(t,e))})),o.onCreate&&e.isFunction(o.onCreate)&&o.onCreate.apply(o,[t,r])}})},eventFunc:function(e){var t=i(this).data("pgAdminName");try{n.Events.trigger("pgadmin-browser:frame",e,this,arguments),n.Events.trigger("pgadmin-browser:frame:"+e,this,arguments),t&&(n.Events.trigger("pgadmin-browser:frame-"+t,e,this,arguments),n.Events.trigger("pgadmin-browser:frame-"+t+":"+e,this,arguments))}catch(e){console.warn(e.stack||e)}}}),t.Browser.Frame}.apply(t,n))||(e.exports=a)},50521:(e,t,i)=>{var n,a;function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}i(82526),i(41817),i(41539),i(32165),i(78783),i(66992),i(33948),i(24812),i(68309),i(69826),i(82772),i(69600),i(2707),n=[i(66419),i(55112),i(19755),i(44092),i(91669)],void 0===(a=function(e,t,i,n,a){t.Browser=t.Browser||{};var o=t.Browser.MenuItem=function(t){e.extend(this,{url:"#",target:"_self",enable:!0},e.pick(t,["name","label","priority","module","callback","data","enable","category","target","url","node","checked","below","menu_items"]))};e.extend(t.Browser.MenuItem.prototype,{$el:null,generate:function(e,t){return this.create_el(e,t),this.context={name:this.label,disabled:this.is_disabled,callback:this.context_menu_callback.bind(this,t)},this.$el},create_el:function(n,a){if(this.menu_items){e.each(this.menu_items,(function(e){e.generate(n,a)}));var l=t.Browser.MenuGroup({label:this.label,id:this.name},this.menu_items);this.$el=l.$el}else{var o=null;null!=this.data&&null!=this.data.data_disabled&&(o=this.data.data_disabled);var s=i("<a></a>",{id:this.name,href:this.url,target:this.target,"data-toggle":"pg-menu",role:"menuitem","data-disabled":o}).data("pgMenu",{module:this.module||t.Browser,cb:this.callback,data:this.data}).addClass("dropdown-item");this.is_disabled=this.disabled(n,a),this.icon?s.append(i("<i></i>",{class:this.icon})):e.isUndefined(this.checked)||s.append(i("<i></i>",{class:"fa fa-check "+(this.checked?"":"visibility-hidden")})),s.addClass(this.is_disabled?" disabled":"");var r=i('<span data-test="menu-item-text"></span>').text("  "+this.label);s.append(r);var d=i("<li/>").append(s);e.isUndefined(this.below)||!0!==this.below||d.append('<li class="dropdown-divider"></li>'),this.$el=d}},update:function(e,t){this.$el&&!this.$el.find(".dropdown-item").hasClass("disabled")&&this.$el.find(".dropdown-item").addClass("disabled"),this.is_disabled=this.disabled(e,t),this.$el&&!this.is_disabled&&this.$el.find(".dropdown-item").removeClass("disabled"),this.context={name:this.label,disabled:this.is_disabled,callback:this.context_menu_callback.bind(this,t)}},context_menu_callback:function(e){var i,a=this;a.module.callbacks&&a.callback in a.module.callbacks?i=a.module.callbacks[a.callback]:a.callback in a.module&&(i=a.module[a.callback]),i?i.apply(a.module,[a.data,e]):t.Browser.report_error(n.sprintf('Developer Warning: Callback - "%s" not found!',a.cb))},disabled:function(t,i){if(null==this.enable)return!1;if(this.node){if(!t)return!0;if(e.isArray(this.node)?-1==e.indexOf(this.node,t):this.node!=t._type)return!0}return e.isBoolean(this.enable)?!this.enable:e.isFunction(this.enable)?!this.enable.apply(this.module,[t,i,this.data]):this.module&&e.isBoolean(this.module[this.enable])?!this.module[this.enable]:!(!this.module||!e.isFunction(this.module[this.enable]))&&!this.module[this.enable].apply(this.module,[t,i,this.data])},change_checked:function(t){e.isUndefined(this.checked)||(this.checked=t,this.checked?this.$el.find(".fa-check").removeClass("visibility-hidden"):this.$el.find(".fa-check").addClass("visibility-hidden"))}}),t.Browser.MenuGroup=function(t,n,a,l){var o,s=e.template(['<% if (above) { %><li class="dropdown-divider"></li><% } %>','<li class="dropdown-submenu" role="menuitem">',' <a href="#" class="dropdown-item">','  <% if (icon) { %><i class="<%= icon %>"></i><% } %>',"  <span><%= label %></span>"," </a>",' <ul class="dropdown-menu">'," </ul>","</li>",'<% if (below) { %><li class="dropdown-divider"></li><% } %>'].join("\n")),r={label:t.label,icon:t.icon,above:t.above&&!a,below:t.below},d=i(s(r)),c=d.find(".dropdown-menu"),p={},u=1;for(var h in l=e.uniqueId(l+"_sub_"),n.sort((function(e,t){return e.label.localeCompare(t.label)})),n.sort((function(e,t){return e.priority-t.priority})),n)o=n[h],c.append(o.$el),o.is_disabled||(p[l+u]=o.context),u++;var f=0==e.size(p);return{$el:d,priority:t.priority||10,label:t.label,above:r.above,below:t.below,is_disabled:f,context:{name:t.label,icon:t.icon,items:p,disabled:f}}},t.Browser.MenuCreator=function(i,n,l,s,r,d,c){var p=!0;if(r&&i[r._type]&&!e.isUndefined(i[r._type].showMenu)&&(p=i[r._type].showMenu(r,d)),p){var u,h={common:[]},f=0,m=e.uniqueId("ctx_"),g=function e(t){if(t instanceof o)t.$el&&(t.$el.remove(),delete t.$el),t.generate(r,d),(h[t.category||"common"]=h[t.category||"common"]||[]).push(t);else for(var i in t)e(t[i])},v=1;for(f in l)g(l[f]);c=c||{},u=h.common,delete h.common;var b=!0;for(var y in h){var C=h[y],w=s[y]||{label:y,single:!1},_=t.Browser.MenuGroup(w,C,b,m);if(C.length<=1&&!w.single)for(f in b=!1,C)u.push(C[f]);else b=C.below,u.push(_)}u.sort((function(e,t){return e.label.localeCompare(t.label)})),u.sort((function(e,t){return e.priority-t.priority}));var x=e.size(u);for(f in u){(d=u[f]).priority=d.priority||10,n.append(d.$el);var k=m+"_"+d.priority+"_"+v;1!=v&&d.above&&!d.is_disabled&&(c[k+"_ma"]="----"),d.is_disabled||(c[k+"_ms"]=d.context),m!=x&&d.below&&!d.is_disabled&&(c[k+"_mz"]="----"),v++}return x>0}(c=c||{})[e.uniqueId("ctx_")+"1_1_ms"]={disabled:!0,name:a("No menu available for this object.")}};var s=function e(t,n){this.$element=i(t),this.options=i.extend({},e.DEFAULTS,n),this.isLoading=!1};function r(e,t){return this.each((function(){var n=i(this),a=n.data("pg.menu"),o="object"==l(e)&&e;a||n.data("pg.menu",a=new s(this,o)),a.toggle(t)}))}s.DEFAULTS={},s.prototype.toggle=function(e){if(this.$element.closest(".dropdown-item").hasClass("disabled"))return e.preventDefault(),!1;var i=this.$element.data("pgMenu");if(i.cb){var n=i.module&&i.module.callbacks&&i.module.callbacks[i.cb]||i.module&&i.module[i.cb];n?(n.apply(i.module,[i.data,t.Browser.tree.selected()]),e.preventDefault()):t.Browser.report_error('Developer Warning: Callback - "'+i.cb+'" not found!')}};var d=i.fn.button;return i.fn.pgmenu=r,i.fn.pgmenu.Constructor=s,i.fn.pgmenu.noConflict=function(){return i.fn.pgmenu=d,this},i(document).on("click.pg.menu.data-api",'[data-toggle^="pg-menu"]',(function(e){var t=i(e.target);t.hasClass("dropdown-item")||(t=t.closest(".dropdown-item")),r.call(t,"toggle",e)})).on("focus.pg.menu.data-api blur.pg.menu.data-api",'[data-toggle^="pg-menu"]',(function(e){i(e.target).closest(".menu").toggleClass("focus",/^focus(in)?$/.test(e.type))})).on("mouseenter",".dropdown-submenu",(function(e){i(e.currentTarget).removeClass("dropdown-submenu-visible").addClass("dropdown-submenu-visible"),i(e.currentTarget).find(".dropdown-menu").first().addClass("show")})).on("mouseleave",".dropdown-submenu",(function(e){i(e.currentTarget).removeClass("dropdown-submenu-visible"),i(e.currentTarget).find(".dropdown-menu").first().removeClass("show")})).on("hidden.bs.dropdown",(function(e){i(e.target).find(".dropdown-submenu.dropdown-submenu-visible").removeClass("dropdown-submenu-visible").find(".dropdown-menu.show").removeClass("show")})),t.Browser.MenuItem}.apply(t,n))||(e.exports=a)},66235:(e,t,i)=>{var n,a;i(47042),i(68309),i(91038),i(78783),i(82526),i(41817),i(32165),i(79753),i(69070),i(47941),i(57327),i(38880),i(89554),i(54747),i(49337),i(33321),i(24812),i(41539),i(66992),i(33948),i(82772),i(69826),i(32564),i(26699),i(32023),i(23123),i(74916),i(69600),i(5735),i(83753),i(3843),i(83710);var l,o=i(49929),s=(l=i(55958))&&l.__esModule?l:{default:l};function r(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function d(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function c(e,t){var i;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(i=function(e,t){if(!e)return;if("string"==typeof e)return p(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return p(e,t)}(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,o=!0,s=!1;return{s:function(){i=e[Symbol.iterator]()},n:function(){var e=i.next();return o=e.done,e},e:function(e){s=!0,l=e},f:function(){try{o||null==i.return||i.return()}finally{if(s)throw l}}}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}n=[i(28008),i(91669),i(19755),i(66419),i(55112),i(50521),i(72316),i(55455),i(30794),i(95283),i(61329),i(68363),i(44092),i(7027),i(12030)],a=function(e,t,i,n,a,l,p,u,h,f,m,g,v){var b=window.wcDocker,y=13,C=27,w=112;return h.Node?h.Node:(h.Nodes=h.Nodes||{},h.Node=function(){},h.Node.extend=function(e,t){var i,a=this;if(i=function(){return a.apply(this,arguments)},n.extend(i,a,n.omit(e,"callbacks")),i.callbacks=n.extend({},a.callbacks,e.callbacks),!1===t)return i;var l,o,s=c(n.keys(i.callbacks));try{for(s.s();!(l=s.n()).done;){var r=l.value;"function"==typeof i.callbacks[o=r]&&(i.callbacks[o]=i.callbacks[o].bind(i))}}catch(e){s.e(e)}finally{s.f()}return i.Init.apply(i),this.Init.apply(i),i},n.extend(a.Browser.Node,p.Events,{type:void 0,label:"",sqlAlterHelp:"",sqlCreateHelp:"",dialogHelp:"",epasHelp:!1,title:function(e,t){return e.label+(t?" - "+t.label:"")},hasId:!0,Init:function(){var e=this;if(!e.node_initialized){if(e.node_initialized=!0,a.Browser.add_menus([{name:"refresh",node:e.type,module:e,applies:["object","context"],callback:"refresh",priority:2,label:t("Refresh..."),icon:"fa fa-sync-alt"}]),e.canEdit&&a.Browser.add_menus([{name:"show_obj_properties",node:e.type,module:e,applies:["object","context"],callback:"show_obj_properties",priority:999,label:t("Properties..."),data:{action:"edit"},icon:"fa fa-edit",enable:n.isFunction(e.canEdit)?function(){return!!e.canEdit.apply(e,arguments)}:!!e.canEdit}]),e.canDrop&&(a.Browser.add_menus([{name:"delete_object",node:e.type,module:e,applies:["object","context"],callback:"delete_obj",priority:e.dropPriority,label:e.dropAsRemove?t("Remove %s",e.label):t("Delete/Drop"),data:{url:"drop",data_disabled:t("The selected tree node does not support this option.")},icon:"fa fa-trash-alt",enable:n.isFunction(e.canDrop)?function(){return!!e.canDrop.apply(e,arguments)}:!!e.canDrop}]),e.canDropCascade&&a.Browser.add_menus([{name:"delete_object_cascade",node:e.type,module:e,applies:["object","context"],callback:"delete_obj",priority:3,label:t("Drop Cascade"),data:{url:"delete"},icon:"fa fa-trash-alt",enable:n.isFunction(e.canDropCascade)?function(){return e.canDropCascade.apply(e,arguments)}:!!e.canDropCascade}])),-1==n.indexOf(a.unsupported_nodes,e.type)){var i=function(e){return!("database"!=e._type||!e.allowConn)||"database"!=e._type};a.Browser.add_menus([{name:"show_query_tool",node:e.type,module:e,applies:["context"],callback:"show_query_tool",priority:998,label:t("Query Tool"),icon:"pg-font-icon icon-query_tool",enable:i}]),a.Browser.add_menus([{name:"search_objects",node:e.type,module:a.SearchObjects,applies:["context"],callback:"show_search_objects",priority:997,label:t("Search Objects..."),icon:"fa fa-search",enable:i}]),a.enable_psql&&a.Browser.add_menus([{name:"show_psql_tool",node:this.type,module:this,applies:["context"],callback:"show_psql_tool",priority:998,label:t("PSQL Tool"),icon:"fas fa-terminal"}])}e.hasScriptTypes&&n.isArray(e.hasScriptTypes)&&e.hasScriptTypes.length>0&&n.each(e.hasScriptTypes,(function(i){var n=t("%s Script",i.toUpperCase());i=i.toLowerCase(),a.Browser.add_menus([{name:"show_script_"+i,node:e.type,module:e,applies:["object","context"],callback:"show_script",priority:4,label:n,category:t("Scripts"),data:{script:i,data_disabled:t("The selected tree node does not support this option.")},icon:"fa fa-pencil-alt",enable:e.check_user_permission}])}))}},check_user_permission:function(e,t,i){if("server_group"==e._type||"server"==e._type)return!1;if("database"==e._type&&!e.allowConn)return!1;var a=h.tree.getTreeNodeHierarchy(t);return-1==n.indexOf(["create","insert","update","delete"],i.script)||(!("role"!=e.type||!a.server.user.can_create_role)||!!(a.server&&(a.server.user.is_superuser||a.server.user.can_create_db)||a.schema&&a.schema.can_create))},getView:function(e,a,l,o,r,d,c,p){var m=this;if(!this.type||""==this.type)return null;if(this.model){var g=this.generate_url(e,a,o,!1,null,m.url_jump_after_node);if(!g)return null;var b={};"create"!==a&&(b[this.model.idAttribute||this.model.prototype.idAttribute||"id"]=o._id);var y=h.tree.getTreeNodeHierarchy(e),C=new(this.model.extend({urlRoot:g}))(b,{node_info:y}),w=f.generateViewSchema(y,C,a,this,o);if("create"==a||"edit"==a){(d=d&&c?d.bind(c):function(){console.warn("Broke something!!! Why we don't have the callback or the context???")})(!1,!1),C.on("pgadmin-session:valid",(function(e){n.isUndefined(m.statusBar)||m.statusBar.empty().css("visibility","hidden"),d(!1,e)})),C.on("pgadmin-session:invalid",(function(e){var t='\n            <div class="error-in-footer">\n              <div class="d-flex px-2 py-1">\n                <div class="pr-2">\n                  <i class="fa fa-exclamation-triangle text-danger" aria-hidden="true" role="img"></i>\n                </div>\n                <div role="alert" class="alert-text">'.concat(e,'</div>\n                <div class="ml-auto close-error-bar">\n                  <a class="close-error fa fa-times text-danger"></a>\n                </div>\n              </div>\n            </div>');n.isUndefined(m.statusBar)||(m.statusBar.html(t).css("visibility","visible"),m.statusBar.find("a.close-error").bind("click",function(){this.empty().css("visibility","hidden")}.bind(m.statusBar)));var i=!1;return this.sessChanged&&this.sessChanged()&&(i=!0),d(!0,i),!0}))}if(n.size(w)){var _;_="fieldset"==r?new f.Accordian({el:l,model:C,schema:w}):new f.Dialog({el:l,model:C,schema:w});var x=function(){var e=i(l).find(".tab-content:first > .tab-pane.active:first");v.findAndSetFocus(e)};if(C.isNew())_.render(),x(),C.startNewSession();else{var k='<div role="status" class="pg-panel-message pg-panel-properties-message">'+t("Retrieving data from the server...")+"</div>",E=i(k),N=setTimeout((function(e){n.isUndefined(e)||E.appendTo(e)}),1e3,c);!function i(){C.fetch({success:function(){clearTimeout(N),E.addClass("d-none"),_.render(),x(),C.startNewSession()},error:function(n,a,l){var o=m&&e?h.tree.getTreeNodeHierarchy(e)[m.type].label:"";h.Events.trigger("pgadmin:node:retrieval:error","properties",a,l.textStatus,l.errorThrown,e),u.pgHandleItemError(a,l.textStatus,l.errorThrown,{item:e,info:y})||s.default.pgNotifier(l.textStatus,a,t("Error retrieving properties - %s",l.errorThrown||o),(function(e){"CRYPTKEY_SET"===e?i():console.warn(arguments)})),p&&p()}})}()}}return _}return null},addUtilityPanel:function(e,t,i){var a=window.document.body,l=document.createElement("div"),o=i||h.docker;a.insertBefore(l,a.firstChild);var s=screen.width<700?.95*screen.width:.5*screen.width,r=screen.height<500?.95*screen.height:.4*screen.height;n.isUndefined(e)||n.isNull(e)||(s=e),n.isUndefined(t)||n.isNull(t)||(r=t);var d=(a.offsetWidth-s)/2,c=(a.offsetHeight-r)/4,p=o.addPanel("utility_props",window.wcDocker.DOCK.FLOAT,void 0,{w:s,h:r,x:d,y:c});return setTimeout((function(){p.moveable(!1)}),0),a.removeChild(l),p},onEventResizeEnded:function(){var e=this.$container.find(".obj_properties").first(),t=e.data("obj-view");t&&t.model&&t.model&&t.model.trigger("pg-browser-resized",{view:t,panel:this,container:e})},registerDockerPanel:function(e,t,i){var n=e||h.docker,a=n.findPanels(t);a&&1==a.length||(a=new h.Panel(function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?r(Object(i),!0).forEach((function(t){d(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):r(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({name:t,showTitle:!0,isCloseable:!0,isPrivate:!0,isLayoutMember:!1,canMaximise:!0,content:'<div class="obj_properties container-fluid h-100"></div>'},i)),a.load(n))},registerUtilityPanel:function(e){var i=e||h.docker,n=i.findPanels("utility_props");if(!n||1!=n.length){var a={};a[b.EVENT.RESIZE_ENDED]=this.onEventResizeEnded,(n=new h.Panel({name:"utility_props",showTitle:!0,isCloseable:!0,isPrivate:!0,isLayoutMember:!1,canMaximise:!0,elContainer:!0,content:'<div class="obj_properties container-fluid h-100"><div role="status" class="pg-panel-message">'+t("Please wait while we fetch information ...")+"</div></div>",onCreate:function(e,t){t.addClass("pg-no-overflow")},events:a})).load(i)}},register_node_panel:function(){var e=h.docker.findPanels("node_props");if(!e||1!=e.length){var i={};i[b.EVENT.RESIZE_ENDED]=this.onEventResizeEnded,(e=new h.Panel({name:"node_props",showTitle:!0,isCloseable:!0,isPrivate:!0,isLayoutMember:!1,canMaximise:!0,elContainer:!0,content:'<div class="obj_properties container-fluid h-100"><div role="status" class="pg-panel-message">'+t("Please wait while we fetch information about the node from the server...")+"</div></div>",onCreate:function(e,t){t.addClass("pg-no-overflow")},events:i})).load(h.docker)}},hasScriptTypes:["create"],canEdit:!0,canDrop:!1,canDropCascade:!1,dropAsRemove:!1,dropPriority:2,selectParentNodeOnDelete:!1,callbacks:{show_obj_properties:function(e,i){var l=h.tree,o=e&&e.item||i||l.selected(),r=o?l.itemData(o):void 0,d=this,c=d.title.apply(this,[r]);if(h.Node.register_node_panel(),r){var p=this,u=n.isArray(this.parent_type)?function(e){return-1!=n.indexOf(p.parent_type,e._type)}:function(e){return p.parent_type==e._type},f=function(){var e,t,i,n,l=window.document.body,o=document.createElement("div");l.insertBefore(o,l.firstChild),e=screen.width<800?a.toPx(o,"95%","width",!0):(e=a.toPx(o,p.width||h.stdW.default+"px","width",!0))<=h.stdW.sm?h.stdW.sm:e<=h.stdW.md?h.stdW.md:h.stdW.lg,t=screen.height<600?a.toPx(o,"95%","height",!0):(t=a.toPx(o,p.height||h.stdH.default+"px","height",!0))<=h.stdH.sm?h.stdH.sm:t<=h.stdH.md?h.stdH.md:h.stdH.lg,i=(l.offsetWidth-e)/2,n=(l.offsetHeight-t)/4,e>window.innerWidth&&(i=0,e=window.innerWidth),t>window.innerHeight&&(n=0,t=window.innerHeight);var s=h.docker.addPanel("node_props",b.DOCK.FLOAT,void 0,{w:e+"px",h:t+"px",x:i+"px",y:n+"px"});return l.removeChild(o),s};if("create"==e.action){if(p.parent_type&&!u(r))for(;o&&l.hasParent(o);){o=l.parent(o);var m=l.itemData(o);if(u(m)){r=m;break}}if(!r||null!=this.parent_type&&!u(r))return;c=t("Create - %s",this.label),"server"==this.type&&(c=t("Register - %s",this.label)),g=f(),setTimeout((function(){d.showProperties(o,r,g,e.action)}),10)}else if(h.Node.panels&&h.Node.panels[r.id]&&h.Node.panels[r.id].$container){var g=h.Node.panels[r.id];if(g.$container.attr("action-mode")){var y=t('Are you sure want to stop editing the properties of %s "%s"?');"edit"==e.action&&(y=t('Are you sure want to reset the current changes and re-open the panel for %s "%s"?')),s.default.confirm(t("Edit in progress?"),v.sprintf(y,d.label.toLowerCase(),r.label),(function(){setTimeout((function(){d.showProperties(o,r,g,e.action)}),10)}),null).show()}else setTimeout((function(){d.showProperties(o,r,g,e.action)}),10)}else h.Node.panels=h.Node.panels||{},g=h.Node.panels[r.id]=f(),setTimeout((function(){d.showProperties(o,r,g,e.action)}),10);g.title(c),g.icon("icon-"+this.type),g.focus()}},delete_obj:function(e,a){var l=e||{url:"drop"},o=this,r=h.tree,d=l.item||a||r.selected(),c=d?r.itemData(d):void 0;if(c){o=h.Nodes[c._type];var p,u,f=n.unescape(c.label);if("delete"==l.url){if(p=t('Are you sure you want to drop %s "%s" and all the objects that depend on it?',o.label.toLowerCase(),c.label),u=t("DROP CASCADE %s?",o.label),!(n.isFunction(o.canDropCascade)?o.canDropCascade.apply(o,[c,d]):o.canDropCascade))return void s.default.error(t('The %s "%s" cannot be dropped.',o.label,c.label),1e4)}else if(o.dropAsRemove?(p=t('Are you sure you want to remove %s "%s"?',o.label.toLowerCase(),c.label),u=t("Remove %s?",o.label)):(p=t('Are you sure you want to drop %s "%s"?',o.label.toLowerCase(),c.label),u=t("Drop %s?",o.label)),!(n.isFunction(o.canDrop)?o.canDrop.apply(o,[c,d]):o.canDrop))return void s.default.error(t('The %s "%s" cannot be dropped/removed.',o.label,c.label),1e4);s.default.confirm(u,p,(function(){i.ajax({url:o.generate_url(d,l.url,c,!0),type:"DELETE"}).done((function(e){if(2!=e.success){if(0==e.success)h.report_error(e.errormsg,e.info);else{var t=!0;if(o.selectParentNodeOnDelete){var i=r.parent(d);setTimeout((function(){r.select(i)}),10),t=!1}h.removeTreeNode(d,t)}return!0}s.default.error(e.info,null)})).fail((function(e){var i=e.responseText;if(417==e.status||410==e.status||500==e.status)try{var n=JSON.parse(e.responseText);i=n.info||n.errormsg}catch(e){console.warn(e.stack||e)}h.report_error(t('Error dropping/removing %s: "%s"',o.label,f),i)}))}))}},show_script:function(e,t){var i,n,l=e.script,o=h.tree,s=t||o.selected(),r=s?o.itemData(s):void 0;r&&(i=h.Nodes[r._type],n="insert"==l?"insert_sql":"update"==l?"update_sql":"delete"==l?"delete_sql":"select"==l?"select_sql":"exec"==l?"exec_sql":"sql",a.Tools.SQLEditor.showQueryTool(i.generate_url(s,n,r,!0),s,l))},show_query_tool:function(e,i){var n=h.get_preference("sqleditor","copy_sql_to_query_tool"),l=h.tree,o=i||l.selected(),s=o?l.itemData(o):void 0;if(s)if(n.value&&!s._type.includes("coll-")){var r={script:s._type.toLowerCase(),data_disabled:t("The selected tree node does not support this option.")};h.Node.callbacks.show_script(r)}else a.Tools.SQLEditor.showQueryTool("",o)},show_psql_tool:function(e){var t=e||{},i=h.tree,n=t.item||i.selected(),a=n?i.itemData(n):void 0;h.psql.psql_tool(a,n,!0)},change_server_background:function(e,t){if(e&&t){var n=h.tree.getTreeNodeHierarchy(e).server;if(n)if(-1!==e.path.indexOf(n.id)){var a=n.icon.split(" ")[1]||null,l=n.icon.split(" ")[2]||"";if(a){var o,s="pga_server_"+n._id+"_bgcolor";o="<style id="+s+" type='text/css'> \n",o+="."+s+" .file-label {",o+=" border-radius: 3px; margin-bottom: 2px;",o+=" background: "+a+" !important;} \n",l&&(o+="."+s+" span.file-name {",o+=" color: "+l+" !important;} \n"),o+="</style>",i("#"+s).remove(),i(o).appendTo("head"),h.tree.addCssClass(e,s)}}}},added:function(e,t){h.Events.trigger("pgadmin:browser:tree:expand-from-previous-tree-state",e),h.Node.callbacks.change_server_background(e,t)},selected:function(e,t,i){var n=i||h,l=n.tree,o=t||l.itemData(e);return a.Browser.enable_disable_menus.apply(n,[e]),o&&n&&"properties"in n.panels&&n.panels.properties&&n.panels.properties.panel&&n.panels.properties.panel.isVisible()&&this.showProperties(e,o,n.panels.properties.panel),h.Events.trigger("pgadmin:browser:tree:update-tree-state",e),!0},removed:function(e){var t=this;setTimeout((function(){t.clear_cache.apply(t,e)}),0)},refresh:function(e,t){var n=this,a=h.tree,l=t&&a.itemData(t);i(h.panels.properties.panel).removeData("node-prop"),h.Events.trigger("pgadmin:browser:tree:refresh",t||h.tree.selected(),{success:function(){n.callbacks.selected.apply(n,[t,l,h])}})},opened:function(e){var t=h.tree,i=h.get_preference("browser","auto_expand_sole_children");if(i&&1==i.value&&1==t.children(e).length){var n=t.first(e);if(1==n._loaded)t.open(n);else var a=setInterval((function(){n._loaded&&(t.open(n),l())}),200),l=function(){clearInterval(a)}}h.Events.trigger("pgadmin:browser:tree:update-tree-state",e)},closed:function(e){h.Events.trigger("pgadmin:browser:tree:remove-from-tree-state",e)}},showProperties:function(e,l,r,d){var c=this,p=a.Browser.tree,u=r.$container.find(".obj_properties").first(),f=u.data("obj-view"),m=i("<div></div>").addClass("pg-prop-content col-12"),v=!0,_=function(e,t){if(!r||"node_props"===r._type)switch(e.which){case C:A(!0);break;case y:if(e.target!==t)return;if(f&&f.model&&f.model.sessChanged()){var n=i(e.target).closest(".obj_properties").find(".pg-prop-btn-group").find("button.btn-primary");M.call(this,f,n)}break;case w:T()}}.bind(r);setTimeout((function(){r.$container.find(".backform-tab").on("keydown",(function(e){_(e,this)}))}),200);var x=function(e){var t=i('<div role="status"></div>').addClass("pg-prop-status-bar").appendTo(u);return t.css("visibility","hidden"),"header"==e?t.appendTo(c.header):t.prependTo(c.footer),c.statusBar=t,t}.bind(r),k=function(e,t,a){if(e&&n.isArray(e)&&e.length>0){var l=i('<div class="pg-prop-btn-group"></div>'),o=n.template(['<button tabindex="0" type="<%= type %>" ',"class=\"btn <%=extraClasses.join(' ')%>\"",'<% if (disabled) { %> disabled="disabled"<% } %> title="<%-tooltip%>"','<% if (label != "") {} else { %> aria-label="<%-tooltip%>"<% } %> >','<span class="<%= icon %>"></span><% if (label != "") { %>&nbsp;<%-label%><% } %></button>'].join(" "));return"header"==t?l.appendTo(c.header):l.appendTo(c.footer),a&&l.addClass(a),n.each(e,(function(e){e.icon||(e.icon="");var t=i(o(e));l.append(t),e.register(t)})),l}return null}.bind(r),E=function(){var a=p.selected(),s=a&&p.itemData(a),r=p.getTreeNodeHierarchy(a);if(i(this).data("node-prop",r),(0,o.removeNodeView)(u[0]),c.getSchema){var d=h.tree.getTreeNodeHierarchy(e);(0,o.getNodeView)(c.type,d,"properties",l,"tab",u[0],this,B)}else{if(m.hasClass("has-pg-prop-btn-group")||m.addClass("has-pg-prop-btn-group"),f&&(f.remove({data:!0,internal:!0,silent:!0}),f=null,u.data("obj-view",null)),u.empty(),c.header=i("<div></div>").addClass("pg-prop-header").appendTo(u),c.footer=i("<div></div>").addClass("pg-prop-footer").appendTo(u),f=c.getView(e,"properties",m,l,"fieldset",void 0,u)){u.data("obj-view",f);var g=[];g.push({label:t("Edit"),type:"edit",tooltip:t("Edit"),extraClasses:["btn","btn-primary","pull-right","m-1"],icon:"fa fa-sm fa-pencil-alt",disabled:n.isFunction(c.canEdit)?!c.canEdit.apply(c,[s,a]):!c.canEdit,register:function(e){e.on("click",(function(){B()}))}}),g.push({label:"",type:"help",tooltip:t("SQL help for this object type."),extraClasses:["btn-primary-icon","btn-primary-icon","m-1"],icon:"fa fa-info",disabled:""==c.sqlAlterHelp&&""==c.sqlCreateHelp&&!c.epasHelp,register:function(e){e.on("click",(function(){N()}))}}),k(g,"header","pg-prop-btn-group-above")}u.append(m)}}.bind(r),N=function(){var t=h.tree.getTreeNodeHierarchy(e).server,i=h.utils.pg_help_path,n="";n="ppas"==t.server_type&&c.epasHelp?g.getEPASHelpUrl(t.version):""==c.sqlCreateHelp&&""!=c.sqlAlterHelp?g.getHelpUrl(i,c.sqlAlterHelp,t.version):""!=c.sqlCreateHelp&&""==c.sqlAlterHelp||f.model.isNew()?g.getHelpUrl(i,c.sqlCreateHelp,t.version):g.getHelpUrl(i,c.sqlAlterHelp,t.version),window.open(n,"postgres_help")}.bind(r),T=function(){window.open(c.dialogHelp,"pgadmin_help")}.bind(r),S=function(e,i){var n=this.$container.find(".obj_properties").first(),a=n&&n.data("obj-view"),l=this;return h.get_preferences_for_module("browser").confirm_on_properties_close&&v&&a&&a.model?!a.model.sessChanged()||void s.default.confirm(t("Warning"),e,(function(){return setTimeout(function(){i()}.bind(l),50),!0}),(function(){return!0})):(i(),!0)}.bind(r),I=function(e){var i,a=this.$container.find(".obj_properties").first(),l=a&&a.data("obj-view"),o=this;return!l||!l.model||n.isUndefined(l.model.warn_text)||n.isNull(l.model.warn_text)?(e(),!0):(i=t(l.model.warn_text),!l.model.sessChanged()||void s.default.confirm(t("Warning"),i,(function(){return setTimeout(function(){e()}.bind(o),50),!0}),(function(){return!0})))}.bind(r),$=function(e){var i=this.$container.find(".obj_properties").first(),a=i&&i.data("obj-view");return a&&a.model&&!n.isUndefined(a.model.inform_text)&&!n.isNull(a.model.inform_text)&&s.default.alert(t("Warning"),t(a.model.inform_text)),e(),!0}.bind(r),M=function(e,a){var l=e.model,o=l.toJSON(!0),r=setTimeout((function(){i(".obj_properties").addClass("show_progress")}),1e3);a&&i(a).prop("disabled",!0),o&&!n.isEmpty(o)&&l.save({},{attrs:o,validate:!1,cache:!1,wait:!0,success:function(){j.call(),i(".obj_properties").removeClass("show_progress"),clearTimeout(r);var e=h.docker.findPanels("properties")[0],t=h.docker.findPanels("sql")[0],n=h.docker.findPanels("statistics")[0],a=h.docker.findPanels("dependencies")[0],l=h.docker.findPanels("dependents")[0];e&&i(e).removeData("node-prop"),t&&i(t).removeData("node-prop"),n&&i(n).removeData("node-prop"),a&&i(a).removeData("node-prop"),l&&i(l).removeData("node-prop")},error:function(e,n){s.default.pgNotifier("error",n,t("Error saving properties")),i(".obj_properties").removeClass("show_progress"),clearTimeout(r),a&&i(a).prop("disabled",!1)}})}.bind(r),D=function(){var a=this;if(d&&"properties"==d&&(d="edit"),a.$container.attr("action-mode",d),a.icon(n.isFunction(c.node_image)?c.node_image.apply(c,[l]):c.node_image||"icon-"+c.type),(0,o.removeNodeView)(u[0]),c.getSchema){var r=h.tree.getTreeNodeHierarchy(e);(0,o.getNodeView)(c.type,r,d,l,"dialog",u[0],this,B,(function(e){if(e.node){j(e.node,r);var n=h.docker.findPanels("properties")[0],a=h.docker.findPanels("sql")[0],l=h.docker.findPanels("statistics")[0],o=h.docker.findPanels("dependencies")[0],d=h.docker.findPanels("dependents")[0];n&&i(n).removeData("node-prop"),a&&i(a).removeData("node-prop"),l&&i(l).removeData("node-prop"),o&&i(o).removeData("node-prop"),d&&i(d).removeData("node-prop"),0===e.success&&s.default.alert(t("Error"),t(e.errormsg))}}))}else{f&&(f.remove({data:!0,internal:!0,silent:!0}),f=null,u.data("obj-view",null)),u.empty(),c.header=i("<div></div>").addClass("pg-prop-header").appendTo(u),c.footer=i("<div></div>").addClass("pg-prop-footer").appendTo(u);if(f=c.getView(e,d,m,l,"dialog",(function(e,t){var i=this.find(".pg-prop-btn-group"),n=i.find("button.btn-primary"),a=i.find('button.btn-secondary[type="reset"]');e||!t?(n.prop("disabled",!0),n.attr("disabled","disabled")):(n.prop("disabled",!1),n.removeAttr("disabled")),t?(a.prop("disabled",!1),a.removeAttr("disabled")):(a.prop("disabled",!0),a.attr("disabled","disabled"))}),u,P))u.data("obj-view",f),a.icon(n.isFunction(c.node_image)?c.node_image.apply(c,[l,f.model]):c.node_image||"icon-"+c.type),k([{label:"",type:"help",tooltip:t("SQL help for this object type."),extraClasses:["btn-primary-icon","pull-left","mx-1"],icon:"fa fa-info",disabled:""==c.sqlAlterHelp&&""==c.sqlCreateHelp&&!c.epasHelp,register:function(e){e.on("click",(function(){N()}))}},{label:"",type:"help",tooltip:t("Help for this dialog."),extraClasses:["btn-primary-icon","pull-left","mx-1"],icon:"fa fa-question",disabled:""==c.dialogHelp,register:function(e){e.on("click",(function(){T()}))}},{label:t("Cancel"),type:"cancel",tooltip:t("Cancel changes to this object."),extraClasses:["btn-secondary","mx-1"],icon:"fa fa-times pg-alertify-button",disabled:!1,register:function(e){e.on("click",(function(){a.$container.removeAttr("action-mode"),P.call(!0)}))}},{label:t("Reset"),type:"reset",tooltip:t("Reset the fields on this dialog."),extraClasses:["btn-secondary","mx-1"],icon:"fa fa-recycle pg-alertify-button",disabled:!0,register:function(e){e.on("click",(function(){S.call(a,t("Changes will be lost. Are you sure you want to reset?"),(function(){setTimeout((function(){D.call()}),0)}))}))}},{label:t("Save"),type:"save",tooltip:t("Save this object."),extraClasses:["btn-primary","mx-1"],icon:"fa fa-save pg-alertify-button",disabled:!0,register:function(e){e.on("click",(function(){I.call(a,(function(){$.call(a,(function(){setTimeout((function(){M.call(this,f,e)}),0)}))}))}))}}],"footer","pg-prop-btn-group-below").on("keydown","button",(function(e){if(!e.shiftKey&&9==e.keyCode&&0==i(this).nextAll("button:not([disabled])").length)return f.$el.closest(".wcFloating").find('[tabindex]:not([tabindex="-1"]').first().focus(),!1;var t=i(a.$container.find(".pg-prop-btn-group")),n=i(t).find("button:first");a.$container.find(".number-cell.editable:last").is(":visible")&&9===e.keyCode&&e.shiftKey&&i(n).is(i(e.target))&&(i(a.$container.find("td.editable:last").trigger("click")),e.preventDefault(),e.stopPropagation())})),setTimeout((function(){h.keyboardNavigation.getDialogTabNavigator(a.pgElContainer)}),200);x("footer"),m.addClass("pg-prop-has-btn-group-below"),u.prepend(m),i(".select2-search__field").attr("aria-label","select2"),f.$el.closest(".wcFloating").find('.wcFrameButtonBar > .wcFrameButton[style!="display: none;"]').on("keydown",(function(e){e.shiftKey&&9===e.keyCode&&(e.stopPropagation(),setTimeout((function(){f.$el.closest(".wcFloating").find('[tabindex]:not([tabindex="-1"]):not([disabled])').last().focus()}),10))}))}}.bind(r),A=function(e){n.isUndefined(e)||(v=e),this.close()}.bind(r),O=function(t,i,a){var l=this.$container.find(".obj_properties").first().data("obj-view");setTimeout((function(){t.clear_cache.apply(t,e)}),0);try{h.Events.trigger("pgadmin:browser:tree:add",n.clone(i||l.model.tnode),n.clone(a||l.model.node_info))}catch(e){console.warn(e.stack||e)}A(!1)}.bind(r,c),P=A,j=function(t,i,a){var o=l,s=i||n.clone(f.model.tnode),r=a||n.clone(f.model.node_info);setTimeout((function(){t.clear_cache.apply(t,e)}),0),h.Events.trigger("pgadmin:browser:tree:update",o,s,r,{success:function(e,t,i){h.Events.trigger("pgadmin:browser:node:updated",e,t,i),h.Events.trigger("pgadmin:browser:node:"+t._type+":updated",e,t,i)}}),A(!1)}.bind(r,c),B=D.bind(r);if(d?("create"==d&&(j=O),"properties"!=d?D():E()):(B=function(){setTimeout((function(){c.callbacks.show_obj_properties.apply(c,[{action:"edit",item:e}])}),0)}.bind(r),E()),r.closeable()&&!c.getSchema){r.on(b.EVENT.CLOSING,S.bind(r,t("Changes will be lost. Are you sure you want to close the dialog?"),(function(){r.off(b.EVENT.CLOSING),r.close()})));var q=function(){var e=this.$container.find(".obj_properties").first(),t=e&&e.data("obj-view");t&&t.remove({data:!0,internal:!0,silent:!0})}.bind(r);r.on(b.EVENT.CLOSED,q)}},_find_parent_node:function(e,t,i){if(this.parent_type)if(i=i||e.itemData(t),n.isString(this.parent_type)){if(this.parent_type==i._type)return t;for(;e.hasParent(t);)if(t=e.parent(t),i=e.itemData(t),this.parent_type==i._type)return t}else{if(n.indexOf(this.parent_type,i._type)>=0)return t;for(;e.hasParent(t);)if(t=e.parent(t),i=e.itemData(t),n.indexOf(this.parent_type,i._type)>=0)return t}return null},generate_url:function(e,t,i,a,l,o){var s={create:"obj",drop:"obj",edit:"obj",properties:"obj",statistics:"stats"},r=this,d=-1/0,c=n.isUndefined(e)||n.isNull(e)?l||{}:h.tree.getTreeNodeHierarchy(e),p=t in s?s[t]:t,u=a&&i._type==r.type?encodeURIComponent(i._id):"";if(r.parent_type)if(n.isString(r.parent_type)){var f=c[r.parent_type];f&&(d=f.priority)}else n.each(r.parent_type,(function(e){var t=c[e];t&&d<t.priority&&(d=t.priority)}));var g=d;o&&c[o]&&(g=c[o].priority);return m.generate_url(h.URL,c,p,r.type,(function(e){return e.priority<=g||e.priority==d}),u)},Collection:h.DataCollection,Model:h.DataModel,cache:function(e,t,i,a){var l=this.cached=this.cached||{},o=e,s=t&&t[i]&&t[i].priority||0;if(t&&n.each(n.sortBy(n.values(n.pick(t,(function(e){return e.priority<=s}))),(function(e){return e.priority})),(function(e){o=v.sprintf("%s_%s",o,encodeURI(e._id))})),n.isUndefined(a)){var r=l[o];return!n.isUndefined(r)&&r.at-Date.now()>3e5&&(r=void 0),r}return r=l[o]={data:a,at:Date.now(),level:i}},clear_cache:function(e){this.cached={};h.Events.trigger("pgadmin:browser:node:"+this.type+":cache_cleared",e,this)},cache_level:function(e,t){if(e){if(t&&this.type in e)return this.type;if(n.isArray(this.parent_type)){for(var i in this.parent_type)if(i in e)return i;return this.type}return this.parent_type}}}),a.Browser.Node)}.apply(t,n),void 0===a||(e.exports=a)},75270:(e,t,i)=>{var n,a;i(69600),i(69826),i(24812),n=[i(91669),i(19755),i(66419),i(55112),i(72316),i(95283),i(58307),i(83879),i(20454),i(66235)],void 0===(a=function(e,t,i,n,a,l,o,s){t.fn.select2.amd.define("select2/selectAllAdapter",["select2/utils","select2/dropdown","select2/dropdown/attachBody"],(function(i,n,a){function l(){}return l.prototype.render=function(n){var a=this,l=n.call(this),o=t(['<button class="btn btn-secondary btn-sm" type="button"',' style="width: 49%;margin: 0 0.5%;">','<i class="fa fa-check-square" role="img"></i>','<span style="padding: 0px 5px;">',e("Select All"),"</span></button>"].join("")),s=t(['<button class="btn btn-secondary btn-sm" type="button"',' style="width: 49%;margin: 0 0.5%;">','<i class="fa fa-square"></i><span style="padding: 0px 5px;" role="img">',e("Unselect All"),"</span></button>"].join("")),r=t('<div class="select2-select-all-adapter-container">').append(o).append(s);return this.$element.prop("multiple")?(l.find(".select2-dropdown").prepend(r),o.on("click",(function(){l.find(".select2-results__option[aria-selected=false]").each((function(){var e=i.GetData(t(this)[0],"data");a.trigger("select",{data:e})})),a.trigger("close")})),s.on("click",(function(){l.find(".select2-results__option[aria-selected=true]").each((function(){var e=i.GetData(t(this)[0],"data");a.trigger("unselect",{data:e})})),a.trigger("close")})),l):l},i.Decorate(i.Decorate(n,a),l)}));var r=l.NodeAjaxOptionsControl=l.Select2Control.extend({defaults:i.extend(l.Select2Control.prototype.defaults,{url:void 0,transform:void 0,url_with_id:!1,select2:{allowClear:!0,placeholder:e("Select an item..."),width:"style"}}),initialize:function(){l.Select2Control.prototype.initialize.apply(this,arguments);var e=this,a=e.field.get("url")||e.defaults.url,o=e.model.top||e.model,s=e.field.get("url_jump_after_node")||null;if(a){var r,d=this.field.get("schema_node"),c=this.field.get("node_info"),p=this.field.get("url_with_id")||!1,u=d.generate_url.apply(d,[null,a,this.field.get("node_data"),p,c,s]),h=this.field.get("cache_node");h=h&&n.Browser.Nodes[h]||d,r=this.field.has("cache_level")?this.field.get("cache_level"):h.cache_level(c,p);var f=h.cache(d.type+"#"+a,c,r);this.field.get("version_compatible")&&(i.isUndefined(f)||i.isNull(f))&&(o.trigger("pgadmin:view:fetching",o,e.field),t.ajax({async:!1,url:u}).done((function(e){f=h.cache(d.type+"#"+a,c,r,e.data)})).fail((function(){o.trigger("pgadmin:view:fetch:error",o,e.field)})),o.trigger("pgadmin:view:fetched",o,e.field)),f=f&&f.data||[];var m=this.field.get("transform")||e.defaults.transform;m&&i.isFunction(m)?e.field.set("options",m.bind(e,f)):e.field.set("options",f)}}}),d=function(e){if(!e.id)return e.text;var i=t(e.element).data("image");return i?t("<span></span>").append(t("<span></span>",{class:"wcTabIcon "+i})).append(t("<span></span>").text(e.text)):e.text},c=function(e,t,n,a){var l=[];return i.each(n,(function(n){if(t(n)){var o=i.isFunction(a.node_label)?a.node_label.apply(a,[n,e.model,e]):n.label,s=i.isFunction(a.node_image)?a.node_image.apply(a,[n,e.model,e]):a.node_image||"icon-"+a.type;l.push({value:n._id,image:s,label:o})}})),l},p=l.NodeListByIdControl=r.extend({controlClassName:"pgadmin-node-select form-control",defaults:i.extend({},r.prototype.defaults,{url:"nodes",filter:void 0,transform:function(e){var t=this,i=t.field.get("schema_node"),n=t.field.get("filter")||function(){return!0};return n=n.bind(t),c(t,n,e,i)},select2:{allowClear:!0,placeholder:e("Select an item..."),width:"style",templateResult:d,templateSelection:d}})});l.NodeListByNameControl=p.extend({defaults:i.extend({},p.prototype.defaults,{transform:function(e){var t=this,n=t.field.get("schema_node"),a=[],l=t.field.get("filter")||function(){return!0};return l=l.bind(t),i.each(e,(function(e){if(l(e)){var o=i.isFunction(n.node_label)?n.node_label.apply(n,[e,t.model,t]):e.label,s=i.isFunction(n.node_image)?n.node_image.apply(n,[e,t.model,t]):n.node_image||"icon-"+n.type;a.push({value:e.label,image:s,label:o})}})),a}})}),t.fn.pgMakeVisible=function(e){return this.each((function(){if(this&&t(this.length))for(var i,n,a=t(this);a&&a.length>0;)if(i=a.get(0).offsetTop+a.height(),a=a.parent(),(n=a)&&n.length>0&&n.get(0).scrollHeight>n.height()&&a.scrollTop(i),a.hasClass(e))return}))},t.fn.pgMakeBackgridVisible=function(e){return this.each((function(){if(this&&t(this.length)){var i=t(this),n=t(this).offsetParent().parent(),a=n.offset().top,l=n.height(),o=t(this).closest(e);if(0==o.length)return!1;if(l>o[0].offsetHeight-a){var s=i.get(0).offsetTop+i.height();o.find(".tab-content").scrollTop(s)}return!0}}))};var u=s.Extension.NodeAjaxOptionsCell=s.Extension.Select2Cell.extend({defaults:i.extend({},s.Extension.Select2Cell.prototype.defaults,{url:void 0,transform:void 0,url_with_id:!1,select2:{allowClear:!0,placeholder:e("Select an item..."),width:"style"},opt:{label:null,value:null,image:null,selected:!1}}),template:i.template('<option <% if (image) { %> data-image=<%= image %> <% } %> value="<%- value %>" <%= selected ? \'selected="selected"\' : "" %>><%- label %></option>'),initialize:function(){s.Extension.Select2Cell.prototype.initialize.apply(this,arguments);var e=this.column.get("url")||this.defaults.url,a=i.has(this.column.attributes,"options_cached"),l=a&&this.column.get("options_cached");if(e&&!l){var o,r=this,d=this.model,c=this.column,p=d.top||d,u=c.get("schema_node"),h=c.get("node_info"),f=c.get("url_with_id")||!1,m=this.column.get("url_jump_after_node")||null,g=u.generate_url.apply(u,[null,e,c.get("node_data"),f,h,m]),v=c.get("cache_node");v=v&&n.Browser.Nodes[v]||u,o=c.has("cache_level")?c.get("cache_level"):v.cache_level(h,f);var b=v.cache(u.type+"#"+e,h,o);c.get("version_compatible")&&(i.isUndefined(b)||i.isNull(b))&&(p.trigger("pgadmin:view:fetching",d,c),t.ajax({async:!1,url:g}).done((function(t){b=v.cache(u.type+"#"+e,h,o,t.data)})).fail((function(){p.trigger("pgadmin:view:fetch:error",d,c)})),p.trigger("pgadmin:view:fetched",d,c)),b=b&&b.data||[];var y=c.get("transform")||r.defaults.transform;y&&i.isFunction(y)?c.set("options",y.bind(c,b)):c.set("options",b),a&&c.set("options_cached",!0)}}}),h=function(e,t){var i=t||this,n=i.column.get("schema_node"),a=i.column.get("filter")||function(){return!0};return a=a.bind(i),c(i,a,e,n)};return s.Extension.NodeListByIdCell=u.extend({controlClassName:"pgadmin-node-select backgrid-cell",defaults:i.extend({},u.prototype.defaults,{url:"nodes",filter:void 0,transform:h,select2:{placeholder:e("Select an item..."),width:"style",templateResult:d,templateSelection:d}})}),s.Extension.NodeListByNameCell=u.extend({controlClassName:"pgadmin-node-select backgrid-cell",defaults:i.extend({},u.prototype.defaults,{url:"nodes",filter:void 0,transform:h,select2:{placeholder:e("Select an item..."),width:"style",templateResult:d,templateSelection:d}})}),s.Extension.MultiSelectAjaxCell=s.Extension.NodeAjaxOptionsCell.extend({defaults:i.extend({},u.prototype.defaults,{transform:void 0,url_with_id:!1,select2:{allowClear:!0,placeholder:e("Select an item..."),width:"style",multiple:!0},opt:{label:null,value:null,image:null,selected:!1}}),getValueFromDOM:function(){var e=[];return this.$el.find("select").find(":selected").each((function(){e.push(t(this).attr("value"))})),e}}),l.MultiSelectAjaxControl=r.extend({defaults:i.extend({},r.prototype.defaults,{select2:{multiple:!0,allowClear:!0,width:"style"}})}),l}.apply(t,n))||(e.exports=a)},75035:(e,t,i)=>{var n,a;i(68309),i(24812),i(89554),i(32564),i(69826),i(26699);var l=i(44434);n=[i(66419),i(55112),i(19755),i(35816)],void 0===(a=function(e,t,i){var n=t.Browser=t.Browser||{},a=window.wcDocker;return t.Browser.Panel=function(t){e.extend(this,e.pick(t,["name","title","width","height","showTitle","isCloseable","isPrivate","isLayoutMember","content","icon","events","onCreate","elContainer","canHide","limit","extraClasses","canMaximise"]))},e.extend(t.Browser.Panel.prototype,{name:"",title:"",width:300,height:600,showTitle:!0,isCloseable:!0,isPrivate:!1,isLayoutMember:!0,content:"",icon:"",panel:null,onCreate:null,elContainer:!1,canMaximise:!1,limit:null,extraClasses:null,load:function(t,o){var s=this;s.panel||t.registerPanelType(s.name,{title:s.title,isPrivate:s.isPrivate,limit:s.limit,isLayoutMember:s.isLayoutMember,onCreate:function(t){if(i(t).data("pgAdminName",s.name),t.initSize(s.width,s.height),s.showTitle){var r='<a href="#" tabindex="-1" class="panel-link-heading">'+(o||s.title)+"</a>";t.title(r),""!=s.icon&&t.icon(s.icon)}else t.title(!1);var d=i("<div>",{class:"pg-panel-content"}).append(i(s.content));e.isNull("extraClasses")||d.addClass(s.extraClasses),t.maximisable(!!s.canMaximise),t.closeable(!!s.isCloseable),t.layout().addItem(d),s.panel=t,s.events&&e.isObject(s.events)&&e.each(s.events,(function(i,n){i&&e.isFunction(i)&&t.on(n,i)})),e.each([a.EVENT.UPDATED,a.EVENT.VISIBILITY_CHANGED,a.EVENT.BEGIN_DOCK,a.EVENT.END_DOCK,a.EVENT.GAIN_FOCUS,a.EVENT.LOST_FOCUS,a.EVENT.CLOSED,a.EVENT.BUTTON,a.EVENT.ATTACHED,a.EVENT.DETACHED,a.EVENT.MOVE_STARTED,a.EVENT.MOVE_ENDED,a.EVENT.MOVED,a.EVENT.RESIZE_STARTED,a.EVENT.RESIZE_ENDED,a.EVENT.RESIZED,a.EVENT.SCROLLED],(function(e){t.on(e,s.eventFunc.bind(t,e))})),s.onCreate&&e.isFunction(s.onCreate)&&s.onCreate.apply(s,[t,d]),["dragover","drop"].forEach((function(e){d[0].addEventListener(e,(function(e){e.stopPropagation(),e.preventDefault()}))})),s.elContainer&&(t.pgElContainer=d,d.addClass("pg-el-container"),e.each([a.EVENT.RESIZED,a.EVENT.ATTACHED,a.EVENT.DETACHED,a.EVENT.VISIBILITY_CHANGED],(function(e){t.on(e,s.resizedContainer.bind(t))})),s.resizedContainer.apply(t)),"dashboard"!=t._type&&"processes"!=t._type||(0,l.getPanelView)(n.tree,d[0],n,t._type),n.onPreferencesChange("dashboards",(function(){(0,l.getPanelView)(n.tree,d[0],n,t._type)})),n.onPreferencesChange("graphs",(function(){(0,l.getPanelView)(n.tree,d[0],n,t._type)})),e.each([a.EVENT.CLOSED,a.EVENT.VISIBILITY_CHANGED],(function(e){t.on(e,s.handleVisibility.bind(t,e))})),n.Events.on("pgadmin-browser:tree:selected",(function(){t.isVisible()&&"properties"!==t._type&&(0,l.getPanelView)(n.tree,d[0],n,t._type)})),n.Events.on("pgadmin:database:connected",(function(){t.isVisible()&&"properties"!==t._type&&(0,l.getPanelView)(n.tree,d[0],n,t._type)})),n.Events.on("pgadmin-browser:tree:refreshing",(function(){t.isVisible()&&"properties"!==t._type&&(0,l.getPanelView)(n.tree,d[0],n,t._type)}))}})},eventFunc:function(e){var t=i(this).data("pgAdminName");try{n.Events.trigger("pgadmin-browser:panel",e,this,arguments),n.Events.trigger("pgadmin-browser:panel:"+e,this,arguments),t&&(n.Events.trigger("pgadmin-browser:panel-"+t,e,this,arguments),n.Events.trigger("pgadmin-browser:panel-"+t+":"+e,this,arguments))}catch(e){console.warn(e.stack||e)}},resizedContainer:function(){var e=this;if(e.pgElContainer&&!e.pgResizeTimeout){if(!e.isVisible())return clearTimeout(e.pgResizeTimeout),void(e.pgResizeTimeout=null);e.pgResizeTimeout=setTimeout((function(){var t=e.width(),i="xs";e.pgResizeTimeout=null,t>=480&&(i="sm"),t>=768&&(i="md"),t>=992&&(i="lg"),t>=1200&&(i="xl"),e.pgElContainer.attr("el",i)}),100)}},handleVisibility:function(t){if(!e.isNull(n.tree)){var i=n.docker.findPanels(this._type)[0],a=i.isVisible(),o=i.layout().scene().find(".pg-panel-content");a&&["dashboard","statistics","dependencies","dependents","sql","processes"].includes(i._type)&&"panelVisibilityChanged"==t&&(0,l.getPanelView)(n.tree,o[0],n,this._type),"panelClosed"==t&&"dashboard"==i._type&&(0,l.getPanelView)(n.tree,o[0],n,this._type,!1)}}}),t.Browser.Panel}.apply(t,n))||(e.exports=a)},55455:(e,t,i)=>{var n,a,l=i(18181);function o(e,t){var i;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(i=function(e,t){if(!e)return;if("string"==typeof e)return s(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return s(e,t)}(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,o=!0,r=!1;return{s:function(){i=e[Symbol.iterator]()},n:function(){var e=i.next();return o=e.done,e},e:function(e){r=!0,l=e},f:function(){try{o||null==i.return||i.return()}finally{if(r)throw l}}}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}i(47042),i(41539),i(91038),i(78783),i(82526),i(41817),i(32165),i(66992),i(33948),i(79753),i(32564),i(24812),i(26833),i(69826),i(82772),i(68309),n=[i(91669),i(58307),i(19755),i(44092)],void 0===(a=function(e,t,i,n){t.defaults.transition="zoom",t.defaults.theme.ok="btn btn-primary fa fa-lg fa-check pg-alertify-button",t.defaults.theme.cancel="btn btn-secondary fa fa-lg fa-times pg-alertify-button",t.defaults.theme.input="form-control",t.defaults.closable=!1;var a=function(e){var t=this;e&&(t.pgResizeRecursion=!1),t.pgResizeTimeout||(t.pgResizeTimeout=setTimeout(function(){var e=i(this.elements.dialog),t=e.width(),n="xs";this.pgResizeTimeout=null,t>=480&&(n="sm"),t>=768&&(n="md"),t>=992&&(n="lg"),t>=1200&&(n="xl"),e.attr("el",n)}.bind(t),100))},s=function e(t){var i=this;t&&(i.pgResizeRecursion=!0),setTimeout((function(){a.apply(i),i.pgResizeRecursion&&e.apply(i,[!1])}),100)};return t.pgDialogBuild=function(){this.set("onshow",(function(){var t=this;this.elements.dialog.classList.add("pg-el-container"),i(this.elements.commands.close).attr("title",e("Close")),i(this.elements.commands.maximize).attr("title",e("Maximize")),i(this.elements.commands.close).attr("aria-label",e("Close")),i(this.elements.commands.maximize).attr("aria-label",e("Maximize")),a.apply(this,arguments);var l=this,o=Object.values(this.elements.commands);i(o).on("keydown","button",(function(e){if(e.shiftKey&&9==e.keyCode&&0==i(t).nextAll("button:not([disabled])").length){var a=i(l.elements.footer);n.findAndSetFocus(a.find("button:not([disabled]):last"))}}))})),this.set("onresize",s.bind(this,!0)),this.set("onresized",a.bind(this,!0)),this.set("onmaximized",a),this.set("onrestored",a);var t,r=o(this.__internal.buttons);try{for(r.s();!(t=r.n()).done;){var d=t.value;l.isUndefined(d.key)&&(d.key=null)}}catch(e){r.e(e)}finally{r.f()}var c=this;i(this.elements.footer).on("keydown","button",(function(e){if(!e.shiftKey&&9==e.keyCode&&0==i(this).nextAll("button:not([disabled])").length)return n.findAndSetFocus(i(c.elements.dialog)),!1}))},t.pgHandleItemError=function(t,n,a,l){var o=window.pgAdmin.Browser;if(t&&o){var s=t.getResponseHeader("Content-Type"),r=s&&0==s.indexOf("application/json")&&JSON.parse(t.responseText);if(r&&(503==t.status?"CONNECTION_LOST"==r.info&&"server"in l.info&&r.data.sid>=0&&r.data.sid==l.info.server._id:428==t.status&&r.errormsg&&r.errormsg==e("Connection to the server has been lost."))){l.preHandleConnectionLost&&"function"==typeof l.preHandleConnectionLost&&l.preHandleConnectionLost.apply(this,arguments);var d=o.Nodes.server,c={resp:r,xhr:t,args:l},p=function(){var e=function(i,n,a){this.args.info.server._id==i&&(o.Events.off("pgadmin:server:connected",e),o.Events.off("pgadmin:server:connect:cancelled",t),this.resp.data.database&&this.resp.data.database!=a.db&&o.Events.trigger("pgadmin:database:connection:lost",this.args.item,this.resp,!0))}.bind(this),t=function(i,n,a){i==this.args.info.server.id&&(o.Events.off("pgadmin:server:connected",e),o.Events.off("pgadmin:server:connect:cancelled",t),o.Events.trigger("pgadmin:database:connect:cancelled",i,this.resp.data.database||a.db,n,a))}.bind(this);o.Events.on("pgadmin:server:connected",e),o.Events.on("pgadmin:server:connect:cancelled",t),o.Events.trigger("pgadmin:server:connection:lost",this.args.item,this.resp)}.bind(c);return i.ajax({url:d.generate_url(null,"connect",l.info.server,!0,l.info),dataType:"json"}).done((function(e){e.success&&"connected"in e.data&&e.data.connected?o.Events.trigger("pgadmin:database:connection:lost",l.item,r):p()})).fail((function(){p()})),!0}return r&&"CRYPTKEY_MISSING"==r.info&&t.status,!1}},t.confirm().set({onshow:function(){i(this.elements.commands.close).attr("title",e("Close")),i(this.elements.commands.maximize).attr("title",e("Maximize")),i(this.elements.content).addClass("ajs-wrap-text"),i(this.elements.header).attr("id","confirm-dialog-header"),i(this.elements.body).attr("id","confirm-dialog-body"),i(this.elements.dialog).attr({role:"alertdialog","aria-modal":"true","aria-labelledby":"confirm-dialog-header","aria-describedby":"confirm-dialog-body"})},reverseButtons:!0}),t.prompt().set({reverseButtons:!0}),t.alert().set({onshow:function(){i(this.elements.header).attr("id","alert-dialog-header"),i(this.elements.body).attr("id","alert-dialog-body"),i(this.elements.modal).attr({role:"alertdialog","aria-modal":"true","aria-labelledby":"alert-dialog-header","aria-describedby":"alert-dialog-body"})}}),i("body").off("keyup").on("keyup",(function(e){if(13===e.which||27===e.which){for(var t=i(e.target),n=0,a=["select2-selection","select2-search__field"];n<a.length;n++){var l=a[n];if(t.hasClass(l)){e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation();break}}if("key"==e.target.name){var o=t.closest(".value").find(".shift .btn-checkbox");0==o.length&&(o=t.closest(".value").next().find("input.form-control")),o.length&&(o.focus(),e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation())}}})),t}.apply(t,n))||(e.exports=a)},12030:(e,t,i)=>{var n,a;function l(e,t){var i;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(i=function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return o(e,t)}(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,s=!0,r=!1;return{s:function(){i=e[Symbol.iterator]()},n:function(){var e=i.next();return s=e.done,e},e:function(e){r=!0,l=e},f:function(){try{s||null==i.return||i.return()}finally{if(r)throw l}}}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function s(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function r(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?s(Object(i),!0).forEach((function(t){d(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):s(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function d(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}i(69070),i(82526),i(57327),i(38880),i(89554),i(54747),i(49337),i(33321),i(47042),i(91038),i(78783),i(41817),i(32165),i(33948),i(79753),i(23123),i(74916),i(69600),i(69826),i(5735),i(83753),i(68309),i(32564),i(24812),i(92222),i(82772),i(47941),i(5212),i(73210),i(21249),i(15306),i(91058),i(82472),i(92990),i(18927),i(33105),i(35035),i(74345),i(7174),i(32846),i(44731),i(77209),i(96319),i(58867),i(37789),i(33739),i(29368),i(14483),i(12056),i(3462),i(30678),i(27462),i(33824),i(55021),i(12974),i(15016),i(41539),i(66992),i(39575),i(39714),i(83710),n=[i(91669),i(66419),i(19755),i(72316),i(95283),i(83879),i(4631),i(81240),i(72945),i(1950),i(75471),i(76573),i(71158),i(20454),i(56796)],void 0===(a=function(e,t,i,n,a,o,s,d,c,p,u,h){var f=window.pgAdmin=window.pgAdmin||{},m=f.Browser;f.editableCell=function(){if(this.attributes&&!t.isUndefined(this.attributes.disabled)&&!t.isNull(this.attributes.disabled)){if(t.isFunction(this.attributes.disabled))return!this.attributes.disabled.apply(this,arguments);if(t.isBoolean(this.attributes.disabled))return!this.attributes.disabled}},t.extend(a,{controlLabelClassName:"control-label pg-el-sm-3 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-9 pg-el-12",controlContainerClassName:"pgadmin-controls pg-el-sm-9 pg-el-12",groupClassName:"pgadmin-control-group form-group row pg-el-12",setGroupClassName:"set-group pg-el-12",tabClassName:"backform-tab pg-el-12",setGroupContentClassName:"fieldset-content pg-el-12",accordianGroupClassName:"accordian-group pg-el-12",accordianContentClassName:"accordian-content pg-el-12",hiddenClassName:"d-none",helpMessageClassName:"form-text text-muted help-block",helpBlockControlClass:"pgadmin-controls offset-sm-3 pg-el-sm-9 pg-el-12"}),a.controlMapper={int:["uneditable-input","numeric","integer"],text:["uneditable-input","input","string"],numeric:["uneditable-input","numeric","numeric"],date:"datepicker",datetime:"datetimepicker",boolean:"boolean",options:["readonly-option","select",o.Extension.PGSelectCell],multiline:["textarea","textarea","string"],collection:["sub-node-collection","sub-node-collection","string"],uniqueColCollection:["unique-col-collection","unique-col-collection","string"],switch:"switch",select2:"select2",note:"note",color:"color",radioModern:"radioModern"},a.getMappedControl=function(e,i){if(e in a.controlMapper){var n=a.controlMapper[e];if(!t.isArray(n))return n;var l,o=t.size(n);switch(i){case"properties":default:l=0;break;case"edit":case"create":case"control":l=1;break;case"cell":l=2}return n[l>o?0:l]}return e};var g=a.RawFormatter=function(){};t.extend(g.prototype,{fromRaw:function(e){return e},toRaw:function(e){return e}});var v=a.Control.prototype.initialize,b=a.Control.prototype.remove;t.extend(a.Control.prototype,{defaults:t.extend(a.Control.prototype.defaults,{helpMessage:null}),initialize:function(){v.apply(this,arguments);var e=this.field.get("deps"),i=this;e&&t.isArray(e)&&t.each(e,(function(e){var t=e.split(".").shift();i.listenTo(i.model,"change:"+t,i.render)}))},remove:function(){var e=this,i=e.field.get("deps"),a=this.field.get("name").split("."),l=a.shift();e.stopListening(e.model,"change:"+l,e.render),e.model.errorModel instanceof n.Model&&e.stopListening(e.model.errorModel,"change:"+l,e.updateInvalid),i&&t.isArray(i)&&t.each(i,(function(t){var i=t.split(".").shift();e.stopListening(e.model,"change:"+i,e.render)})),this.cleanup&&this.cleanup.apply(this),b?b.apply(e,arguments):n.View.prototype.remove.apply(e,arguments)},template:t.template(['<label class="<%=Backform.controlLabelClassName%>" for="<%=cId%>"><%=label%></label>','<div class="<%=Backform.controlsClassName%>">','  <input id="<%=cId%>" class="<%=Backform.controlClassName%> uneditable-input" <%=disabled ? "disabled" : ""%> <%=readonly ? "readonly aria-readonly=true" : ""%> id="<%=cId%>" value="<%-value%>" />',"  <% if (helpMessage && helpMessage.length) { %>",'    <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"  <% } %>","</div>"].join("\n")),clearInvalid:function(){return this.$el.removeClass(a.errorClassName),this.$el.find(".pgadmin-control-error-message").remove(),this},updateInvalid:function(){var e=this,l=this.model.errorModel;if(!(l instanceof n.Model))return this;this.clearInvalid(),this.$el.find(":input[name]").not("button").each((function(n,o){var s=e.keyPathAccessor(l.toJSON(),i(o).attr("name"));t.isEmpty(s)||e.$el.addClass(a.errorClassName)}))},render:function(){var e=t.defaults(this.field.toJSON(),this.defaults),i=this.model.toJSON(),n=e.name.split("."),l=n.shift(),o=n.join("."),s=this.keyPathAccessor(i[l],o),r=t.extend(e,{rawValue:s,value:this.formatter.fromRaw(s,this.model),attributes:i,formatter:this.formatter}),d=function(e,i,n){return t.isFunction(e)?!!e.apply(i,[n]):!!e};return t.extend(r,{disabled:d(r.disabled,r,this.model),readonly:d(r.readonly,r,this.model),visible:d(r.visible,r,this.model),required:d(r.required,r,this.model)}),r.cId=r.cId||t.uniqueId("pgC_"),this.$el.removeClass(a.hiddenClassName),r.visible||this.$el.addClass(a.hiddenClassName),this.$el.html(this.template(r)).addClass(e.name),this.updateInvalid(),this}}),t.extend(a.InputControl.prototype,{defaults:t.extend(a.InputControl.prototype.defaults,{controlLabelClassName:a.controlLabelClassName,controlsClassName:a.controlsClassName}),template:t.template(['<label class="<%=controlLabelClassName%>" for="<%=cId%>"><%=label%></label>','<div class="<%=controlsClassName%>">','  <input type="<%=type%>" id="<%=cId%>" class="<%=Backform.controlClassName%> <%=extraClasses.join(\' \')%>" name="<%=name%>" maxlength="<%=maxlength%>" value="<%-value%>" placeholder="<%-placeholder%>" <%=disabled ? "disabled" : ""%> <%=readonly ? "readonly aria-readonly=true" : ""%> <%=required ? "required" : ""%> />',"  <% if (helpMessage && helpMessage.length) { %>",'    <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"  <% } %>","</div>"].join("\n")),events:{"change input":"onChange","blur input":"onChange","keyup input":"onKeyUp","focus input":"clearInvalid"},onKeyUp:function(e){this.key_timeout&&clearTimeout(this.key_timeout),this.keyup_timeout=setTimeout(function(){this.onChange(e)}.bind(this),400)}}),t.extend(a.TextareaControl.prototype,{defaults:t.extend(a.TextareaControl.prototype.defaults,{rows:5,helpMessage:null,maxlength:null}),events:{"change textarea":"onChange","keyup textarea":"onKeyUp","paste textarea":"onChange","selectionchange textarea":"onChange","focus textarea":"clearInvalid"},template:t.template(['<label class="<%=Backform.controlLabelClassName%>" for="<%=cId%>"><%=label%></label>','<div class="<%=Backform.controlsClassName%>">','  <textarea id="<%=cId%>"','    class="<%=Backform.controlClassName%> <%=extraClasses.join(\' \')%>" name="<%=name%>" aria-label="<%=name%>"',"  <% if (maxlength) { %>",'    maxlength="<%=maxlength%>"',"  <% } %>",'    placeholder="<%-placeholder%>" <%=disabled ? "disabled" : ""%> <%=readonly ? "readonly aria-readonly=true" : ""%>','    rows=<%=rows ? rows : ""%>','    <%=required ? "required" : ""%>><%-value%></textarea>',"  <% if (helpMessage && helpMessage.length) { %>",'    <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"  <% } %>","</div>"].join("\n")),onKeyUp:function(e){this.key_timeout&&clearTimeout(this.key_timeout),this.keyup_timeout=setTimeout(function(){this.onChange(e)}.bind(this),400)}}),a.SelectControl.prototype.render=function(){var e=t.defaults(this.field.toJSON(),this.defaults),i=this.model.toJSON(),n=e.name.split("."),l=n.shift(),o=n.join("."),s=this.keyPathAccessor(i[l],o),r=t.extend(e,{rawValue:s,value:this.formatter.fromRaw(s,this.model),attributes:i,formatter:this.formatter}),d=function(e,i,n){return t.isFunction(e)?!!e.apply(i,[n]):!!e};if(t.extend(r,{disabled:d(r.disabled,r,this.model),visible:d(r.visible,r,this.model),required:d(r.required,r,this.model)}),t.isFunction(r.options))try{r.options=r.options(this)}catch(e){r.options=[],this.model.trigger("pgadmin-view:transform:error",this.model,this.field,e)}return r.cId=r.cId||t.uniqueId("pgC_"),this.$el.removeClass(a.hiddenClassName),r.visible||this.$el.addClass(a.hiddenClassName),this.$el.html(this.template(r)).addClass(e.name),this.updateInvalid(),this},a.SelectControl.prototype.template=t.template(['<label class="<%=Backform.controlLabelClassName%>" for="<%=cId%>"><%=label%></label>','<div class="<%=Backform.controlContainerClassName%>">','  <select id="<%=cId%>" class="<%=Backform.controlClassName%> <%=extraClasses.join(\' \')%>" name="<%=name%>" value="<%-value%>" <%=disabled ? "disabled" : ""%> <%=readonly ? "disabled" : ""%> <%=required ? "required" : ""%> >',"    <% for (var i=0; i < options.length; i++) { %>","      <% var option = options[i]; %>",'      <option value="<%-formatter.fromRaw(option.value)%>" <%=option.value === rawValue ? "selected=\'selected\'" : ""%> <%=option.disabled ? "disabled=\'disabled\'" : ""%>><%-option.label%></option>',"    <% } %>","  </select>","</div>"].join("\n")),t.extend(a.SelectControl.prototype.defaults,{helpMessage:null}),a.ReadonlyOptionControl=a.SelectControl.extend({template:t.template(['<label class="<%=Backform.controlLabelClassName%>" for="<%=cId%>"><%=label%></label>','<div class="<%=Backform.controlsClassName%>">',"<% for (var i=0; i < options.length; i++) { %>"," <% var option = options[i]; %>"," <% if (option.value === rawValue) { %>",' <input id="<%=cId%>" class="<%=Backform.controlClassName%> uneditable-input" readonly value="<%-option.label%>"></span>'," <% } %>","<% } %>","<% if (helpMessage && helpMessage.length) { %>",'  <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"<% } %>","</div>"].join("\n")),events:{},getValueFromDOM:function(){return this.formatter.toRaw(this.$el.find("span").text(),this.model)}}),t.extend(a.RadioControl.prototype,{updateInvalid:function(){var e=this,l=this.model.errorModel;if(!(l instanceof n.Model))return this;this.clearInvalid(),this.$el.find(":input[name]").not("button").each((function(n,o){var s=e.keyPathAccessor(l.toJSON(),i(o).attr("name"));t.isEmpty(s)||e.$el.addClass(a.errorClassName).find('[type="radio"]').append(i("<div></div>").addClass("pgadmin-control-error-message pg-el-offset-4 pg-el-8 pg-el-8 help-block").text(s))}))}}),a.RadioModernControl=a.RadioControl.extend({defaults:{controlLabelClassName:a.controlLabelClassName,controlsClassName:a.controlsClassName,extraClasses:[],helpMessage:"",name:""},events:t.extend({},a.InputControl.prototype.events,{"click label.btn":"toggle"}),toggle:function(e){var t=i(e.currentTarget);t.closest(".btn-group").find(".btn").removeClass("btn-primary").addClass("btn-secondary").find(".fa").addClass("visibility-hidden").siblings("input").prop("checked",!1),t.removeClass("btn-secondary").addClass("btn-primary").find(".fa").removeClass("visibility-hidden").siblings("input").prop("checked",!0).trigger("change"),e.preventDefault(),e.stopPropagation()},template:t.template(["<% if (label) { %>",'<label class="<%=controlLabelClassName%>" id="<%=cId%>_grplabel"><%=label%></label>',"<% } %>","<div class=\"<%=controlsClassName%> <%=extraClasses.join(' ')%>\">",' <div class="btn-group pgadmin-controls-radio-none<% if (disabled) {%> disabled <%}%>" role="radiogroup" <% if (label) {%> aria-labelledby="<%=cId%>_grplabel" <%}%>>',"  <% for (var i=0; i < options.length; i++) { %>","  <% var option = options[i]; %>",'  <label role="radio" class="btn btn-radiomodern <% if (option.value == value) { %> btn-primary <%} else {%> btn-secondary <%}%> <% if (!option.disabled && !disabled) { %>" tabindex="0"<% } else { %> disabled"<% } %>>','    <i class="fa fa-check  <% if (option.value != value) { %>visibility-hidden <%}%>" role="img"></i>','    <input type="radio" name="<%=name%>" autocomplete="off" value=<%-formatter.fromRaw(option.value)%> <% if (option.value == value) { %> checked<%}%> <% if (option.disabled || disabled) { %> disabled <%}%>> <%-option.label%>',"  </label>","  <% } %>"," </div>"," <% if (helpMessage && helpMessage.length) { %>",'  <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>'," <% } %>","</div>"].join("\n")),formatter:g,getValueFromDOM:function(){return this.formatter.toRaw(this.$el.find('input[type="radio"]:checked').attr("value"),this.model)},render:function(){var e=t.defaults(this.field.toJSON(),this.defaults),n=this.model.toJSON(),l=e.name.split("."),o=l.shift(),s=l.join("."),r=this.keyPathAccessor(n[o],s),d=t.extend(e,{rawValue:r,value:this.formatter.fromRaw(r,this.model),attributes:n,formatter:this.formatter}),c=function(e,i,n){return t.isFunction(e)?!!e.apply(i,[n]):!!e};return t.extend(d,{disabled:c(d.disabled,d,this.model),visible:c(d.visible,d,this.model),required:c(d.required,d,this.model)}),d.cId=d.cId||t.uniqueId("pgC_"),d.options=t.isFunction(d.options)?d.options.apply(d,[this.model]):d.options,this.$el.removeClass(a.hiddenClassName),d.visible||this.$el.addClass(a.hiddenClassName),this.$el.html(this.template(d)).addClass(e.name),this.updateInvalid(),this.$el.find(".btn").on("keyup",(function(e){32==e.keyCode&&i(e.currentTarget).trigger("click")})),this}}),a.SwitchControl=a.InputControl.extend({defaults:{label:"",options:{onText:e("Yes"),offText:e("No"),onColor:"success",offColor:"ternary",size:"mini",width:null,height:null},controlLabelClassName:a.controlLabelClassName,controlsClassName:a.controlsClassName,extraClasses:[],helpMessage:null,extraToggleClasses:null},template:t.template(['<span class="<%=controlLabelClassName%>"><%=label%></span>',"<div class=\"<%=controlsClassName%> <%=extraClasses.join(' ')%>\">",'      <input tabindex="-1" type="checkbox" aria-hidden="true" aria-label="'+e("Toggle button")+'" data-style="quick" data-toggle="toggle"','      data-size="<%=options.size%>" data-height="<%=options.height%>"  ','      data-on="<%=options.onText%>" data-off="<%=options.offText%>" ','      data-onstyle="<%=options.onColor%>" data-offstyle="<%=options.offColor%>" data-width="<%=options.width%>" ','      name="<%=name%>" <%=value ? "checked=\'checked\'" : ""%> <%=disabled ? "disabled" : ""%> <%=readonly ? "disabled" : ""%> <%=required ? "required" : ""%> />',"  <% if (helpMessage && helpMessage.length) { %>",'    <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"  <% } %>","</div>"].join("\n")),getValueFromDOM:function(){return this.formatter.toRaw(this.$input.prop("checked"),this.model)},events:{"change input":"onChange",keyup:"toggleSwitch"},setSrValue:function(){var i=t.defaults(this.field.get("options"),this.defaults.options),n=i.onText,a=i.offText,l=this.field.get("label");this.$el.find(".toggle.btn").hasClass("off")?this.$el.find(".sr-value").text("\n          ".concat(l,", ").concat(a,", ")+e("Toggle")+"\n        "):this.$el.find(".sr-value").text("\n          ".concat(l,", ").concat(n,", ")+e("Toggle")+"\n        ")},onChange:function(){a.InputControl.prototype.onChange.apply(this,arguments),this.setSrValue()},toggleSwitch:function(e){32==e.keyCode&&(this.$el.find("input[type=checkbox]").bootstrapToggle("toggle"),e.preventDefault(),this.setSrValue())},render:function(){var e=t.defaults(this.field.toJSON(),this.defaults),n=this.model.toJSON(),l=e.name.split("."),o=l.shift(),s=l.join("."),r=this.keyPathAccessor(n[o],s),d=t.extend(e,{rawValue:r,value:this.formatter.fromRaw(r,this.model),attributes:n,formatter:this.formatter}),c=function(e,i,n){return t.isFunction(e)?!!e.apply(i,[n]):!!e};return t.extend(d,{disabled:c(e.disabled,e,this.model),readonly:c(e.readonly,e,this.model),visible:c(d.visible,e,this.model),required:c(d.required,e,this.model)}),d.cId=d.cId||t.uniqueId("pgC_"),this.$el.removeClass(a.hiddenClassName),d.visible||this.$el.addClass(a.hiddenClassName),a.requiredInputClassName&&this.$el.removeClass(a.requiredInputClassName),d.required&&this.$el.addClass(a.requiredInputClassName),d.options=t.defaults({disabled:d.disabled||d.readonly},this.field.get("options"),this.defaults.options,i.fn.bootstrapToggle.defaults),this.$el.html(this.template(d)).addClass(e.name),t.isNull(e.extraToggleClasses)||this.$el.addClass(e.extraToggleClasses),this.$input=this.$el.find("input[type=checkbox]").first(),this.$input.bootstrapToggle(),this.$el.find(".toggle.btn").attr("tabindex",d.disabled?"-1":"0").attr("id",d.cId),this.$el.find(".toggle.btn .toggle-group .btn").attr("aria-hidden",!0),this.$el.find("div.toggle").append('<label class="sr-value sr-only" for="<%=cId%>"></label>'),this.setSrValue(),this.updateInvalid(),d.readonly&&this.$el.find(".select2-selection").attr("tabindex",0),this}}),a.Dialog=a.Form.extend({schema:void 0,tagName:"div",legend:!0,className:function(){return"pg-el-sm-12 pg-el-md-12 pg-el-lg-12 pg-el-12"},tabPanelClassName:function(){return a.tabClassName},tabIndex:0,initialize:function(e){var i=e.schema;i&&t.isArray(i)&&(this.schema=t.each(i,(function(i){!i.fields||i.fields instanceof n.Collection||(i.fields=new a.Fields(i.fields)),i.cId=i.cId||t.uniqueId("pgC_"),i.hId=i.hId||t.uniqueId("pgH_"),i.disabled=i.disabled||!1,i.legend=e.legend})),e.tabPanelClassName&&t.isFunction(e.tabPanelClassName)&&(this.tabPanelClassName=e.tabPanelClassName)),this.model.errorModel=e.errorModel||this.model.errorModel||new n.Model,this.controls=[]},template:{header:t.template(['<li class="nav-item" <%=disabled ? "disabled" : ""%>>',' <a class="nav-link" data-toggle="tab" role="tab" tabindex="-1" data-tab-index="<%=tabIndex%>" href="#<%=cId%>"','  id="<%=hId%>" aria-controls="<%=cId%>">',"<%=label%></a></li>"].join(" ")),panel:t.template('<div role="tabpanel" tabindex="-1" class="tab-pane <%=label%> <%=tabPanelCodeClass%> pg-el-sm-12 pg-el-md-12 pg-el-lg-12 pg-el-12 fade" id="<%=cId%>" aria-labelledby="<%=hId%>"></div>')},render:function(){this.cleanup();var e=this.$el.children().first().children(".active").first().attr("id"),n=this.model,a=this.controls,l=this.template,o=this,s=100*this.tabIndex;this.$el.empty().attr("role","tabpanel").attr("class",t.result(this,"tabPanelClassName")),n.panelEl=this.$el;var r=i('<ul class="nav nav-tabs" role="tablist"></ul>').appendTo(this.$el),d=i('<div class="tab-content pg-el-sm-12 pg-el-md-12 pg-el-lg-12 pg-el-12"></div>').appendTo(this.$el);t.each(this.schema,(function(e){if(s++,e.version_compatible&&(c=e.visible,p=e,u=n,t.isFunction(c)?c.apply(p,[u]):c)){var c,p,u,h=i(l.panel(t.extend(e,{tabIndex:s,tabPanelCodeClass:e.tabPanelCodeClass?e.tabPanelCodeClass:""}))).appendTo(d).removeClass("collapse").addClass("collapse");i(l.header(e)).appendTo(r),e.fields.each((function(e){var t=new(e.get("control"))({field:e,model:n,dialog:o,tabIndex:s});h.append(t.render().$el),a.push(t)})),r.find('a[data-toggle="tab"]').off("shown.bs.tab").off("hidden.bs.tab").on("hidden.bs.tab",(function(){o.hidden_tab=i(this).data("tabIndex")})).on("shown.bs.tab",(function(){var e=this;e.shown_tab=i(e).data("tabIndex"),n.trigger("pg-property-tab-changed",{model:n,shown:e.shown_tab,hidden:e.hidden_tab,tab:e})}))}}));var c=r.find('[id="'+e+'"]').first();return 1==c.length?(c.addClass("active show"),d.find("#"+c.attr("aria-controls")).addClass("active show")):(r.find(".nav-link").first().addClass("active show"),d.find(".tab-pane").first().addClass("active show")),this},remove:function(e){e&&e.data&&(this.model&&(this.model.reset&&this.model.reset({validate:!1,silent:!0,stop:!0}),this.model.clear({validate:!1,silent:!0,stop:!0}),delete this.model),this.errorModel&&(this.errorModel.clear({validate:!1,silent:!0,stop:!0}),delete this.errorModel)),this.cleanup(),a.Form.prototype.remove.apply(this,arguments)}}),a.Accordian=a.Dialog.extend({className:function(){return"set-group pg-el-12"},tabPanelClassName:function(){return a.tabClassName},legendClass:"badge",contentClass:a.accordianContentClassName+" collapse show",template:{header:t.template(['<div class="<%=Backform.accordianGroupClassName%>" <%=disabled ? "disabled" : ""%>>'," <% if (legend != false) { %>",'  <div class="<%=legendClass%>" <%=collapse ? "data-toggle=\'collapse\'" : ""%> data-target="#<%=cId%>" aria-controls="<%=cId%>" aria-level="3" role="heading"><%=collapse ? "<span class=\'caret\'></span>" : "" %><%=label%></legend>'," <% } %>","</div>"].join("\n")),content:t.template('  <div id="<%= cId %>" class="<%=contentClass%>"></div>')},collapse:!0,render:function(){this.cleanup();var e=this.model,n=this.$el,a=this.template,l=this.controls,o={className:t.result(this,"className"),legendClass:t.result(this,"legendClass"),contentClass:t.result(this,"contentClass"),collapse:t.result(this,"collapse")},s=100*this.tabIndex;return this.$el.empty(),t.each(this.schema,(function(r){if(s++,r.version_compatible&&function(e,i,n){return t.isFunction(e)?!!e.apply(i,[n]):!!e}(r.visible,r,e)&&r.fields){var d=t.extend({},o,r),c=i(a.header(d)).appendTo(n),p=i(a.content(d)).appendTo(c);r.fields.each((function(t){var i=new(t.get("control"))({field:t,model:e,tabIndex:s});p.append(i.render().$el),l.push(i)}))}})),this},getValueFromDOM:function(){return""},events:{}}),a.Fieldset=a.Dialog.extend({className:function(){return"set-group pg-el-12"},tabPanelClassName:function(){return a.tabClassName},fieldsetClass:a.setGroupClassName,legendClass:"badge",contentClass:a.setGroupContentClassName+" collapse show",template:{header:t.template(['<fieldset class="<%=fieldsetClass%>" <%=disabled ? "disabled" : ""%>>'," <% if (legend != false) { %>",'  <legend class="<%=legendClass%>" <%=collapse ? "data-toggle=\'collapse\'" : ""%> data-target="#<%=cId%>"><%=collapse ? "<span class=\'caret\'></span>" : "" %><%=label%></legend>'," <% } %>","</fieldset>"].join("\n")),content:t.template('  <div id="<%= cId %>" class="<%=contentClass%>"></div>')},collapse:!0,render:function(){this.cleanup();var e=this.model,n=this.$el,a=this.template,l=this.controls,o={className:t.result(this,"className"),fieldsetClass:t.result(this,"fieldsetClass"),legendClass:t.result(this,"legendClass"),contentClass:t.result(this,"contentClass"),collapse:t.result(this,"collapse")},s=100*this.tabIndex;return this.$el.empty(),t.each(this.schema,(function(r){if(s++,r.version_compatible&&function(e,i,n){return t.isFunction(e)?!!e.apply(i,[n]):!!e}(r.visible,r,e)&&r.fields){var d=t.extend({},o,r),c=i(a.header(d)).appendTo(n),p=i(a.content(d)).appendTo(c);r.fields.each((function(t){var i=new(t.get("control"))({field:t,model:e,tabIndex:s});p.append(i.render().$el),l.push(i)}))}})),this},getValueFromDOM:function(){return""},events:{}}),a.generateGridColumnsFromModel=function(e,i,n,l,s){var r,d=a.generateViewSchema(e,i,n,s,!0,!0),c=[],p=[],u=0;if(t.isNull(l)||t.isUndefined(l))r=function(e){e.cell_priority=u,u+=1,!e.headerCell&&e.cellHeaderClasses&&(e.headerCell=o.Extension.CustomHeaderCell)};else if(t.isArray(l))r=function(e){e.cell_priority=t.indexOf(l,e.name),!e.headerCell&&e.cellHeaderClasses&&(e.headerCell=o.Extension.CustomHeaderCell)};else if(t.isObject(l)){var h=Object.keys(l);r=function(e){var i,n=e.name in l&&l[e.name];t.isNull(n)||t.isUndefined(n)?e.cell_priority=-1:(t.isObject(n)&&("index"in n?(e.cell_priority=n.index,u=u>n.index?u+1:n.index):(i=t.indexOf(h,e.name),e.cell_priority=u=i>u?i:u,u+=1),e.headerCell||(e.cellHeaderClasses&&(e.headerCell=o.Extension.CustomHeaderCell),"class"in n&&t.isString(n.class)&&(e.headerCell=o.Extension.CustomHeaderCell,e.cellHeaderClasses=(e.cellHeaderClasses||"")+" "+n.class))),t.isString(n)&&(i=t.indexOf(h,e.name),e.cell_priority=u=i>u?i:u,u+=1,e.headerCell||(e.headerCell=o.Extension.CustomHeaderCell),e.cellHeaderClasses=(e.cellHeaderClasses||"")+" "+n))}}return t.each(d,(function(e){t.each(e.fields,(function(e){e.cell&&(r(e),-1!=e.cell_priority&&p.push(e))})),c.push(e)})),{columns:t.sortBy(p,(function(e){return e.cell_priority})),schema:c}},a.BinaryPathsGridControl=a.Control.extend({initialize:function(){a.Control.prototype.initialize.apply(this,arguments);var i=n.Model.extend({idAttribute:"serverType",defaults:{serverType:void 0,binaryPath:void 0,isDefault:!1}}),l=f.enable_binary_path_browsing?e("Select binary path..."):e("Enter binary path..."),s=!!f.enable_binary_path_browsing;"False"===f.server_mode&&(l=e("Select binary path..."),s=!0),this.gridColumns=[{name:"isDefault",label:e("Set as default"),sortable:!1,cell:o.RadioCell,cellHeaderClasses:"width_percent_10",headerCell:o.Extension.CustomHeaderCell,deps:["binaryPath"],editable:function(e){return!t.isUndefined(e.get("binaryPath"))&&!t.isNull(e.get("binaryPath"))&&""!==e.get("binaryPath")||(t.isUndefined(e.get("isDefault"))||t.isNull(e.get("isDefault"))||setTimeout((function(){e.set("isDefault",!1)}),10),!1)}},{name:"serverType",label:e("Database Server"),editable:!1,cell:"string",cellHeaderClasses:"width_percent_20",headerCell:o.Extension.CustomHeaderCell},{name:"binaryPath",label:e("Binary Path"),sortable:!1,cell:o.Extension.SelectFileCell,dialog_type:"select_folder",dialog_title:e("Select Folder"),placeholder:l,browse_btn_label:e("Select path"),check_btn_label:e("Validate utilities"),browse_btn_visible:s}];var r=this.BinPathCollection=new(n.Collection.extend({model:i}))(null),d=JSON.parse(this.model.get(this.field.get("name")));this.BinPathCollection.add(d),this.listenTo(r,"change",this.binPathCollectionChanged)},render:function(){var t=this,n=["<div class='subnode-header'>","  <span class='control-label pg-el-sm-12'>"+e(this.field.get("label"))+"</span>","</div>"].join("\n"),a=i("<div class='pgadmin-control-group backgrid form-group pg-el-12 object subnode'></div>").append(n);return t.grid=new o.Grid({columns:t.gridColumns,collection:t.BinPathCollection,className:"backgrid table presentation table-bordered table-noouter-border table-hover"}),this.$el.empty(),this.$el.append(a.append(t.grid.render().$el)),this.$el.append(['<span class="pg-el-sm-12 form-text text-muted help-block">'+e("Enter the directory in which the psql, pg_dump, pg_dumpall, and pg_restore utilities can be found for the corresponding database server version. The default path will be used for server versions that do not have a path specified.")+"</span>"].join("\n")),this},binPathCollectionChanged:function(){var e=JSON.stringify(this.BinPathCollection.toJSON());this.model.set(this.field.get("name"),e,{silent:!1})}}),a.UniqueColCollectionControl=a.Control.extend({initialize:function(){a.Control.prototype.initialize.apply(this,arguments);var e=this.field.get("uniqueCol")||[],i=this.field.get("model"),n=i.prototype.schema||i.__super__.schema,l=[],o=this;if(t.each(n,(function(e){l.push(e.id)})),e.length>t.intersection(l,e).length)throw new Error("Developer: Unique columns [ "+t.difference(e,l)+" ] not found in collection model [ "+l+" ].");var s=o.collection=o.model.get(o.field.get("name"));s||(s=o.collection=new f.Browser.Node.Collection(null,{model:o.field.get("model"),silent:!0,handler:o.model,top:o.model.top||o.model,attrName:o.field.get("name")}),o.model.set(o.field.get("name"),s,{silent:!0})),this.field.get("version_compatible")&&(o.listenTo(s,"add",o.collectionChanged),o.listenTo(s,"change",o.collectionChanged))},cleanup:function(){this.stopListening(this.collection,"change",this.collectionChanged),this.field.get("version_compatible")&&(this.stopListening(self.collection,"add",this.collectionChanged),this.stopListening(self.collection,"change",this.collectionChanged)),this.grid&&(this.grid.remove(),delete this.grid),this.$el.empty()},collectionChanged:function(e,n,a){var l=this.field.get("uniqueCol")||[],o=[];if(e.attributes&&(t.each(l,(function(i){t.has(e.attributes,i)&&o.push(i)})),0!=o.length)){var s=this.model.get(this.field.get("name"));this.stopListening(s,"change",this.collectionChanged);var r=void 0,d=void 0;if(s.each((function(i){if(e!=i){var n=[];t.each(l,(function(a){var l=e.get(a);t.isUndefined(l)||l!=i.get(a)||n.push(l)})),n.length==l.length&&(r=e,d=i)}})),r&&(a&&a.add?setTimeout((function(){s.remove(r)}),0):r.set(o[0],r.previous(o[0])),d)){var c=s.indexOf(d);if(c>-1){var p=this.grid.body.rows[c].$el;p.addClass("new"),i(p).pgMakeVisible("backform-tab"),setTimeout((function(){p.removeClass("new")}),3e3)}}this.listenTo(s,"change",this.collectionChanged)}},render:function(){this.undelegateEvents(),this.$el.empty();var e=t.defaults(this.field.toJSON(),this.defaults),i=this.model.toJSON(),n=e.name.split("."),a=n.shift(),l=n.join("."),o=this.keyPathAccessor(i[a],l),s=t.extend(e,{rawValue:o,value:this.formatter.fromRaw(o,this.model),attributes:i,formatter:this.formatter}),r=function(e,i,n){return t.isFunction(e)?!!e.apply(i,[n]):!!e};if(t.extend(s,{disabled:e.version_compatible&&r.apply(this.field,[s.disabled,s,this.model]),visible:r.apply(this.field,[s.visible,s,this.model]),required:r.apply(this.field,[s.required,s,this.model]),canAdd:e.version_compatible&&r.apply(this.field,[s.canAdd,s,this.model]),canAddRow:s.canAddRow,canDelete:r.apply(this.field,[s.canDelete,s,this.model]),canEdit:r.apply(this.field,[s.canEdit,s,this.model])}),t.extend(s,{add_label:""}),!s.visible)return this;this.control_data=t.clone(s);var d=this.showGridControl(s);return this.$el.html(d).addClass(e.name),this.updateInvalid(),this.delegateEvents(),this},showGridControl:function(n){n.cId=n.cId||t.uniqueId("pgC_");var l=this,s=t.template(['<div class="subnode-header">','  <span  class="control-label pg-el-sm-10" id="<%=cId%>"><%-label%></span>','  <button aria-label="'+e("Add new row")+'" class="btn btn-sm-sq btn-primary-icon add fa fa-plus" <%=canAdd ? "" : "disabled=\'disabled\'"%> title="'+e("Add new row")+'"><%-add_label%></button>',"</div>"].join("\n")),r=i('<div class="pgadmin-control-group backgrid form-group pg-el-12 object subnode "></div>').append(s(n));if(l.grid&&l.grid.remove(),!n.subnode)return"";var d=n.subnode.schema?n.subnode:n.subnode.prototype,u=a.generateGridColumnsFromModel(n.node_info,d,this.field.get("mode"),n.columns);if("properties"==n.mode&&i(r).find("button.add").remove(),!n.disabled&&n.canDelete&&u.columns.unshift({name:"pg-backform-delete",label:"",cell:o.Extension.DeleteCell,editable:!1,cell_priority:-1,canDeleteRow:n.canDeleteRow}),0==n.disabled&&n.canEdit){var h=o.Extension.ObjectCell.extend({schema:u.schema});u.columns.unshift({name:"pg-backform-edit",label:"",cell:h,cell_priority:-2,canEditRow:n.canEditRow})}var f=this.model.get(n.name);f.on("enteringEditMode",(function(e){var t=this,i=e[0];this.each((function(e){if(i.model!=e){var n=t.indexOf(e);if(n>-1){var a=l.grid.body.rows[n].$el.find(".subnode-edit-in-process").parent();if(a.length>0){var o=new Event("click");a[0].dispatchEvent(o)}}}}))}),f),l.grid=new o.Grid({columns:u.columns,collection:f,className:"backgrid table presentation table-bordered table-noouter-border table-hover",attr:{"aria-labelledby":n.cId}});for(var g=0;g<f.length;g++)f.at(g).parentTr=l.grid.body.rows[g].$el;var v=l.grid.render().$el;n.canDelete&&n.canEdit&&(i(v).find("th.pg-backform-delete").remove(),i(v).find("th.pg-backform-edit").attr("colspan","2"));var b=r.append(v),y=m;0==m.preferences_cache.length&&(y=p.default.pgAdmin.Browser);var C=y.get_preferences_for_module("browser");if(C){var w=b.find(".add");i(w).attr("title",c.shortcut_title(e("Add new row"),C.add_grid_row))}return n.disabled||0==n.canAdd||b.find("button.add").first().on("click",(function(e){if(e.preventDefault(),!t.isFunction(n.canAddRow)||n.canAddRow.apply(l,[l.model])){if(t.each(l.grid.body.rows,(function(e){var t=e.$el.find(".subnode-edit-in-process").parent();if(t.length>0){var i=new Event("click");t[0].dispatchEvent(i)}})),!!!l.field.get("allowMultipleEmptyRows")&&f){var a=!1;if(f.each((function(e){var i=[];t.each(e.attributes,(function(e){i.push(e)})),t.some(i,t.identity)||(a=!0)})),a)return!1}i(l.grid.body.$el.find(i("tr.new"))).removeClass("new");var o=new n.model(null,{silent:!0,handler:f,top:l.model.top||l.model,collection:f,node_info:l.model.node_info});n.beforeAdd&&(o=n.beforeAdd.apply(l,[o])),f.add(o);var s=f.indexOf(o),r=l.grid.body.rows[s].$el;return f.get(o).parentTr=r,o.parentTr=r,r.addClass("new"),i(r).pgMakeBackgridVisible(".backform-tab")||i(r).pgMakeBackgridVisible(".set-group"),!1}})),b},clearInvalid:function(){return this.$el.removeClass("subnode-error"),this.$el.find(".pgadmin-control-error-message").remove(),this},updateInvalid:function(){if(!(this.model.errorModel instanceof n.Model))return this;this.clearInvalid()}}),a.SubNodeCollectionControl=a.Control.extend({row:o.Row,render:function(){var e=t.defaults(this.field.toJSON(),this.defaults),i=this.model.toJSON(),n=e.name.split("."),l=n.shift(),o=n.join("."),s=this.keyPathAccessor(i[l],o),r=t.extend(e,{rawValue:s,value:this.formatter.fromRaw(s,this.model),attributes:i,formatter:this.formatter}),d=function(e,i,n){return t.isFunction(e)?!!e.apply(i,[n]):!!e};t.extend(r,{disabled:d(r.disabled,r,this.model),visible:d(r.visible,r,this.model),required:d(r.required,r,this.model),canAdd:d(r.canAdd,r,this.model),canAddRow:r.canAddRow,canEdit:d(r.canEdit,r,this.model),canDelete:d(r.canDelete,r,this.model),showError:r.showError||!0});var c=null==r.subnode?"":this.showGridControl(r);return this.$el.removeClass(a.hiddenClassName),r.visible||this.$el.addClass(a.hiddenClassName),this.$el.html(c).addClass(e.name),this.updateInvalid(),this},updateInvalid:function(){var e=this,a=this.model.errorModel;if(!(a instanceof n.Model))return this;this.clearInvalid();var l=e.field.get("name").split(".").join("."),o=e.keyPathAccessor(a.toJSON(),l);t.isEmpty(o)||e.field.get("showError")&&e.$el.addClass("subnode-error").append(i("<div></div>").addClass("pgadmin-control-error-message pg-el-offset-4 pg-el-8 help-block").text(o))},cleanup:function(){this.grid&&this.grid.remove(),this.collection&&this.collection.off("enteringEditMode")},clearInvalid:function(){return this.field.get("showError")&&(this.$el.removeClass("subnode-error"),this.$el.find(".pgadmin-control-error-message").remove()),this},showGridControl:function(n){var l=this,s=this,r=["<div class='subnode-header'>","  <span class='control-label pg-el-sm-10'>"+n.label+"</span>",'  <button aria-label="'+e("Add")+"\" class='btn btn-sm-sq btn-primary-icon add fa fa-plus' title='"+e("Add new row")+"'></button>","</div>"].join("\n"),d=i("<div class='pgadmin-control-group backgrid form-group pg-el-12 object subnode'></div>").append(r),u=n.subnode.schema?n.subnode:n.subnode.prototype,h=a.generateGridColumnsFromModel(n.node_info,u,this.field.get("mode"),n.columns,n.schema_node);if(s.grid&&s.grid.remove(),(n.disabled||0==n.canAdd)&&i(d).find("button.add").remove(),0==n.disabled&&n.canDelete&&h.columns.unshift({name:"pg-backform-delete",label:"",cell:o.Extension.DeleteCell,editable:!1,cell_priority:-1,canDeleteRow:n.canDeleteRow,customDeleteMsg:n.customDeleteMsg,customDeleteTitle:n.customDeleteTitle}),0==n.disabled&&n.canEdit){var f=o.Extension.ObjectCell.extend({schema:h.schema}),g=s.field.has("canEdit")&&s.field.get("canEdit")||!0;h.columns.unshift({name:"pg-backform-edit",label:"",cell:f,cell_priority:-2,editable:g,canEditRow:n.canEditRow})}var v=s.model.get(n.name);v||(v=new m.Node.Collection(null,{handler:s.model.handler||s.model,model:n.model,top:s.model.top||s.model,silent:!0}),s.model.set(n.name,v,{silent:!0}));v.on("enteringEditMode",(function(e){var t=this,i=e[0];this.each((function(e){if(i.model!=e){var n=t.indexOf(e);if(n>-1){var a=b.body.rows[n].$el.find(".subnode-edit-in-process").parent();if(a.length>0){var l=new Event("click");a[0].dispatchEvent(l)}}}}))}),v);var b=s.grid=new o.Grid({columns:h.columns,collection:v,row:this.row,className:"backgrid table presentation table-bordered table-noouter-border table-hover"}),y=b.render().$el;n.canDelete&&n.canEdit&&(i(y).find("th.pg-backform-delete").remove(),i(y).find("th.pg-backform-edit").attr("colspan","2"));var C=d.append(y),w=m;0==m.preferences_cache.length&&(w=p.default.pgAdmin.Browser);var _=w.get_preferences_for_module("browser");if(_){var x=C.find(".add");i(x).attr("title",c.shortcut_title(e("Add new row"),_.add_grid_row))}return C.find("button.add").on("click",(function(e){if(e.preventDefault(),!t.isFunction(n.canAddRow)||n.canAddRow.apply(s,[s.model])){t.each(b.body.rows,(function(e){var t=e.$el.find(".subnode-edit-in-process").parent();if(t.length>0){var i=new Event("click");t[0].dispatchEvent(i)}})),b.insertRow({});var a=i(b.body.rows[v.length-1].$el);return a.attr("class","new").on("click",(function(){i(l).attr("class","editable")})),i(a).pgMakeBackgridVisible(".backform-tab")||i(a).pgMakeBackgridVisible(".set-group"),!1}})),C}}),a.SqlTabControl=a.Control.extend({defaults:{label:"",controlsClassName:"pgadmin-controls pg-el-sm-12 SQL",extraClasses:[],helpMessage:null},template:t.template(['<label for="<%=cId%>" class="sr-only"><%=(label==""?"SQL":label)%></label>','<div class="<%=controlsClassName%>">','  <textarea id="<%=cId%>" class="<%=Backform.controlClassName%> <%=extraClasses.join(\' \')%>" name="<%=name%>" aria-label="<%=name%>" placeholder="<%-placeholder%>" <%=disabled ? "disabled" : ""%> <%=readonly ? "readonly aria-readonly=true" : ""%> <%=required ? "required" : ""%>><%-value%></textarea>',"  <% if (helpMessage && helpMessage.length) { %>",'    <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"  <% } %>","</div>"].join("\n")),initialize:function(e){a.Control.prototype.initialize.apply(this,arguments),this.dialog=e.dialog,this.tabIndex=e.tabIndex,t.bindAll(this,"onTabChange","onPanelResized")},getValueFromDOM:function(){return this.formatter.toRaw(this.$el.find("textarea").val(),this.model)},reflectPreferences:function(){var e=this;if(e.sqlCtrl){var t=f.Browser.get_preferences_for_module("sqleditor");i(e.sqlCtrl.getWrapperElement()).css("font-size",d.calcFontSize(t.sql_font_size)),e.sqlCtrl.setOption("tabSize",t.tab_size),e.sqlCtrl.setOption("lineWrapping",t.wrap_code),e.sqlCtrl.setOption("autoCloseBrackets",t.insert_pair_brackets),e.sqlCtrl.setOption("matchBrackets",t.brace_matching),e.sqlCtrl.refresh()}},render:function(){this.sqlCtrl&&(this.sqlCtrl.toTextArea(),delete this.sqlCtrl,this.sqlCtrl=null,this.$el.empty(),this.model.off("pg-property-tab-changed",this.onTabChange,this),this.model.off("pg-browser-resized",this.onPanelResized,this)),a.Control.prototype.render.apply(this,arguments),this.sqlCtrl=s.fromTextArea(this.$el.find("textarea")[0],{lineNumbers:!0,mode:"text/x-pgsql",readOnly:!0,extraKeys:f.Browser.editor_shortcut_keys,screenReaderLabel:"SQL"}),this.reflectPreferences();var e=this;return this.$el.find("textarea").attr("tabindex",-1),m.onPreferencesChange("sqleditor",(function(){e.reflectPreferences()})),this.model.on("pg-property-tab-changed",this.onTabChange,this),this.model.on("pg-browser-resized",this.onPanelResized,this),this},onTabChange:function(n){if(this.dialog&&n.shown==this.tabIndex){if(this.model.sessChanged())if(0==t.size(this.model.errorModel.attributes)){var a=this,l=a.field.get("schema_node"),o=l.generate_url.apply(l,[null,"msql",this.field.get("node_data"),!a.model.isNew(),this.field.get("node_info"),l.url_jump_after_node]);a.model.trigger("pgadmin-view:msql:fetching",a.method,l),i.ajax({url:o,type:"GET",cache:!1,data:a.model.toJSON(!0,"GET"),dataType:"json",contentType:"application/json"}).done((function(e){a.sqlCtrl.clearHistory(),a.sqlCtrl.setValue(e.data)})).fail((function(){a.model.trigger("pgadmin-view:msql:error",a.method,l,arguments)})).always((function(){a.model.trigger("pgadmin-view:msql:fetched",a.method,l,arguments)}))}else this.sqlCtrl.clearHistory(),this.sqlCtrl.setValue("-- "+e("Definition incomplete."));else this.sqlCtrl.clearHistory(),this.sqlCtrl.setValue("-- "+e("No updates."));this.sqlCtrl.refresh.apply(this.sqlCtrl)}},onPanelResized:function(e){if(e&&e.container){var t=e.container.find(".backform-tab > .tab-content").first(),i=t.find("div[role=tabpanel].tab-pane.SQL");i.hasClass("active")&&i.find(".CodeMirror").css("cssText","height: "+(t.height()+8)+"px !important;")}},remove:function(){this.sqlCtrl&&(this.sqlCtrl.toTextArea(),delete this.sqlCtrl,this.sqlCtrl=null,this.$el.empty()),this.model.off("pg-property-tab-changed",this.onTabChange,this),this.model.off("pg-browser-resized",this.onPanelResized,this),a.Control.__super__.remove.apply(this,arguments)}}),a.NumericControl=a.InputControl.extend({defaults:{type:"number",label:"",min:void 0,max:void 0,maxlength:255,extraClasses:[],helpMessage:null},template:t.template(['<label for="<%=cId%>" class="<%=Backform.controlLabelClassName%> text-wrap"><%=label%></label>','<div class="<%=Backform.controlsClassName%>">','  <input type="<%=type%>" id="<%=cId%>" class="<%=Backform.controlClassName%> <%=extraClasses.join(\' \')%>" name="<%=name%>" min="<%=min%>" max="<%=max%>"maxlength="<%=maxlength%>" value="<%-value%>" placeholder="<%-placeholder%>" <%=disabled ? "disabled" : ""%> <%=readonly ? "readonly aria-readonly=true" : ""%> <%=required ? "required" : ""%> />',"  <% if (helpMessage && helpMessage.length) { %>",'    <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"  <% } %>","</div>"].join("\n"))}),a.generateViewSchema=function(i,n,l,o,s,r,d){var c=n&&n.prototype||n,p=d||c&&c.schema,u=[],h={};if(p&&t.isArray(p)){var g,v=v=function(e){return e&&c[e]&&"function"==typeof c[e]?c[e]:e},b={},y=i&&"server"in i&&m.serverInfo&&m.serverInfo[i.server._id],C=i&&"catalog"in i;if(t.each(p,(function(r){if("group"==r.type){var d=!0;return g=!!t.isUndefined(y)||(!!t.isUndefined(r.server_type)||y.type in r.server_type)&&(!!t.isUndefined(r.min_version)||y.version>=r.min_version)&&(!!t.isUndefined(r.max_version)||y.version<=r.max_version),r.mode&&t.isObject(r.mode)&&(d=t.indexOf(r.mode,l)>-1),d&&(d=v(r.visible)),void(h[r.id]={label:r.label||r.id,version_compatible:g,visible:d,tabPanelCodeClass:""})}if(!r.mode||r&&r.mode&&t.isObject(r.mode)&&-1!=t.indexOf(r.mode,l)){var c=r.group||e("General"),p=r.control||a.getMappedControl(r.type,l),u=r.cell||a.getMappedControl(r.type,"cell");if(null==p)return;b[c]=b[c]||[];var w=!(g=!!t.isUndefined(y)||(!!t.isUndefined(r.server_type)||y.type in r.server_type)&&(!!t.isUndefined(r.min_version)||y.version>=r.min_version)&&(!!t.isUndefined(r.max_version)||y.version<=r.max_version))||C,_="properties"==l,x=r.node&&t.isString(r.node)&&r.node in m.Nodes&&m.Nodes[r.node]||o,k=t.extend(t.clone(r),{name:r.id,disabled:!!w||v(r.disabled),readonly:!!_||v(r.readonly),editable:t.isUndefined(r.editable)?f.editableCell:v(r.editable),subnode:t.isString(r.model)&&r.model in m.Nodes?m.Nodes[r.model].model:r.model,canAdd:!w&&!_&&v(r.canAdd),canAddRow:!w&&!_&&v(r.canAddRow),canEdit:!w&&!_&&v(r.canEdit),canDelete:!w&&!_&&v(r.canDelete),canEditRow:!w&&!_&&v(r.canEditRow),canDeleteRow:!w&&!_&&v(r.canDeleteRow),transform:v(r.transform),mode:l,control:p,cell:u,node_info:i,schema_node:x,visible:v(r.visible),node:o,node_data:s,version_compatible:g});delete k.id,b[c].push(k),"nested"==r.type&&(delete k.name,delete k.cell,k.schema=a.generateViewSchema(i,n,l,o,s,!0,r.schema),k.control=k.control||"tab")}})),t.isEmpty(b))return null;r||!o||!o.hasSQL||"create"!=l&&"edit"!=l||(b[e("SQL")]=[{name:"sql",visible:!0,disabled:!1,type:"text",control:"sql-tab",node_info:i,schema_node:o,node_data:s}]),t.each(b,(function(e,i){var n=t.pluck(e,"tabPanelCodeClass");n&&(n=n.join(" ").trim()),u.push(t.extend(t.defaults(h[i]||{label:i,tabPanelCodeClass:n},{version_compatible:!0,visible:!0}),{fields:e}))}))}return u};var y=function(){};t.extend(y.prototype,{fromRaw:function(e){return encodeURIComponent(e)},toRaw:function(e,i,n){return t.isArray(e)?n&&n.tags?e:t.map(e,decodeURIComponent):t.isNull(e)||t.isUndefined(e)?null:decodeURIComponent(e)}}),a.Select2Control=a.SelectControl.extend({defaults:t.extend({},a.SelectControl.prototype.defaults,{select2:{first_empty:!0,multiple:!1,emptyOptions:!1,preserveSelectionOrder:!1,isDropdownParent:!1},controlLabelClassName:a.controlLabelClassName,controlsClassName:a.controlsClassName}),events:function(){return t.extend({},a.SelectControl.prototype.events,{"select2:select":"onSelect"})},onSelect:function(e){var n=this.field.get("select2");if(!t.isUndefined(n)&&!t.isNull(n)&&n.multiple&&n.preserveSelectionOrder){var a=e.params.data.element,l=i(a);l.detach(),i(this.$sel).append(l),i(this.$sel).trigger("change")}var o=t.findWhere(this.field.get("options"),{value:e.params.data.id});o&&!t.isUndefined(o.preview_src)&&o.preview_src&&this.$el.find(".preview-img img").attr("src",o.preview_src)},formatter:y,template:t.template(["<% if(label == false) {} else {%>",'  <label class="<%=controlLabelClassName%>" for="<%=cId%>"><%=label%></label>',"<% }%>",'<div class="<%=controlsClassName%>">',' <select title="<%=name%>" id="<%=cId%>" class="<%=Backform.controlClassName%> <%=extraClasses.join(\' \')%>"','  name="<%=name%>" value="<%-value%>" <%=disabled ? "disabled" : ""%> <%=readonly ? "disabled" : ""%>','  <%=required ? "required" : ""%><%= select2.multiple ? " multiple>" : ">" %>','  <%=select2.first_empty ? " <option></option>" : ""%>',"  <% for (var i=0; i < options.length; i++) {%>","   <% var option = options[i]; %>","   <option ","    <% if (option.image) { %> data-image=<%=option.image%> <%}%>","    value=<%- formatter.fromRaw(option.value) %>",'    <% if (option.selected) {%>selected="selected"<%} else {%>','    <% if (!select2.multiple && option.value === rawValue) {%>selected="selected"<%}%>','    <% if (select2.multiple && rawValue && rawValue.indexOf(option.value) != -1){%>selected="selected" data-index="rawValue.indexOf(option.value)"<%}%>',"    <%}%>",'    <%= disabled ? "disabled" : ""%> <%=readonly ? "disabled" : ""%>><%-option.label%></option>',"  <%}%>"," </select>"," <% if (helpMessage && helpMessage.length) { %>",' <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>'," <% } %>"," <% for (var i=0; i < options.length; i++) {%>","   <% var option = options[i]; %>","     <% if (option.preview_src && option.value === rawValue) { %>",'       <div class="preview-img mt-2">','         <img src="<%=option.preview_src%>" class="img-fluid mx-auto d-block w-50 border" alt="'+e("Preview not available...")+'">',"       </div>","    <%}%>"," <%}%>","</div>"].join("\n")),render:function(){var e=this;this.$sel&&this.$sel.select2&&this.$sel.select2.hasOwnProperty("destroy")&&this.$sel.select2("destroy");var n=t.defaults(this.field.toJSON(),this.defaults),l=this.model.toJSON(),o=n.name.split("."),s=o.shift(),r=o.join("."),d=this.keyPathAccessor(l[s],r),c=t.extend(n,{rawValue:d,value:this.formatter.fromRaw(d,this.model),attributes:l,formatter:this.formatter}),p=function(e,i,n){return t.isFunction(e)?!!e.apply(i,[n]):!!e};if(c.select2=c.select2||{},t.defaults(c.select2,this.defaults.select2,{first_empty:!0,multiple:!1,emptyOptions:!1,preserveSelectionOrder:!1,isDropdownParent:!1,showOnScroll:!0}),t.extend(c,{disabled:p(c.disabled,c,this.model),readonly:p(c.readonly,c,this.model),visible:p(c.visible,c,this.model),required:p(c.required,c,this.model)}),t.isFunction(c.options))try{c.options=c.options(this)}catch(e){c.options=[],this.model.trigger("pgadmin-view:transform:error",this.model,this.field,e)}c.cId=c.cId||t.uniqueId("pgC_"),this.$el.removeClass(a.hiddenClassName),c.visible||this.$el.addClass(a.hiddenClassName),this.$el.html(this.template(c)).addClass(n.name);var h=t.extend({disabled:c.disabled||c.readonly},n.select2,{options:this.field.get("options")||this.defaults.options});return c.select2.isDropdownParent&&(h.dropdownParent=c.select2.dropdownParent||this.$el),(c.disabled||c.readonly)&&(h.placeholder=""),c.select2.tags&&c.select2.emptyOptions&&(h.data=c.rawValue),h=u.default(h),this.$sel=this.$el.find("select").select2(h),c.select2.tags&&c.select2.emptyOptions&&(this.$sel.val(c.rawValue),this.$sel.trigger("change.select2"),this.$sel.on("select2:unselect",(function(e){i(this).find('option[value="'+e.params.data.text.replace("'","\\'").replace('"','\\"')+'"]').remove(),i(this).trigger("change.select2"),null==i(this).val()&&i(this).empty()}))),this.$sel&&this.$sel.data("select2").on("keypress",(function(e){9===e.which&&this.isOpen()&&(e.preventDefault(),this.trigger("results:select",{}))})),c.readonly&&!c.disabled&&setTimeout((function(){e.$el.find(".select2-selection").attr("tabindex",0)}),500),this.updateInvalid(),this},getValueFromDOM:function(){var e=t.extend({},this.field.get("select2")||this.defaults.select2),i=this.formatter.toRaw(this.$sel.val(),this.model,e);return e.multiple&&null==i?[]:i}}),a.FieldsetControl=a.Fieldset.extend({initialize:function(e){a.Control.prototype.initialize.apply(this,arguments),a.Dialog.prototype.initialize.apply(this,[{schema:e.field.get("schema")}]),this.dialog=e.dialog,this.tabIndex=e.tabIndex,this.contentClass=e.field.get("contentClass")?e.field.get("contentClass"):"";var i=this.field.get("deps"),n=this;i&&t.isArray(i)&&t.each(i,(function(e){var t=e.split(".").shift();n.listenTo(n.model,"change:"+t,n.render)}))},orig_render:a.Fieldset.prototype.render,render:function(){var e=t.defaults(this.field.toJSON(),this.defaults),i=function(e,i,n){return t.isFunction(e)?!!e.apply(i,[n]):!!e};return e.version_compatible&&i(e.visible,e,this.model)?this.orig_render.apply(this,arguments):(this.cleanup(),this.$el.empty()),this},formatter:function(){},cleanup:function(){a.Fieldset.prototype.cleanup.apply(this)},remove:function(){a.Control.prototype.remove.apply(this,arguments),a.Dialog.prototype.remove.apply(this,arguments)},className:function(){return"set-group"},tabPanelClassName:function(){return a.tabClassName},fieldsetClass:"inline-fieldset",legendClass:"",collapse:!1}),a.TabControl=a.FieldsetControl.extend({tagName:"div",className:"inline-tab-panel",tabPanelClassName:"inline-tab-panel",tabPanelExtraClasses:"",initialize:function(e){a.FieldsetControl.prototype.initialize.apply(this,arguments),this.tabIndex=(e.tabIndex||parseInt(crypto.getRandomValues(new Uint8Array(1))))+1,e.field.get("tabPanelExtraClasses")&&(this.tabPanelExtraClasses=e.field.get("tabPanelExtraClasses")),this.tabPanelClassName=this.tabPanelClassName+" "+this.tabPanelExtraClasses},orig_render:a.Dialog.prototype.render,template:a.Dialog.prototype.template}),a.PlainFieldsetControl=a.FieldsetControl.extend({initialize:function(){a.FieldsetControl.prototype.initialize.apply(this,arguments)},template:{header:t.template(['<fieldset class="<%=fieldsetClass%>" <%=disabled ? "disabled" : ""%>>'," <% if (legend != false) { %>",'  <div><legend class="<%=legendClass%>" <%=collapse ? "data-toggle=\'collapse\'" : ""%> data-target="#<%=cId%>"><%=collapse ? "<span class=\'caret\'></span>" : "" %></legend></div>'," <% } %>","</fieldset>"].join("\n")),content:t.template('  <div id="<%= cId %>" class="<%=contentClass%>"></div>')},fieldsetClass:"inline-fieldset-without-border",legend:!1}),a.SqlFieldControl=a.TextareaControl.extend({defaults:{label:"",extraClasses:[],helpMessage:null,maxlength:4096,rows:void 0},template:t.template(['<label class="<%=Backform.controlLabelClassName%>" for="<%=cId%>"><%=label%></label>',"<div class=\"<%=Backform.controlsClassName%> sql_field_layout <%=extraClasses.join(' ')%>\">",'  <textarea id="<%=cId%>"','    class="<%=Backform.controlClassName%> " name="<%=name%>" aria-label="<%=name%>"','    maxlength="<%=maxlength%>" placeholder="<%-placeholder%>" <%=disabled ? "disabled" : ""%> <%=readonly ? "readonly aria-readonly=true" : ""%>',"    rows=<%=rows%>",'    <%=required ? "required" : ""%>><%-value%></textarea>',"  <% if (helpMessage && helpMessage.length) { %>",'    <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"  <% } %>","</div>"].join("\n")),initialize:function(){a.TextareaControl.prototype.initialize.apply(this,arguments),this.sqlCtrl=null,t.bindAll(this,"onFocus","onBlur","refreshTextArea")},getValueFromDOM:function(){return this.sqlCtrl.getValue()},reflectPreferences:function(){var e=this;if(e.sqlCtrl){var t=p.default.pgAdmin.Browser.get_preferences_for_module("sqleditor");i(e.sqlCtrl.getWrapperElement()).css("font-size",d.calcFontSize(t.sql_font_size)),e.sqlCtrl.setOption("indentWithTabs",!t.use_spaces),e.sqlCtrl.setOption("indentUnit",t.tab_size),e.sqlCtrl.setOption("tabSize",t.tab_size),e.sqlCtrl.setOption("lineWrapping",t.wrap_code),e.sqlCtrl.setOption("autoCloseBrackets",t.insert_pair_brackets),e.sqlCtrl.setOption("matchBrackets",t.brace_matching),setTimeout((function(){e.sqlCtrl&&e.sqlCtrl.refresh()}),500)}},render:function(){this.sqlCtrl&&(this.model.off("pg-property-tab-changed",this.refreshTextArea,this),this.sqlCtrl.off("focus",this.onFocus),this.sqlCtrl.off("blur",this.onBlur),this.sqlCtrl.toTextArea(),delete this.sqlCtrl,this.sqlCtrl=null,this.$el.empty()),a.TextareaControl.prototype.render.apply(this,arguments);var e=t.defaults(this.field.toJSON(),this.defaults),i=this.model.toJSON(),n=e.name.split("."),l=n.shift(),o=n.join("."),r=this.keyPathAccessor(i[l],o),d=t.extend(e,{rawValue:r,value:this.formatter.fromRaw(r,this.model),attributes:i,formatter:this.formatter}),c=function(e,i,n){return t.isFunction(e)?!!e.apply(i,[n]):!!e};d.cId=d.cId||t.uniqueId("pgC_");var p=c(d.disabled,d,this.model),u=c(d.visible,d,this.model),h=c(d.readonly,d,this.model),g=this;if(g.sqlCtrl=s.fromTextArea(g.$el.find("textarea")[0],{lineNumbers:!0,mode:"text/x-pgsql",extraKeys:f.Browser.editor_shortcut_keys,screenReaderLabel:d.label}),g.reflectPreferences(),m.onPreferencesChange("sqleditor",(function(){g.reflectPreferences()})),p||h){g.sqlCtrl.setOption("readOnly",!0),g.sqlCtrl.setOption("extraKeys",{Tab:!1,"Shift-Tab":!1});var v=g.sqlCtrl.getWrapperElement();v&&(v.className+=" cm_disabled hide-cursor-workaround")}return u||g.$el.addClass(a.hiddenClassName),g.model.on("pg-property-tab-changed",this.refreshTextArea,this),this.sqlCtrl.setOption("dragDrop",!0),this.sqlCtrl.on("focus",this.onFocus),this.sqlCtrl.on("blur",this.onBlur),this.sqlCtrl.on("drop",this.onDrop),setTimeout((function(){g.refreshTextArea.apply(g)}),0),g},onDrop:function(e,t){var i=null;try{i=JSON.parse(t.dataTransfer.getData("text")),t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation()}catch(e){return}var n=e.coordsChar({left:t.x,top:t.y});e.replaceRange(i.text,n),e.focus(),e.setSelection(r(r({},n),{},{ch:n.ch+i.cur.from}),r(r({},n),{},{ch:n.ch+i.cur.to}))},onFocus:function(){var e=this.$el.find(".pgadmin-controls").first();e.hasClass("focused")||e.addClass("focused")},onBlur:function(){this.$el.find(".pgadmin-controls").first().removeClass("focused")},refreshTextArea:function(){this.sqlCtrl&&this.sqlCtrl.refresh()},remove:function(){this.sqlCtrl&&(this.sqlCtrl.off("focus",this.onFocus),this.sqlCtrl.off("blur",this.onBlur),delete this.sqlCtrl,this.sqlCtrl=null,this.$el.empty()),this.model.off("pg-property-tab-changed",this.refreshTextArea,this),a.TextareaControl.prototype.remove.apply(this,arguments)}}),a.SqlCodeControl=a.SqlFieldControl.extend({template:t.template(['<label class="sr-only" for="<%=cId%>"><%=(label==""?"Code":label)%></label>',"<div class=\"pgadmin-controls pg-el-12 <%=extraClasses.join(' ')%>\">",'  <textarea id="<%=cId%>" ','    class="<%=Backform.controlClassName%> " name="<%=name%>" aria-label="<%=name%>"','    maxlength="<%=maxlength%>" placeholder="<%-placeholder%>" <%=disabled ? "disabled" : ""%> <%=readonly ? "readonly aria-readonly=true" : ""%> ',"    rows=<%=rows%>",'    <%=required ? "required" : ""%>><%-value%></textarea>',"  <% if (helpMessage && helpMessage.length) { %>",'    <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"  <% } %>","</div>"].join("\n"))}),a.NoteControl=a.Control.extend({defaults:{label:e("Note"),text:"",extraClasses:["pg-el-12","d-flex"],noteClass:"backform-note",faIcon:"fa-file-alt",faExtraClass:"fa-rotate-180 fa-flip-vertical",iconWidthClass:"col-0 pr-2",textWidthClass:"col-sm"},template:t.template(["<div class=\"<%=noteClass%> <%=extraClasses.join(' ')%>\">",'  <div class="icon <%=iconWidthClass%>">','    <i class="fa <%=faIcon%> <%=faExtraClass%>" aria-hidden="true"></i>',"  </div>",'  <div class="<%=textWidthClass%>">',"    <span><%=text%></span>","  </div>","</div>"].join("\n"))}),a.DatetimepickerControl=a.InputControl.extend({defaults:{type:"text",label:"",options:{format:"YYYY-MM-DD HH:mm:ss Z",icons:{time:"fa fa-clock",data:"fa fa-calendar-alt",today:"fa fa-calendar-check",clear:"fa fa-trash-alt"},buttons:{showToday:!0},toolbarPlacement:"top",widgetPositioning:{horizontal:"auto",vertical:"bottom"},keepOpen:!1},placeholder:"YYYY-MM-DD HH:mm:ss Z",extraClasses:[],helpMessage:null,setMinDate:!0},events:{"blur input":"onChange","change input":"onChange","changeDate input":"onChange","focus input":"clearInvalid","focusout input":"closePicker","change.datetimepicker":"onChange","click .input-group":"togglePicker","keydown .datetimepicker-input":"keyboardEvent"},togglePicker:function(){this.has_datepicker&&this.$el.find("input").datetimepicker("toggle")},closePicker:function(){this.has_datepicker&&this.$el.find("input").datetimepicker("hide")},template:t.template(['<label for="<%=cId%>" class="<%=Backform.controlLabelClassName%>"><%=label%></label>','<div class="input-group  <%=Backform.controlsClassName%>">',' <input id="<%=cId%>" type="text" class="<%=Backform.controlClassName%> datetimepicker-input <%=extraClasses.join(\' \')%>" name="<%=name%>" value="<%-value%>" placeholder="<%-placeholder%>" <%=disabled ? "disabled" : ""%> <%=readonly ? "readonly aria-readonly=true" : ""%> <%=required ? "required" : ""%> data-toggle="datetimepicker"/>',' <div class="input-group-append">','   <span class="input-group-text fa fa-calendar-alt"></span>'," </div>","</div>","<% if (helpMessage && helpMessage.length) { %>",'<div class="<%=Backform.helpBlockControlClass%>">',' <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"</div>","<% } %>"].join("\n")),keyboardEvent:function(e){var t=!1;e.altKey||38!=e.keyCode||this.up(),e.altKey||40!=e.keyCode||this.down(),37==e.keyCode&&this.left(),39==e.keyCode&&this.right(),27==e.keyCode&&(this.$el.find("input").datetimepicker("hide"),t=!0),13==e.keyCode&&(this.$el.find(".datepicker").is(":visible")||this.$el.find(".timepicker").is(":visible")?this.$el.find("input").datetimepicker("hide"):this.$el.find("input").datetimepicker("show")),e.altKey&&84==e.keyCode&&this.timePicker(),e.altKey&&38==e.keyCode&&this.controlUp(),e.altKey&&40==e.keyCode&&this.controlDown(),t&&e.stopImmediatePropagation()},down:function(){var e=this.$el.find(".datetimepicker-input"),t=e.data("datetimepicker").date().clone();this.$el.find(".datepicker").is(":visible")?e.datetimepicker("date",t.add(7,"d")):e.datetimepicker("date",t.subtract(1,"m"))},up:function(){var e=this.$el.find(".datetimepicker-input"),t=e.data("datetimepicker").date().clone();this.$el.find(".datepicker").is(":visible")?e.datetimepicker("date",t.subtract(7,"d")):e.datetimepicker("date",t.add(1,"m"))},left:function(){var e=this.$el.find(".datetimepicker-input"),t=e.data("datetimepicker").date().clone();this.$el.find(".datepicker").is(":visible")&&e.datetimepicker("date",t.subtract(1,"d"))},right:function(){var e=this.$el.find(".datetimepicker-input"),t=e.data("datetimepicker").date().clone();this.$el.find(".datepicker").is(":visible")&&e.datetimepicker("date",t.add(1,"d"))},timePicker:function(){this.$el.find(".timepicker").is(":visible")?this.$el.find(".fa-calendar-alt").click():this.$el.find(".fa-clock").click()},controlUp:function(){this.$el.find(".fa-clock").click();var e=this.$el.find(".datetimepicker-input"),t=e.data("datetimepicker").date().clone();e.datetimepicker("date",t.add(1,"h"))},controlDown:function(){this.$el.find(".fa-clock").click();var e=this.$el.find(".datetimepicker-input"),t=e.data("datetimepicker").date().clone();e.datetimepicker("date",t.subtract(1,"h"))},render:function(){var e=t.defaults(this.field.toJSON(),this.defaults),i=this.model.toJSON(),n=e.name.split("."),l=n.shift(),o=n.join("."),s=this.keyPathAccessor(i[l],o),r=t.extend(e,{rawValue:s,value:this.formatter.fromRaw(s,this.model),attributes:i,formatter:this.formatter}),d=function(e,i){return t.isFunction(e)?!!e(i):!!e};if("properties"==r.mode&&(r.disabled=!0),t.extend(r,{disabled:d(r.disabled,this.model),readonly:d(r.readonly,this.model),visible:d(r.visible,this.model),required:d(r.required,this.model)}),r.cId=r.cId||t.uniqueId("pgC_"),r.disabled||"properties"==r.mode||(r.placeholder=r.placeholder||this.defaults.placeholder),this.has_datepicker&&this.$el.find("input").datetimepicker("destroy"),this.$el.empty(),this.$el.removeClass(a.hiddenClassName),this.$el.html(this.template(r)).addClass(e.name),r.visible){this.has_datepicker=!0;var c=this;t.isUndefined(r.value)||t.isNull(r.value)||"infinity"!==r.value.toLowerCase()||(r.value=null);var p={};p=r.setMinDate?{date:r.value,minDate:r.value}:{date:r.value},this.$el.find("input").first().datetimepicker(t.extend({keyBinds:{enter:function(e){var t=this;e?setTimeout((function(){t.toggle(),c.$el.find("input").first().trigger("blur")}),10):setTimeout((function(){t.toggle()}),10)},tab:function(e){e||setTimeout((function(){c.$el.find("input").first().trigger("blur")}),10)},escape:function(e){if(e){var t=this;setTimeout((function(){t.toggle(),c.$el.find("input").first().trigger("blur")}),10)}}}},this.defaults.options,this.field.get("options"),p))}else this.has_datepicker=!1,this.$el.addClass(a.hiddenClassName);return this.updateInvalid(),this},clearInvalid:function(){return a.InputControl.prototype.clearInvalid.apply(this,arguments),this.$el.removeClass("pgadmin-datepicker-has-error"),this},updateInvalid:function(){a.InputControl.prototype.updateInvalid.apply(this,arguments),this.$el.addClass("pgadmin-datepicker-has-error")},cleanup:function(){this.has_datepicker&&this.$el.find("input").datetimepicker("destroy"),this.$el.empty()}}),a.ColorControl=a.InputControl.extend({defaults:{label:"",extraClasses:[],helpMessage:null,showPalette:!0,allowEmpty:!0,colorFormat:"HEX",defaultColor:null,position:"right-middle",clearText:e("No color")},template:t.template(['<label class="<%=Backform.controlLabelClassName%>" for="<%=cId%>"><%=label%></label>','<div class="<%=Backform.controlsClassName%>">','  <input id="<%=cId%>" class="<%=Backform.controlClassName%> <%=extraClasses.join(\' \')%> d-none" name="<%=name%>" value="<%-value%>" <%=disabled ? "disabled" : ""%> <%=required ? "required" : ""%> />',"  <p></p>","  <% if (helpMessage && helpMessage.length) { %>",'    <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"  <% } %>","</div>"].join("\n")),applyColor:function(e,t,i){i?(t.applyColor(!0),this.model.set(e,t.getSelectedColor().toHEXA().toString(),{silent:!0})):this.model.set(e,"",{silent:!0})},render:function(){var e=this;this.picker&&(this.picker.destroyAndRemove(),this.picker=null);var i=t.defaults(this.field.toJSON(),this.defaults),n=this.model.toJSON(),l=i.name.split("."),o=l.shift(),s=l.join("."),r=this.keyPathAccessor(n[o],s),d=t.extend(i,{rawValue:r,value:this.formatter.fromRaw(r,this.model),attributes:n,formatter:this.formatter}),c=function(e,i,n){return t.isFunction(e)?!!e.apply(i,[n]):!!e};return t.extend(d,{disabled:c(d.disabled,d,this.model),visible:c(d.visible,d,this.model),required:c(d.required,d,this.model)}),d.cId=d.cId||t.uniqueId("pgC_"),this.$el.empty(),d.visible||this.$el.addClass(a.hiddenClassname),this.$el.html(this.template(d)).addClass(i.name),d.colorFormat=d.colorFormat?d.colorFormat.toUpperCase():"HEX",d.value=d.value&&""!=d.value?d.value:d.defaultColor,this.picker=new h({el:this.$el.find("p")[0],theme:"monolith",swatches:["#000","#666","#ccc","#fff","#f90","#ff0","#0f0","#f0f","#f4cccc","#fce5cd","#d0e0e3","#cfe2f3","#ead1dc","#ea9999","#b6d7a8","#a2c4c9","#d5a6bd","#e06666","#93c47d","#76a5af","#c27ba0","#f1c232","#6aa84f","#45818e","#a64d79","#bf9000","#0c343d","#4c1130"],position:d.position,strings:{clear:d.clearText},components:{palette:d.showPalette,preview:!0,hue:d.showPalette,interaction:{clear:d.allowEmpty,defaultRepresentation:d.colorFormat,disabled:d.disabled}}}),this.picker.on("init",(function(t){e.picker.setColor(d.value,!0),d.disabled&&e.picker.disable();var i=t.getRoot().preview.lastColor,n=t.getRoot().interaction.clear;n.addEventListener("keydown",(function(e){9===e.keyCode&&(e.preventDefault(),e.stopPropagation(),i.focus())})),i.addEventListener("keydown",(function(e){9===e.keyCode&&e.shiftKey&&(e.preventDefault(),e.stopPropagation(),n.focus())}))})).on("clear",(function(t){e.applyColor(o,t,null)})).on("change",(function(t,i,n){e.applyColor(o,n,t)})).on("show",(function(e,t){t.getRoot().palette.palette.focus()})).on("hide",(function(e){e.getRoot().button.focus()})),this.updateInvalid(),this}});var C=a.KeyCodeControlFormatter=function(){};return t.extend(C.prototype,{fromRaw:function(e){return e.char},toRaw:void 0}),a.KeyCodeControl=a.InputControl.extend({defaults:t.defaults({escapeKeyCodes:[16,17,18,27]},a.InputControl.prototype.defaults),events:{"keydown input":"onkeyDown","keyup input":"preventEvent","focus select":"clearInvalid"},formatter:C,preventEvent:function(e){var i=e.which||e.keyCode;-1==t.defaults(this.field.toJSON(),this.defaults).escapeKeyCodes.indexOf(i)&&(e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation())},template:t.template(['<label class="<%=Backform.controlLabelClassName%> keyboard-shortcut-label"><%=label%></label>','<div class="<%=Backform.controlsClassName%>">','  <input aria-label="<%=name%>" type="<%=type%>" class="<%=Backform.controlClassName%> <%=extraClasses.join(\' \')%>" name="<%=name%>" oncopy="return false; oncut="return false; onpaste="return false;" maxlength="<%=maxlength%>" value="<%-value%>" placeholder="<%-placeholder%>" <%=disabled ? "disabled" : ""%> <%=required ? "required" : ""%> />',"  <% if (helpMessage && helpMessage.length) { %>",'    <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"  <% } %>","</div>"].join("\n")),onkeyDown:function(i){var a,l,o=this,s=this.model,r=this.field.get("name").split(".").shift(),d=i.which||i.keyCode;-1==t.defaults(this.field.toJSON(),this.defaults).escapeKeyCodes.indexOf(d)&&(this.model.errorModel instanceof n.Model&&this.model.errorModel.unset(r),l=e(i.key),32==d&&(l=e("Space")),a={key_code:i.which||i.keyCode,char:l},this.stopListening(this.model,"change:"+r,this.render),s.set(r,a),this.listenTo(this.model,"change:"+r,this.render),setTimeout((function(){o.$el.find("input").val(l)})),i.preventDefault())},keyPathAccessor:function(e,i){var n,a=e,o=l(i=i.split("."));try{for(o.s();!(n=o.n()).done;){var s=n.value;if(t.isNull(a))return null;t.isEmpty(s)||(t.isUndefined(a[s])||(a=a[s]))}}catch(e){o.e(e)}finally{o.f()}return a}}),a.KeyboardShortcutControl=a.Control.extend({initialize:function(){a.Control.prototype.initialize.apply(this,arguments);var e=this.field.get("fields");if(!e)throw new ReferenceError('"fields" not found in keyboard shortcut');this.innerModel=new n.Model,this.controls=[]},cleanup:function(){this.stopListening(this.innerModel,"change",this.onInnerModelChange),t.each(this.controls,(function(e){e.remove()})),this.controls.length=0},template:t.template(['<label class="<%=Backform.controlLabelClassName%>"><%=label%></label>','<div class="<%=Backform.controlsClassName%> d-flex flex-row">',"</div>"].join("\n")),onInnerModelChange:function(){var e=this.field.get("name"),t=i.extend(!0,{},this.model.get(e));this.stopListening(this.model,"change:"+e,this.render),this.model.set(e,i.extend(!0,t,this.innerModel.toJSON())),this.listenTo(this.model,"change:"+e,this.render)},render:function(){this.cleanup(),this.$el.empty();var e=this,n={},l=t.defaults(this.field.toJSON(),this.defaults),o=e.model.get(l.name),s=l.fields;this.$el.html(e.template(l)).addClass(l.name);var r=i(e.$el.find(".pgadmin-controls"));return t.each(s,(function(e){n[e.name]=o[e.name]})),e.innerModel.set(n),e.listenTo(e.innerModel,"change",e.onInnerModelChange),t.each(s,(function(n){var l=new a.Field(t.extend({},{id:n.name,name:n.name,control:"checkbox"==n.type?"checkboxWithBox":n.type,label:n.label})),o=new(l.get("control"))({field:l,model:e.innerModel});(o.render(),"checkbox"==n.type)?(o.$el.find("label.control-label").text().trim().length<=0&&o.$el.find("label.control-label").remove(),"alt"==n.name?r.append(i('<div class="pg-el-sm-3 pg-el-12"></div>').append(o.$el)):r.append(i('<div class="pg-el-sm-2 pg-el-12"></div>').append(o.$el))):r.append(i('<div class="pg-el-sm-5 pg-el-12"></div>').append(o.$el));e.controls.push(o)})),e},remove:function(){this.cleanup(),a.Control.prototype.remove.apply(this,arguments)}}),a.CheckboxWithBoxControl=a.CheckboxControl.extend({events:t.extend({},a.CheckboxControl.prototype.events,{"click button":"onButtonClick"}),template:t.template(['<label class="<%=Backform.controlLabelClassName%>"><%=controlLabel%></label>','<div class="<%=Backform.controlContainerClassName%>">','  <button class="btn btn-secondary btn-checkbox">',"  <div class=\"custom-control custom-checkbox <%=extraClasses.join(' ')%>\">",'    <input tabindex="-1" type="checkbox" class="custom-control-input" id="<%=cId%>" name="<%=name%>" <%=value ? "checked=\'checked\'" : ""%> <%=disabled ? "disabled" : ""%> <%=required ? "required" : ""%> />','    <label class="custom-control-label" for="<%=cId%>" aria-label="<%=cId%>">',"      <%=label%>","    </label>","  </div>","  </button>","</div>"].join("\n")),onButtonClick:function(e){"BUTTON"===e.target.nodeName&&this.$el.find("input[type=checkbox]").trigger("click")}}),a.ThresholdControl=a.Control.extend({template:t.template(['<label class="<%=Backform.controlLabelClassName%>"><%=label%></label>','<div class="<%=Backform.controlContainerClassName%>">','  <span class="control-label pg-el-sm-2 pg-el-12"><%=warning_label%></span>','  <input type="text" id="warning_threshold" class="pg-el-sm-2" value="<%=warning_value%>" />','  <span class="control-label pg-el-sm-1 pg-el-12"><%=alert_label%></span>','  <input type="text" id="alert_threshold" class="pg-el-sm-2" value="<%=alert_value%>" />','  <span class="control-label pg-el-sm-3 pg-el-12"><%=unit%></span>',"  <% if (helpMessage && helpMessage.length) { %>",'    <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"  <% } %>","</div>"].join("\n")),events:{"change input#warning_threshold":"onChange","change input#alert_threshold":"onChange"},initialize:function(){a.Control.prototype.initialize.apply(this,arguments)},render:function(){var e=t.defaults(this.field.toJSON(),this.defaults),i=this.model.toJSON(),n=[];t.isUndefined(this.model.get("value"))||t.isNull(this.model.get("value"))||(n=this.model.get("value").split("|"));var a=t.extend(e,{attributes:i,warning_value:n.length>0?n[0]:"",alert_value:n.length>1?n[1]:""});return this.$el.html(this.template(a)),this},onChange:function(){var e=i("input#warning_threshold").val()+"|"+i("input#alert_threshold").val();this.model.set(this.field.get("name"),e,{silent:!1})}}),a}.apply(t,n))||(e.exports=a)},71158:(e,t,i)=>{var n,a,l=i(19755);i(47042),i(91038),i(78783),i(82526),i(41817),i(32165),i(79753),i(73210),i(15306),i(74916),i(2707),i(82772),i(32564),i(69600),i(69826),i(24812),i(92222),i(5735),i(83753),i(41539),i(91058),i(54678),i(23123),i(89554),i(54747),i(56977),i(21249),i(66992),i(33948),i(68309),i(64765);var o,s=(o=i(55958))&&o.__esModule?o:{default:o};function r(e,t){var i;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(i=function(e,t){if(!e)return;if("string"==typeof e)return d(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return d(e,t)}(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,o=!0,s=!1;return{s:function(){i=e[Symbol.iterator]()},n:function(){var e=i.next();return o=e.done,e},e:function(e){s=!0,l=e},f:function(){try{o||null==i.return||i.return()}finally{if(s)throw l}}}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}n=[i(91669),i(66419),i(19755),i(72316),i(95283),i(83879),i(58307),i(30381),i(44431),i(4631),i(44092),i(72945),i(75471),i(1950),i(75084),i(63790),i(56796)],a=function(e,t,i,n,a,o,d,c,p,u,h,f,m,g){var v=(window.pgAdmin=window.pgAdmin||{}).Browser;t.extend(o.Column.prototype.defaults,{cellFunction:void 0}),t.extend(o.Cell.prototype.events,{mouseover:function(){var e=i(this.el);e.text().length>0&&!e.attr("title")&&e.innerWidth()+1<e[0].scrollWidth&&e.attr("title",i.trim(e.text()))}}),t.extend(o.InputCellEditor.prototype.events,{keydown:function(e){var t=g.default.pgAdmin.Browser.get_preferences_for_module("browser");t&&f.validateShortcutKeys(t.add_grid_row,e)?v.keyboardNavigation.bindAddGridRow():o.InputCellEditor.prototype.saveOrCancel.apply(this,arguments)}}),t.extend(o.Body.prototype,{sort:function(e,i){if(!t.contains(["ascending","descending",null],i))throw new RangeError('direction must be one of "ascending", "descending" or `null`');t.isString(e)&&(e=this.columns.findWhere({name:e}));var a,l=this.collection;a="ascending"===i?-1:"descending"===i?1:null;var o=e.get("cell").prototype.className||"string-cell",s=this.makeComparator(e.get("name"),a,a?e.sortValue():function(e){return 1*e.cid.replace("c","")},o);return n.PageableCollection&&l instanceof n.PageableCollection?(l.setSorting(a&&e.get("name"),a,{sortValue:e.sortValue()}),l.fullCollection?(null==l.fullCollection.comparator&&(l.fullCollection.comparator=s),l.fullCollection.sort(),l.trigger("backgrid:sorted",e,i,l)):l.fetch({reset:!0,success:function(){l.trigger("backgrid:sorted",e,i,l)}})):(l.comparator=s,l.sort(),l.trigger("backgrid:sorted",e,i,l)),e.set("direction",i),this},makeComparator:function(e,i,n,a){return function(l,o){var s,r=n(l,e),d=n(o,e);if(!t.isUndefined(r)&&!t.isUndefined(d)){if(t.include(["number-cell","integer-cell"],a)){var c,u;try{c=new p(r)}catch(e){c=NaN}try{u=new p(d)}catch(e){u=NaN}return 1===i&&(s=c,c=u,u=s),c.eq(u)?0:c.lt(u)?-1:1}return 1===i&&(s=r,r=d,d=s),r===d?0:null===r&&null!=d?-1:null!=r&&null===d?1:r<d?-1:1}}},moveToNextCell:function(e,t,n){var a,l,s,r,d,c=this.collection.indexOf(e),p=this.columns.indexOf(t);if(-1===p)return this;if(this.rows[c].cells[p].exitEditMode(),n.moveUp()||n.moveDown()||n.moveLeft()||n.moveRight()||n.save()){var u=this.columns.length,h=u*this.collection.length;if(n.moveUp()||n.moveDown()){r=c+(n.moveUp()?-1:1);var f=this.rows[r];f?(a=f.cells[p],o.callByNeed(a.column.editable(),a.column,e)&&(a.enterEditMode(),e.trigger("backgrid:next",r,p,!1))):e.trigger("backgrid:next",r,p,!0)}else if(n.moveLeft()||n.moveRight()){for(var m=n.moveRight(),g=c*u+p+(m?1:-1);g>=0&&g<h;m?g++:g--){if(d=g-(r=~~(g/u))*u,a=this.rows[r].cells[d],l=o.callByNeed(a.column.renderable(),a.column,a.model),s=o.callByNeed(a.column.editable(),a.column,e),a&&a.$el.hasClass("edit-cell")&&!a.$el.hasClass("privileges")||a.$el.hasClass("delete-cell")){e.trigger("backgrid:next",r,d,!1),a.$el.hasClass("delete-cell")&&setTimeout((function(){i(a.$el).trigger("focus")}),50);break}if(l&&s){a.enterEditMode(),e.trigger("backgrid:next",r,d,!1);break}}g==h&&e.trigger("backgrid:next",~~(g/u),g-r*u,!0)}}return this}}),t.extend(o.Row.prototype,{makeCell:function(e){return new(this.getCell(e))({column:e,model:this.model})},getCell:function(e){var i=e.get("cellFunction");if(!t.isFunction(i))return e.get("cell");var n=i.apply(e,[this.model]);try{return o.resolveNameToClass(n,"Cell")}catch(t){if(t instanceof ReferenceError)return e.get("cell");throw t}}});var b=o.Extension.ObjectCellEditor=o.CellEditor.extend({modalTemplate:t.template(['<div class="subnode-dialog" tabindex="0">','    <div class="subnode-body"></div>',"</div>"].join("\n")),stringTemplate:t.template(['<div class="form-group">','  <label class="control-label col-sm-4"><%=label%></label>','  <div class="col-sm-8">','    <input type="text" class="form-control" name="<%=name%>" value="<%=value%>" placeholder="<%=placeholder%>" />',"  </div>","</div>"].join("\n")),extendWithOptions:function(e){t.extend(this,e)},render:function(){return this},postRender:function(e,n){var l=this.columns_length,o=this.schema.length?this.schema:this.column.get("schema");if(null!=n&&n.get("name")!=this.column.get("name"))return!1;if(!t.isArray(o))throw new TypeError("schema must be an array");var s=this.createDialog(l),r=i('<form class="form-dialog"></form>');s.find("div.subnode-body").append(r);var d=s.find("form.form-dialog");return this.objectView=new a.Dialog({el:d,model:this.model,schema:o,tabPanelClassName:function(){return"sub-node-form col-sm-12"},events:{keydown:function(e){var t=g.default.pgAdmin.Browser.get_preferences_for_module("browser");t&&f.validateShortcutKeys(t.add_grid_row,e)&&v.keyboardNavigation.bindAddGridRow()}}}),this.objectView.render(),this},createDialog:function(e){e=e||1;var t=this.$dialog=i(this.modalTemplate({title:""})),n=i('<tr class="nohover editor-row">'),a=i("<td>",{class:"editable sortable renderable",style:"height: auto",colspan:e+2}).appendTo(n);return this.tr=n,a.append(t.css("display","block")),this.el.parent("tr").after(n),t},save:function(){return this.model.trigger("backgrid:edited",this.model,this.column,new o.Command({keyCode:13})),this.tr&&this.tr.remove(),this},remove:function(){return this.objectView.remove(),o.CellEditor.prototype.remove.apply(this,arguments),this.tr&&this.tr.remove(),this}});o.Extension.PGSelectCell=o.SelectCell.extend({optionValues:function(){var e=[],i=t.result(this.column.attributes,"options");return t.each(i,(function(t){e.push([t.label,t.value])})),e}}),o.Extension.ObjectCell=o.Cell.extend({editorOptionDefaults:{schema:[]},className:"edit-cell",editor:b,initialize:function(e){o.Cell.prototype.initialize.apply(this,arguments);var n=this,a={};t.each(this.editorOptionDefaults,(function(t,i){n[i]||(n[i]=t),e&&e[i]&&(n[i]=e[i]),a[i]=n[i]})),a.el=i(this.el),a.columns_length=this.column.collection.length,a.el.attr("tabindex",0),this.listenTo(this.model,"backgrid:edit",(function(e,t,i,n){t.get("name")==this.column.get("name")&&n.extendWithOptions(a)})),this.$el.on("keydown",(function(e){32==e.keyCode&&i(this).click()}))},enterEditMode:function(){var n=!(!t.isUndefined(this.column.get("canEditRow"))&&t.isFunction(this.column.get("canEditRow")))||o.callByNeed(this.column.get("canEditRow"),this.column,this.model);if(n){this.model.trigger("enteringEditMode",[this]),o.Cell.prototype.enterEditMode.apply(this,arguments),this.delegateEvents();var a=o.callByNeed(this.column.editable(),this.column,this.model);if(a){this.$el.html("<i class='fa fa-pen-square subnode-edit-in-process' title='"+e("Edit row")+"' aria-label='"+e("Edit row")+"'></i>");var l=i(this.$el).parents()[1],r=i(l).find(".tab-content:first > .tab-pane.active:first");h.findAndSetFocus(r),v.keyboardNavigation.getDialogTabNavigator(i(l).find(".subnode-dialog")),this.model.trigger("pg-sub-node:opened",this.model,this)}}else s.default.alert(e("Edit object"),e("This object is not user editable."))},render:function(){return this.$el.empty(),this.$el.html("<i class='fa fa-edit' title='"+e("Edit row")+"' aria-label='"+e("Edit row")+"'></i>"),this.delegateEvents(),this.grabFocus&&this.$el.trigger("focus"),this},exitEditMode:function(){if(!t.isUndefined(this.currentEditor)||!t.isEmpty(this.currentEditor)){var e=i(this.currentEditor.objectView.el).find('.nav-tabs > .active > a[data-toggle="tab"]').first().data("tabIndex");o.Cell.prototype.exitEditMode.apply(this,arguments),this.model.trigger("pg-sub-node:closed",this,e),this.grabFocus=!0}},events:{click:function(e){this.$el.find("i").first().hasClass("subnode-edit-in-process")?(this.undelegateEvents(),this.currentEditor.save()):this.enterEditMode.call(this,[]),e.preventDefault()},keydown:function(e){var t=this.model,i=this.column,n=new o.Command(e);n.moveLeft()&&setTimeout((function(){t.trigger("backgrid:edited",t,i,n)}),20)}}}),o.Extension.DeleteCell=o.Cell.extend({defaults:t.defaults({defaultDeleteMsg:e("Are you sure you wish to delete this row?"),defaultDeleteTitle:e("Delete Row")},o.Cell.prototype.defaults),className:"delete-cell",events:{click:"deleteRow"},deleteRow:function(n){n.preventDefault();var a=this;if(!(!t.isUndefined(this.column.get("canDeleteRow"))&&t.isFunction(this.column.get("canDeleteRow")))||o.callByNeed(this.column.get("canDeleteRow"),this.column,this.model)){var l=t.isUndefined(this.column.get("customDeleteMsg"))?a.defaults.defaultDeleteMsg:this.column.get("customDeleteMsg"),r=t.isUndefined(this.column.get("customDeleteTitle"))?a.defaults.defaultDeleteTitle:this.column.get("customDeleteTitle");s.default.confirm(r,l,(function(){var e=i(a.el).parents("tbody").eq(0);a.model.collection.remove(a.model);var t=i(e).find("tr");t.length>0?t.first().children()[0].focus():i(e).parents(".subnode").eq(0).find(".add").focus()}),(function(){return!0}))}else s.default.alert(e("Delete object"),e("This object cannot be deleted."))},exitEditMode:function(){this.$el.removeClass("editor")},initialize:function(){o.Cell.prototype.initialize.apply(this,arguments)},render:function(){var t=this;return this.$el.empty(),i(this.$el).attr("tabindex",0),this.$el.html('<i aria-label="'+e("Delete row")+"\" class='fa fa-trash-alt' title='"+e("Delete row")+"'></i>"),this.$el.on("keydown",(function(e){var i;if(32==e.keyCode&&t.$el.click(),9!=e.keyCode&&16!=e.keyCode||(i=e.shiftKey?t.$el.prev():t.$el.next()),i){var n=new o.Command({key:"Tab",keyCode:9,which:9,shiftKey:e.shiftKey});setTimeout((function(){i.hasClass("editable")?(e.preventDefault(),e.stopPropagation(),t.model.trigger("backgrid:edited",t.model,t.column,n)):t.model.trigger("backgrid:edited",t.model,t.column,n)}),20)}})),this.delegateEvents(),this}}),o.Extension.ClearCell=o.Cell.extend({defaults:t.defaults({defaultClearMsg:e("Are you sure you wish to clear this row?"),defaultClearTitle:e("Clear Row")},o.Cell.prototype.defaults),className:"clear-cell",events:{click:"clearRow"},clearRow:function(e){if(e.preventDefault(),t.isEmpty(e.currentTarget.innerHTML))return!1;var i=this,n=t.isUndefined(this.column.get("customClearMsg"))?i.defaults.defaultClearMsg:this.column.get("customClearMsg"),a=t.isUndefined(this.column.get("customClearTitle"))?i.defaults.defaultClearTitle:this.column.get("customClearTitle");s.default.confirm(a,n,(function(){i.model.set("name",null),i.model.set("sql",null)}),(function(){return!0}))},exitEditMode:function(){this.$el.removeClass("editor")},initialize:function(){o.Cell.prototype.initialize.apply(this,arguments)},render:function(){var t=this;return this.$el.empty(),i(this.$el).attr("tabindex",0),null!==this.model.get("name")&&null!==this.model.get("sql")&&this.$el.html('<i aria-label="'+e("Clear row")+"\" class='fa fa-eraser' title='"+e("Clear row")+"'></i>"),this.$el.on("keydown",(function(e){var i;if(32==e.keyCode&&t.$el.click(),9!=e.keyCode&&16!=e.keyCode||(i=e.shiftKey?t.$el.prev():t.$el.next()),i){var n=new o.Command({key:"Tab",keyCode:9,which:9,shiftKey:e.shiftKey});setTimeout((function(){i.hasClass("editable")?(e.preventDefault(),e.stopPropagation(),t.model.trigger("backgrid:edited",t.model,t.column,n)):t.model.trigger("backgrid:edited",t.model,t.column,n)}),20)}})),this.delegateEvents(),this}}),o.Extension.CustomHeaderCell=o.HeaderCell.extend({initialize:function(){o.HeaderCell.prototype.initialize.apply(this,arguments);var e=this.column.get("cellHeaderClasses"),t=this.column.get("cellAriaLabel");e&&this.$el.addClass(e),t&&this.$el.attr("aria-label",t)},render:function(){if(o.HeaderCell.prototype.render.apply(this,arguments),""==this.column.get("label")||!this.column.get("label")){var e=this.column.get("cellAriaLabel");e&&this.$el.append('<span class="sr-only">'.concat(e,"</span>"))}return this}}),l&&l.fn.bootstrapToggle&&(i.fn.bootstrapToggle=l.fn.bootstrapToggle),o.Extension.SwitchCell=o.BooleanCell.extend({defaults:{options:t.defaults({onText:e("Yes"),offText:e("No"),onColor:"success",offColor:"ternary",size:"mini",width:null,height:null},i.fn.bootstrapToggle.defaults)},className:"switch-cell",initialize:function(){o.BooleanCell.prototype.initialize.apply(this,arguments),this.onChange=this.onChange.bind(this)},enterEditMode:function(){this.$el.addClass("editor"),i(this.$el.find(".toggle.btn")).trigger("focus")},exitEditMode:function(){this.$el.removeClass("editor")},events:{"change input":"onChange","blur input":"exitEditMode",keydown:"onKeyDown"},onKeyDown:function(e){var t=g.default.pgAdmin.Browser.get_preferences_for_module("browser");f.validateShortcutKeys(t.add_grid_row,e)&&v.keyboardNavigation.bindAddGridRow()},onChange:function(){var e=this.model,t=this.column,i=this.formatter.toRaw(this.$input.prop("checked"),e);this.enterEditMode(),e.set(t.get("name"),i),this.setSrValue()},setSrValue:function(){var i=t.defaults({},this.column.get("options"),this.defaults.options),n=i.onText,a=i.offText;this.$el.find(".toggle.btn").hasClass("off")?this.$el.find(".sr-value").text("\n          ".concat(a,", ").concat(e("Toggle button"),"\n        ")):this.$el.find(".sr-value").text("\n          ".concat(n,", ").concat(e("Toggle button"),"\n        "))},render:function(){var e=this,n=t.defaults(this.column.toJSON(),this.defaults),a=this.model,l=this.column,s=this.formatter.fromRaw(a.get(l.get("name")),a),r=o.callByNeed(n.editable,l,a),d=t.defaults({},n.options,this.defaults.options),c=t.uniqueId("pgC_");return this.undelegateEvents(),this.$el.empty(),this.$el.append('<label class="sr-value sr-only" for="'+c+'"></label>'),this.$el.append(i("<input>",{tabIndex:-1,type:"checkbox","aria-hidden":"true","aria-label":l.get("name")}).prop("checked",s).prop("disabled",!r).attr("data-toggle","toggle").attr("data-size",d.size).attr("data-on",d.onText).attr("data-off",d.offText).attr("data-width",d.width).attr("data-height",d.height).attr("data-onstyle",d.onColor).attr("data-offstyle",d.offColor)),this.$input=this.$el.find("input[type=checkbox]").first(),this.$input.bootstrapToggle(),this.$el.find(".toggle.btn").attr("tabindex",r?"0":"-1").attr("id",c).on("keydown",(function(t){32==t.keyCode&&(e.$el.find("input[type=checkbox]").bootstrapToggle("toggle"),t.preventDefault(),t.stopPropagation(),e.setSrValue())})),this.$el.find(".toggle.btn .toggle-group .btn").attr("aria-hidden",!0),this.setSrValue(),this.$el.on("keydown",(function(t){var i;if(9==t.keyCode&&(i=t.shiftKey?e.$el.prev():e.$el.next()),i&&i.length>0){i.hasClass("editable")&&(t.preventDefault(),t.stopPropagation());var n=new o.Command({key:"Tab",keyCode:9,which:9,shiftKey:t.shiftKey});setTimeout((function(){i.hasClass("editable")&&i.hasClass("edit-cell")?i.trigger("focus"):i.hasClass("editable")?(setTimeout((function(){e.model.trigger("backgrid:edited",e.model,e.column,n)}),10),i.trigger("focus")):setTimeout((function(){e.model.trigger("backgrid:edited",e.model,e.column,n)}),10)}),20)}})),this.delegateEvents(),this}}),o.Extension.Select2Cell=o.SelectCell.extend({className:"select2-cell",editor:null,defaults:t.defaults({select2:{},opt:{label:null,value:null,selected:!1}},o.SelectCell.prototype.defaults),enterEditMode:function(){this.$el.hasClass("editor")||this.$el.addClass("editor"),this.$select.select2("focus"),this.$select.select2("open"),this.$select.on("blur",this.exitEditMode)},exitEditMode:function(){this.$select.off("blur",this.exitEditMode),this.$select.select2("close"),this.$el.removeClass("editor"),this.$el.find(".select2-selection").trigger("focus")},saveOrCancel:function(e){var t,i=this,n=new o.Command(e),a="blur"===e.type;if((n.moveUp()||n.moveDown()||n.moveLeft()||n.moveRight()||n.save()||a)&&(9!=e.keyCode&&16!=e.keyCode||(t=e.shiftKey?i.$el.prev():i.$el.next(),0==i.$el.next().length&&setTimeout((function(){i.$el.find(".select2-selection").blur()}),100)),t)){var l=new o.Command({key:"Tab",keyCode:9,which:9,shiftKey:e.shiftKey});setTimeout((function(){t.hasClass("editable")?(e.preventDefault(),e.stopPropagation(),i.model.trigger("backgrid:edited",i.model,i.column,l)):i.model.trigger("backgrid:edited",i.model,i.column,l)}),20)}},events:{"select2:open":"enterEditMode","select2:close":"exitEditMode",change:"onSave","select2:unselect":"onSave",blur:"saveOrCancel",keydown:"saveOrCancel"},template:t.template(['<option value="<%- value %>" ','<%= selected ? \'selected="selected"\' : "" %>>',"<%- label %></option>"].join(""),null,{variable:null}),initialize:function(){o.SelectCell.prototype.initialize.apply(this,arguments),this.onSave=this.onSave.bind(this),this.enterEditMode=this.enterEditMode.bind(this),this.exitEditMode=this.exitEditMode.bind(this)},render:function(){var e=t.defaults(this.column.toJSON(),this.defaults),n=this.model,a=this.column,l=o.callByNeed(e.editable,a,n),s=t.clone(this.optionValues||(t.isFunction(this.column.get("options"))?this.column.get("options")(this):this.column.get("options")));if(this.undelegateEvents(),this.$select&&(this.$select.data("select2")&&this.$select.select2("destroy"),delete this.$select,this.$select=null),this.$el.empty(),!t.isArray(s))throw new TypeError("optionValues must be an array");var d=null,c=null,p=this,u=n.get(this.column.get("name")),h=t.extend({openOnEnter:!1,multiple:!1,showOnScroll:!0,first_empty:!0},p.defaults.select2,e.select2||{}),f=t.template('<select <%=multiple ? "multiple" : "" %>></select>'),g=p.$select=i(f({multiple:h.multiple})).appendTo(p.$el);h.first_empty&&s.unshift(this.defaults.opt);var v,b=r(s);try{for(b.s();!(v=b.n()).done;){var y=v.value;t.isArray(y)?(d=y[0],c=y[1],g.append(p.template({label:d,value:c,selected:u==c||h.multiple&&t.indexOf(u,c)>-1}))):(y=t.defaults({},y,{selected:u==y.value||h.multiple&&t.indexOf(u,y.value)>-1},p.defaults.opt),g.append(p.template(y)))}}catch(e){b.e(e)}finally{b.f()}if(e&&t.has(e.disabled)){t.extend(h,{disabled:function(){var e=[];Array.prototype.push.apply(e,arguments);var t=e.shift();return"function"==typeof t?t.apply(p,e):t}(e.disabled,e,n)})}else t.extend(h,{disabled:!l});return this.delegateEvents(),l&&"properties"!==e.mode||(h.placeholder=""),h=m.default(h),this.$sel=this.$select.select2(h),this.$sel&&this.$sel.data("select2").on("keypress",(function(e){9===e.which&&this.isOpen()&&(this.trigger("results:select",{}),e.preventDefault())})),this},onSave:function(){var e=this.model,t=this.column;e.set(t.get("name"),this.$select.val())},remove:function(){this.$select.off("change",this.onSave),this.$select.data("select2")&&this.$select.select2("destroy"),this.$el.empty(),o.SelectCell.prototype.remove.apply(this,arguments)}});var y=o.TextareaCellEditor=o.InputCellEditor.extend({tagName:"textarea",events:{blur:"saveOrCancel",keydown:""}});o.Extension.TextareaCell=o.Cell.extend({className:"textarea-cell",editor:y}),o.Extension.CustomHeaderIconCell=o.HeaderCell.extend({className:"header-icon-cell",events:{click:"addHeaderIcon"},addHeaderIcon:function(e){this.collection.add(new this.collection.model),e.preventDefault()},render:function(){return this.$el.empty(),this.$el.html("<label><a><span style='font-weight:normal;'>"+e("Array Values")+"</a></span></label> <button class='btn-sm btn-secondary add'>"+e("Add")+"</button>"),this.delegateEvents(),this}});var C=n.Model.extend({defaults:{value:null}}),w=o.Extension.InputArrayCellEditor=o.CellEditor.extend({tagName:"div",events:{blur:"lostFocus"},render:function(){var t=this,n=this.model.get(this.column.get("name")),a="string";switch(this.model.get("type").replace("[]","")){case"boolean":a="boolean";break;case"integer":case"smallint":case"bigint":case"serial":case"smallserial":case"bigserial":case"oid":case"cid":case"xid":case"tid":a="integer";break;case"real":case"numeric":case"double precision":case"decimal":a="number";break;case"date":a="date"}var l=[{name:"value",label:e("Array Values"),type:"text",cell:a,headerCell:o.Extension.CustomHeaderIconCell,cellHeaderClasses:"width_percent_100"}],s=i("<div class='pgadmin-control-group backgrid form-group col-12 object subnode'></div>");this.$el.attr("tabindex","1"),l.unshift({name:"pg-backform-delete",label:"",cell:o.Extension.DeleteCell,editable:!1,cell_priority:-1}),this.$el.empty();var r=t.grid=new o.Grid({columns:l,collection:n});return this.grid.listenTo(n,"backgrid:error",function(e){return function(t){e.model.trigger("backgrid:error",e.model,e.column,new o.Command(t))}}(this)),this.grid.listenTo(n,"backgrid:edited",function(e){return function(t){e.model.trigger("backgrid:edited",e.model,e.column,new o.Command(t))}}(this)),r.render(),s.append(r.$el),this.$el.html(s),i(t.$el).pgMakeVisible("backform-tab"),t.delegateEvents(),this},lostFocus:function(e){var t=this;setTimeout((function(){if(t.$el[0]!=document.activeElement&&!function(e,t){for(var i=t.parentNode;null!=i;){if(i==e)return!0;i=i.parentNode}return!1}(t.$el[0],document.activeElement)){var i=t.model,n=t.column;i.trigger("backgrid:edited",i,n,new o.Command(e)),setTimeout((function(){t.grid&&(t.grid.remove(),t.grid=null)}),10)}}),10)}}),_=o.Extension.InputStringArrayCellFormatter=function(){};t.extend(_.prototype,{fromRaw:function(e){var i=[];return e.each((function(e){var n=e.get("value");t.isUndefined(n)?i.push("null"):i.push(e.get("value"))})),i.toString()},toRaw:function(e){return e}});var x=o.Extension.InputIntegerArrayCellFormatter=function(){};t.extend(x.prototype,{fromRaw:function(e){var i=[];return e.each((function(e){var n=e.get("value");t.isUndefined(n)||t.isNull(n)?i.push("NULL"):i.push(e.get("value"))})),i.toString()},toRaw:function(e){return e.each((function(e){e.set("value",parseInt(e.get("value")),{silent:!0})})),e}});var k=o.Extension.InputNumberArrayCellFormatter=function(){};t.extend(k.prototype,{fromRaw:function(e){var i=[];return e.each((function(e){var n=e.get("value");t.isUndefined(n)||t.isNull(n)?i.push("NULL"):i.push(e.get("value"))})),i.toString()},toRaw:function(e){return e.each((function(e){e.set("value",parseFloat(e.get("value")),{silent:!0})})),e}}),o.Extension.InputStringArrayCell=o.Cell.extend({className:"width_percent_25",formatter:_,editor:w,initialize:function(){o.Cell.prototype.initialize.apply(this,arguments);var e=arguments[0].model;t.isUndefined(this.collection)&&(this.collection=new(n.Collection.extend({model:C}))(e.get("value"))),this.model.set(this.column.get("name"),this.collection),this.listenTo(this.collection,"remove",this.render)}}),o.Extension.InputIntegerArrayCell=o.IntegerCell.extend({className:"width_percent_25",formatter:x,editor:w,initialize:function(){o.IntegerCell.prototype.initialize.apply(this,arguments);var e=arguments[0].model;t.each(e.get("value"),(function(e){"NULL"===e.value&&(e.value=null)})),t.isUndefined(this.collection)&&(this.collection=new(n.Collection.extend({model:C}))(e.get("value"))),this.model.set(this.column.get("name"),this.collection),this.listenTo(this.collection,"remove",this.render)}}),o.Extension.InputNumberArrayCell=o.NumberCell.extend({className:"width_percent_25",formatter:k,editor:w,initialize:function(){o.NumberCell.prototype.initialize.apply(this,arguments);var e=arguments[0].model;t.each(e.get("value"),(function(e){"NULL"===e.value&&(e.value=null)})),t.isUndefined(this.collection)&&(this.collection=new(n.Collection.extend({model:C}))(e.get("value"))),this.model.set(this.column.get("name"),this.collection),this.listenTo(this.collection,"remove",this.render)}}),o.Extension.InputBooleanArrayCell=o.BooleanCell.extend({className:"width_percent_25",editor:w,initialize:function(){o.BooleanCell.prototype.initialize.apply(this,arguments);var e=arguments[0].model;t.isUndefined(this.collection)&&(this.collection=new(n.Collection.extend({model:C}))(e.get("value"))),this.model.set(this.column.get("name"),this.collection),this.listenTo(this.collection,"remove",this.render)}});var E=o.Extension.DependentCell=function(){};t.extend(E.prototype,{initialize:function(){var e=this.column.get("deps"),i=this;e&&t.isArray(e)&&t.each(e,(function(e){var t=e.split(".").shift();i.listenTo(i.model,"change:"+t,i.dependentChanged)}))},remove:function(){var e=this,i=e.column.get("deps");i&&t.isArray(i)&&t.each(i,(function(t){var i=t.split(".").shift();e.stopListening(e.model,"change:"+i,e.dependentChanged)}))}});var N=o.PasswordFormatter=function(){};N.prototype=new o.CellFormatter,t.extend(N.prototype,{fromRaw:function(e){if(t.isUndefined(e)||t.isNull(e))return"";var i="";return e.forEach((function(){i+="*"})),i}}),o.Extension.PasswordCell=o.StringCell.extend({formatter:N,editor:o.InputCellEditor.extend({attributes:{type:"password",autocomplete:"new-password"},render:function(){var e=this.model;return this.$el.val(e.get(this.column.get("name"))),this}})}),t.extend(o.NumberFormatter.prototype,{fromRaw:function(e){if(t.isNull(e)||t.isUndefined(e))return"";var i=(e=parseFloat(e).toFixed(~~this.decimals)).split("."),n=i[0],a=i[1]?(this.decimalSeparator||".")+i[1]:"";return n.replace(this.HUMANIZED_NUM_RE,"$1"+this.orderSeparator)+a}});var T=o.Extension.JSONBCellFormatter=function(){};t.extend(T.prototype,{fromRaw:function(e){if(t.isArray(e)){return"{"+t.map(e,(function(e){return JSON.stringify(JSON.stringify(e))})).join()+"}"}return t.isObject(e)?JSON.stringify(e):e},toRaw:function(e){return e}}),o.Extension.JSONBCell=o.StringCell.extend({className:"jsonb-cell",formatter:T});var S=o.InputCellEditor.extend({events:{},initialize:function(){o.InputCellEditor.prototype.initialize.apply(this,arguments);var e=this;i(this.el).prop("readonly",!0),i(this.el).datepicker({onClose:function(t){var i=new o.Command({});e.model.set(e.column.get("name"),t),e.model.trigger("backgrid:edited",e.model,e.column,i),e=null}})}});o.Extension.DatepickerCell=o.Cell.extend({editor:S});var I=o.Extension.MomentFormatter=function(e){t.extend(this,this.defaults,e)};I.prototype=new o.CellFormatter,t.extend(I.prototype,{defaults:{modelInUnixOffset:!1,modelInUnixTimestamp:!1,modelInUTC:!0,modelLang:c.locale(),modelFormat:c.defaultFormat,displayInUnixOffset:!1,displayInUnixTimestamp:!1,displayInUTC:!0,displayLang:c.locale(),displayFormat:c.defaultFormat,allowEmpty:!1},fromRaw:function(e){if(null==e)return"";var t=null;return t=this.modelInUnixOffset?c(e):this.modelInUnixTimestamp?c.unix(e):this.modelInUTC?c.utc(e,this.modelFormat,this.modelLang):c(e,this.modelFormat,this.modelLang),this.displayInUnixOffset?+t:this.displayInUnixTimestamp?t.unix():(this.displayLang&&t.locale(this.displayLang),this.displayInUTC?t.utc():t.local(),this.displayFormat!=c.defaultFormat?t.format(this.displayFormat):t.format())},toRaw:function(e){var t=null;return(t=this.displayInUnixOffset?c(+e):this.displayInUnixTimestamp?c.unix(+e):this.displayInUTC?c.utc(e,this.displayFormat,this.displayLang):c(e,this.displayFormat,this.displayLang))&&t.isValid()?this.modelInUnixOffset?+t:this.modelInUnixTimestamp?t.unix():(this.modelLang&&t.locale(this.modelLang),this.modelInUTC?t.utc():t.local(),this.modelFormat!=c.defaultFormat?t.format(this.modelFormat):t.format()):this.allowEmpty&&""===e?null:void 0}});var $=o.Extension.MomentCell=o.Cell.extend({editor:o.InputCellEditor,className:"datetime-cell",formatter:I,initialize:function(e){$.__super__.initialize.apply(this,arguments);var i=I.prototype.defaults,n=t.keys(i),a=t.pick(this,n),l=t.pick(e,n),o=t.pick(this.column.toJSON(),n);t.extend(this.formatter,i,a,l,o),this.editor=this.editor.extend({attributes:t.extend({},this.editor.prototype.attributes||this.editor.attributes||{},{placeholder:this.formatter.displayFormat}),options:this.column.get("options")})}});o.Extension.DatetimePickerEditor=o.InputCellEditor.extend({postRender:function(){var e=this,i=t.extend({format:"YYYY-MM-DD HH:mm:ss Z",icons:{time:"fa fa-clock",data:"fa fa-calendar-alt",today:"fa fa-calendar-check",clear:"fa fa-trash"},buttons:{showToday:!0},toolbarPlacement:"top",widgetPositioning:{horizontal:"auto",vertical:"bottom"},keepOpen:!1},function(){var t=[];Array.prototype.push.apply(t,arguments);var i=t.shift();return"function"==typeof i?i.apply(e,t):i}(this.column.get("options")),{keyBinds:{"shift tab":function(t){t&&setTimeout((function(){e.closeIt({keyCode:9,shiftKey:!0})}),10)},tab:function(t){t&&setTimeout((function(){e.closeIt({keyCode:9})}),10)}}});this.tabKeyPress=!1,this.$el.datetimepicker(i),this.$el.datetimepicker("show"),this.picker=this.$el.data("datetimepicker")},events:{"hide.datetimepicker":"closeIt",focusout:"closeIt",keydown:"keydownHandler"},keydownHandler:function(e){var t=!1,n=this;if(e.altKey||38!=e.keyCode)if(e.altKey||40!=e.keyCode){if(39==e.keyCode){var a=n.$el.data("datetimepicker").date().clone();i(this.el).datetimepicker("date",a.add(1,"d"))}else if(37==e.keyCode){var l=n.$el.data("datetimepicker").date().clone();i(this.el).datetimepicker("date",l.subtract(1,"d"))}}else{var o=n.$el.data("datetimepicker").date().clone();n.$el.data("datetimepicker").widget.find(".datepicker").is(":visible")?i(this.el).datetimepicker("date",o.add(7,"d")):i(this.el).datetimepicker("date",o.subtract(7,"m"))}else{var s=n.$el.data("datetimepicker").date().clone();n.$el.data("datetimepicker").widget.find(".datepicker").is(":visible")?i(this.el).datetimepicker("date",s.subtract(7,"d")):i(this.el).datetimepicker("date",s.add(7,"m"))}if(e.altKey&&84==e.keyCode&&(n.$el.data("datetimepicker").widget.find(".timepicker").is(":visible")?n.$el.data("datetimepicker").widget.find(".fa-calendar-alt").click():n.$el.data("datetimepicker").widget.find(".fa-clock").click()),e.altKey&&38==e.keyCode){var r=n.$el.data("datetimepicker").date().clone();i(this.el).datetimepicker("date",r.add(1,"h"))}else if(e.altKey&&40==e.keyCode){var d=n.$el.data("datetimepicker").date().clone();i(this.el).datetimepicker("date",d.subtract(1,"h"))}27==e.keyCode&&(this.$el.datetimepicker("hide"),t=!0),t&&e.stopImmediatePropagation();9===e.keyCode&&n.el===e.target&&n.closeIt(e,!0)},closeIt:function(e,i){if(!this.is_closing&&!this.tabKeyPress){this.is_closing=!0,this.tabKeyPress=i;var n=this.formatter,a=this.model,l=this.column,s=this.$el.val(),r=n.toRaw(s,a);this.$el.datetimepicker("destroy"),this.is_closing=!1,(t.isUndefined(r)||""==String(s).replace(/^\s+|\s+$/g,""))&&(r=null),a.set(l.get("name"),r);var d=new o.Command(e);a.trigger("backgrid:edited",a,l,d)}}}),t.extend($.prototype,I.prototype.defaults),o.Extension.StringDepCell=o.StringCell.extend({initialize:function(){o.StringCell.prototype.initialize.apply(this,arguments),o.Extension.DependentCell.prototype.initialize.apply(this,arguments)},dependentChanged:function(){this.$el.empty();var e=this,i=this.model,n=this.column,a=this.column.get("editable");this.render();var l=t.isFunction(a)?!!a.apply(n,[i]):!!a;return setTimeout((function(){e.$el.removeClass("editor"),l?e.$el.addClass("editable"):e.$el.removeClass("editable")}),10),this.delegateEvents(),this},remove:o.Extension.DependentCell.prototype.remove}),o.Extension.Select2DepCell=o.Extension.Select2Cell.extend({initialize:function(){o.Extension.Select2Cell.prototype.initialize.apply(this,arguments),o.Extension.DependentCell.prototype.initialize.apply(this,arguments)},dependentChanged:function(){var e=this.model,i=this.column,n=this.column.get("editable");return this.render(),(t.isFunction(n)?n.apply(i,[e]):n)?this.$el.addClass("editable"):this.$el.removeClass("editable"),this.delegateEvents(),this},remove:o.Extension.DependentCell.prototype.remove}),o.Extension.ClientSideFilter=o.Extension.ClientSideFilter.extend({$customSearchBox:null,template:function(e){return'<span class="search">&nbsp;</span><input type="search" '+(e.placeholder?'aria-label= "'+e.placeholder+'"':"")+" "+(e.placeholder?'placeholder="'+e.placeholder+'"':"")+' name="'+e.name+'" '+(e.value?'value="'+e.value+'"':"")+'/><a class="clear" data-backgrid-action="clear" href="#">&times;</a>'},searchBox:function(){return this.$customSearchBox?this.$customSearchBox:this.$el.find("input[type=search]")},setCustomSearchBox:function(e){return this.$customSearchBox=e,this.$customSearchBox.attr("type","search"),this.$customSearchBox.on("keydown",this.search.bind(this)),this.$customSearchBox.on("mousedown",this.search.bind(this)),this},unsetCustomSearchBox:function(){return this.$customSearchBox.off("keydown",this.search.bind(this)),this.$customSearchBox=null,this}});var M=o.BooleanCellFormatter=function(){};return t.extend(M.prototype,{fromRaw:function(e){return!t.isUndefined(e)&&!t.isNull(e)&&("1"===e||"True"===e||"0"!==e&&"False"!==e&&e)},toRaw:function(e){return e}}),o.BooleanCell=o.BooleanCell.extend({className:"boolean-cell",enterEditMode:function(){this.$el.addClass("editor"),i(this.$el.find("input[type=checkbox]")).trigger("focus")},exitEditMode:function(){this.$el.removeClass("editor")},events:{"change input":"onChange","blur input":"exitEditMode",keydown:"onKeyDown"},onChange:function(e){var t=this.model,i=this.column,n=this.formatter.toRaw(this.$input.prop("checked"),t);this.enterEditMode(),t.set(i.get("name"),n),t.trigger("backgrid:edited",t,i,new o.Command(e))},render:function(){this.$el.empty();var n=this.model,a=this.column,l=o.callByNeed(a.editable(),a,n),s=a.get("align_center")||!1,r=this.formatter.fromRaw(n.get(a.get("name")),n),d="".concat(a.get("name"),"_").concat(t.uniqueId());return this.$el.empty(),this.$el.append(i('<div class="custom-control custom-checkbox custom-checkbox-no-label '.concat(s?"text-center":"",'">\n          <input tabindex="0" type="checkbox" class="custom-control-input" id="').concat(d,'" ').concat(l?"":"disabled"," ").concat(r?"checked":"",'/>\n          <label class="custom-control-label" for="').concat(d,'">\n            <span class="sr-only">')+e("Select")+"<span>\n          </label>\n        </div>")),this.$input=this.$el.find("input"),this.delegateEvents(),this}}),o.Extension.SqlCell=o.Extension.TextareaCell.extend({className:"sql-cell",defaults:{lineWrapping:!0},template:t.template(['<div data-toggle="tooltip" data-placement="top" data-html="true" title="<%- val %>"><textarea aria-label="'+e("SQL")+'" + style="display: none;"><%- val %></textarea><div>'].join("\n")),render:function(){var e=this,i=t.defaults(this.column.toJSON(),this.defaults),n=this.model,a=this.column,l=this.column.get("name"),s=o.callByNeed(i.editable,a,n);return this.sqlCell&&(this.sqlCell.toTextArea(),delete this.sqlCell,this.sqlCell=null),this.$el.empty(),this.$el.append(this.template({val:this.formatter.fromRaw(n.get(l),n)})),this.$el.addClass(l),this.updateStateClassesMaybe(),this.delegateEvents(),setTimeout((function(){e.sqlCell=u.fromTextArea(e.$el.find("textarea")[0],{mode:"text/x-pgsql",readOnly:!s,singleCursorHeightPerLine:!0,screenReaderLabel:l})})),this},enterEditMode:function(){this.$el.hasClass("editor")||this.$el.addClass("editor"),this.sqlCell.focus(),this.sqlCell.on("blur",this.exitEditMode.bind(this))},exitEditMode:function(){this.$el.removeClass("editor"),this.saveOrCancel.apply(this,arguments)},saveOrCancel:function(){var e=this.model,i=this.column;if(this.sqlCell){var n=this.sqlCell.getTextArea().value,a=this.sqlCell.getValue();t.isUndefined(a)?e.trigger("backgrid:error",e,i,n):e.set(i.get("name"),a)}},remove:function(){return this.sqlCell&&(i(this.$el.find('[data-toggle="tooltip"]')).tooltip("dispose"),this.sqlCell.toTextArea(),delete this.sqlCell,this.sqlCell=null),o.Extension.TextareaCell.prototype.remove.apply(this,arguments)}}),o.RadioCell=o.BooleanCell.extend({className:"radio-cell",initialize:function(){o.BooleanCell.prototype.initialize.apply(this,arguments),o.Extension.DependentCell.prototype.initialize.apply(this,arguments)},dependentChanged:function(){return this.render()},enterEditMode:function(){this.$el.addClass("editor"),i(this.$el.find("input[type=radio]")).trigger("focus")},exitEditMode:function(){this.$el.removeClass("editor")},events:{"change input":"onChange","blur input":"exitEditMode"},onChange:function(e){var i=this.model,n=this.column,a=this.formatter.toRaw(this.$input.prop("checked"),i);this.enterEditMode(),t.each(this.model.collection.models,(function(t){t.set(n.get("name"),!1),t.trigger("backgrid:edited",t,n,new o.Command(e))})),i.set(n.get("name"),a),i.trigger("backgrid:edited",i,n,new o.Command(e))},render:function(){this.$el.empty();var e=this.model,n=this.column,a=o.callByNeed(n.editable(),n,e),l=this.formatter.fromRaw(e.get(n.get("name")),e),s="".concat(n.get("name"),"_").concat(t.uniqueId());return this.$el.empty(),this.$el.append(i('<div style="text-align: center">\n          <input tabindex="0" type="radio" id="'.concat(s,'" ').concat(a?"":"disabled"," ").concat(l?"checked":"","/>\n        </div>"))),this.$input=this.$el.find("input"),this.delegateEvents(),this}}),o}.apply(t,n),void 0===a||(e.exports=a)}}]);